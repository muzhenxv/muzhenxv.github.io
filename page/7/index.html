<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="the Home of MuZhen">
<meta property="og:url" content="http://www.muzhen.tk/page/7/index.html">
<meta property="og:site_name" content="the Home of MuZhen">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="the Home of MuZhen">






  <link rel="canonical" href="http://www.muzhen.tk/page/7/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>the Home of MuZhen</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">the Home of MuZhen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/competition/quora/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/competition/quora/" class="post-title-link" itemprop="url">quora</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/competition/" itemprop="url" rel="index"><span itemprop="name">competition</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="sources"><a href="#sources" class="headerlink" title="sources"></a>sources</h1><p><a href="https://www.kaggle.com/c/quora-question-pairs" target="_blank" rel="noopener">quora</a></p>
<h1 id="what-have-I-learned"><a href="#what-have-I-learned" class="headerlink" title="what have I learned?"></a>what have I learned?</h1><p><a href="https://www.kaggle.com/anokas/quora-question-pairs/data-analysis-xgboost-starter-0-35460-lb/notebook" target="_blank" rel="noopener">Data Analysis &amp; XGBoost Starter (0.35460 LB)
</a></p>
<ul>
<li><p>画图时通过<code>plt.yscale(&#39;log&#39;, nonposy=&#39;clip&#39;)</code>可以改变纵轴量级，使得原本因为量级差距巨大而造成的图形更有可看性。</p>
</li>
<li><p>通过提交均值来寻找一个基础的benchmark。</p>
</li>
<li><p>根据提交均值后的得分估算出测试集中的正样本比例。</p>
</li>
<li><p>绘制词云图。</p>
</li>
<li><p>用nltk包中的stopwords来进行停用词剔除。</p>
</li>
<li><p>计算两个句子共享词时，用共有词的数量除以两个句子长度均值来正则化。</p>
</li>
<li><p>能够自己实现并定制tf，idf。</p>
</li>
<li><p>平衡数据集比例，使得train和test一致，从而得到好的结果。</p>
</li>
<li><p>会使用xgboost的early_stopping_rounds参数</p>
</li>
</ul>
<p><a href="https://www.kaggle.com/philschmidt/quora-question-pairs/quora-eda-model-selection-roc-pr-plots/comments" target="_blank" rel="noopener">Quora EDA &amp; Model selection (ROC, PR plots)
</a></p>
<ul>
<li>优美的降维和可视化技巧。待学习[TBC]</li>
</ul>
<p><a href="https://www.kaggle.com/puneetsl/quora-question-pairs/unusual-meaning-map/notebook" target="_blank" rel="noopener">Unusual meaning map
</a></p>
<ul>
<li><p>学习到了nltk.word_tokenize</p>
</li>
<li><p>巧妙的特征构造方法，利用笛卡尔积形式计算两个句子各词的相似度。并最后扑展（扩充）成一定维数的特征。</p>
</li>
<li><p>进一步了解了w2v和wmd</p>
</li>
</ul>
<p><a href="https://www.kaggle.com/c/quora-question-pairs/discussion/31019" target="_blank" rel="noopener">fm benchmark with tfidf around 29</a></p>
<ul>
<li><p>学习到了使用nltk寻找词干，<a href="https://www.kaggle.com/currie32/quora-question-pairs/the-importance-of-cleaning-text/comments" target="_blank" rel="noopener">The Importance of Cleaning Text
</a>中亦有介绍，更为简单。</p>
</li>
<li><p>学习到了使用a.intersection(b)计算集合间的交集。</p>
</li>
<li><p>学习到了如何清爽的整理代码，生成特征。</p>
</li>
<li><p>学习到了字串的jaccard距离，编辑距离及其计算。</p>
</li>
<li><p>给出了fm实现，待学习[TBC]。</p>
<p><a href="https://www.kaggle.com/c/quora-question-pairs/discussion/30967" target="_blank" rel="noopener">Score 0.3250 (or 0.31) using StackNet with sparse data</a></p>
<ul>
<li>stacknet，待学习[TBC]。</li>
</ul>
</li>
</ul>
<p> # </p>
<ul>
<li>crowdfloer</li>
<li>homedepot</li>
<li>SemEval<br><a href="https://github.com/rgtjf/Semantic-Texual-Similarity-Toolkits" target="_blank" rel="noopener">https://github.com/rgtjf/Semantic-Texual-Similarity-Toolkits</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/competition/trick/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/competition/trick/" class="post-title-link" itemprop="url">trick</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/competition/" itemprop="url" rel="index"><span itemprop="name">competition</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="benchmark"><a href="#benchmark" class="headerlink" title="benchmark"></a>benchmark</h1><p>就0-1分类问题而言，可以将训练集target整体均值作为测试集每个样本的预测概率。从而找到最基本的benchmark。</p>
<p><a href="https://www.kaggle.com/davidthaler/quora-question-pairs/how-many-1-s-are-in-the-public-lb" target="_blank" rel="noopener">而且，还可以根据提交得分反推出1类占比。</a></p>
<p>\begin{split} logloss &amp;&amp;= - \frac{1}{n} \sum y_i \log p + (1 - y_i) \log (1-p) \newline<br>&amp;&amp;= - (r \log p + (1 - r) \log (1 - p)) \newline<br>&amp;&amp;= r \log \frac{1-p}{p} - \log (1 - p)\end{split}<br>由此推得1类占比：<br>\begin{split} r = (logloss + \log (1-p))/ \log \frac{1-p}{p}\end{split}</p>
<h1 id="score"><a href="#score" class="headerlink" title="score"></a>score</h1><p>以logloss得分为例。</p>
<p>假设原训练集不均衡。在建模时通过采样使得训练集均衡，然后对测试集进行预测。通过设定threshold，将预测概率0-1化，计算准确率是没有问题的。</p>
<p>但是，由于采用logloss评分，实际上预测概率会偏大！因为真实的正负样本比例小于0.5！最简单的方法就是将预测结果除以采样后正负样本比例再乘以真实比例！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/coss function/对数损失函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/coss function/对数损失函数/" class="post-title-link" itemprop="url">对数损失函数</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/coss-function/" itemprop="url" rel="index"><span itemprop="name">coss function</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>



<h1 id="对数损失函数"><a href="#对数损失函数" class="headerlink" title="对数损失函数"></a>对数损失函数</h1><p>$$<br>L(Y, P(Y|X)) = -\log(P(Y|X))<br>$$</p>
<p>对数损失函数的含义是，对于分类y，在给定X情况下，使得$P(Y=y|X)$的概率最大化。</p>
<h1 id="logistic回归"><a href="#logistic回归" class="headerlink" title="logistic回归"></a>logistic回归</h1><p>那么，对于logsitic损失函数，除了使用极大似然法进行推导外，还可以直接从对数损失函数的角度出发进行推导：<br>$$<br>\begin{equation}<br>P(Y|X) = \left\{<br>\begin{array}{lr}<br>h_\theta(x) = \sigma(f(x)) = \frac{1}{1 + \exp(-f(x))}, &amp; y=1\\<br>1 - h_\theta(x) = 1 - \sigma(f(x)) = \frac{1}{1 + \exp(f(x))}, &amp; y= 0<br>\end{array}<br>\right. \\</p>
<p>L(Y, P(Y=y|X)) = \left\{<br>\begin{array}{lr}<br>-\log h_\theta(x) = \log (1 + \exp(-f(x))), &amp; y=1\\</p>
<ul>
<li>\log(1 - h_\theta(x)) = \log (1 + \exp(f(x))), &amp; y= 0<br>\end{array}<br>\right. \\</li>
</ul>
<p>J(\theta) = -\frac{1}{n}\sum_{i=1}^{n}( y^{i}\log h_\theta(x^i)  + (1 - y^i)\log(1 - h_\theta(x^i)) )<br>\end{equation}<br>$$<br>如果将y标签设置为1和-1，则可以有另外一种形式实现表达式的统一：<br>$$<br>\begin{equation}<br>P(Y|X) = \left\{<br>\begin{array}{lr}<br>h_\theta(x) = \sigma(f(x)) = \frac{1}{1 + \exp(-f(x))} = \frac{1}{1 + \exp(-yf(x))}, &amp; y=1\\<br>1 - h_\theta(x) = 1 - \sigma(f(x)) = \frac{1}{1 + \exp(f(x))} = \frac{1}{1 + \exp(-yf(x))}, &amp; y= -1<br>\end{array}<br>\right. \\<br>L(Y, P(Y=y|X)) = -\log h_\theta(x) = \log (1 + \exp(-yf(x))) = \log \sigma(yf(x)) \\<br>J(\theta) = -\frac{1}{n}\sum_{i=1}^{n}\log (1 + \exp(-y^if(x^i)))<br>\end{equation}<br>$$</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><strong><em><a href="https://www.cnblogs.com/ljygoodgoodstudydaydayup/p/6340129.html" target="_blank" rel="noopener">FM算法及FFM算法</a></em></strong></p>
<p><a href="https://www.zhihu.com/question/27126057/answer/92250611" target="_blank" rel="noopener">对数损失函数是如何度量损失的</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/End-to-End Learning of Motion Representation for Video Understanding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/End-to-End Learning of Motion Representation for Video Understanding/" class="post-title-link" itemprop="url">End-to-End Learning of Motion Representation for Video Understanding</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>人工抽取的光流特征被广泛的应用在视频分析问题上，并没有能够end-to-end。本文提出TVNet解决这个问题。</p>
<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>现有的光流特征提取方法有效但是运算低效。存在一些显著的缺点：</p>
<ul>
<li>训练分为两步。先抽取光流特征在训练，不是end-to-end</li>
<li>光流特征抽取时间和空间资源占用很大</li>
</ul>
<p>为了处理这些问题，通过模仿和展开TV-L1的迭代优化过程，文章提出了TVNet。特别的，我们将TV-L1的迭代方法做成了nn的一个自定义层。结果是：</p>
<ul>
<li>TVNet可以直接使用，而不需要基于标注好的光流数据进行额外训练</li>
<li>TVNet可以end-to-end，不需要预计算和存储光流特征</li>
<li>由于网络直接和label关联，因此可以进一步自动学习光流抽取器的参数，使得特征更加丰富和task-specific</li>
</ul>
<h1 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h1><p>有许多深度构架的尝试去学习视频的运动特征，主要有两个大方向：</p>
<ul>
<li>将2D卷积扩展到3D，但这样会计算量大、对数据量要求高</li>
<li>two-stream networks，训练两个网络，一个使用图像（i.e. RGB）数据，一个使用手工运动特征例如光流来表征运动模式</li>
</ul>
<p>光流特征抽取一般使用cnn，需要大量的成本高昂的光流标注数据。</p>
<p>近期，FlowNet被提出，它通过单个网络，利用合成的真实数据来学习光流特征和行为识别。</p>
<h1 id="3-Notations-and-background"><a href="#3-Notations-and-background" class="headerlink" title="3. Notations and background"></a>3. Notations and background</h1><h2 id="3-1-Notations"><a href="#3-1-Notations" class="headerlink" title="3.1 Notations"></a>3.1 Notations</h2><p>视频是一个图像序列，定义$I_t(x,y)$为像素亮度函数，$x$，$y$为平面坐标，$t$为时间，$I$为亮度。</p>
<h2 id="3-2-The-TV-L1-method"><a href="#3-2-The-TV-L1-method" class="headerlink" title="3.2 The TV-L1 method"></a>3.2 The TV-L1 method</h2><p>在现有的估计光流的方法中，TV-L1很好的实现了效率和精度之间的平衡。</p>
<p>min  (|∇u (x)| + |∇u (x)|) + λ|ρ(u(x))|<br>$$<br>\min_{u(\bold x), \bold x\in \Omega} \sum_{\bold x \in \Omega}()<br>$$</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/ffmpeg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/ffmpeg/" class="post-title-link" itemprop="url">ffmpeg</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在做物体识别方面的工作，整体流程是接收直播流，用yolo进行特定物体识别，推送处理后的视频流到指定地址。其中，需要用到ffmpeg进行处理。现将ffmpeg使用过程总结一下。</p>
<h1 id="install"><a href="#install" class="headerlink" title="install"></a>install</h1><p>ffmpeg有一系列依赖包，可按照官网直接用<code>sudo apt-get</code>依次安装 <a href="https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu" target="_blank" rel="noopener">Compilation &amp; Installation</a></p>
<p><code>sudo apt-get install ffmpeg</code></p>
<h1 id="process"><a href="#process" class="headerlink" title="process"></a>process</h1><h2 id="编码格式"><a href="#编码格式" class="headerlink" title="编码格式"></a>编码格式</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe <span class="selector-tag">input</span>.mp4</span><br></pre></td></tr></table></figure>
<p>可以使用以上命令去查看文件的视频和音频编码格式</p>
<h2 id="视频切割："><a href="#视频切割：" class="headerlink" title="视频切割："></a>视频切割：</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -<span class="selector-tag">i</span> <span class="selector-tag">input</span><span class="selector-class">.mp4</span> -ss <span class="number">0</span> -c copy -t <span class="number">60</span> -y output.mp4</span><br></pre></td></tr></table></figure>
<p><code>-i</code> 表示待处理的视频源</p>
<p><code>-ss</code>，<code>-t</code> 表示切割视频的起始时间点和切割时长。有两种写法：<code>0</code>，<code>00：01：20</code>。前者表示秒，后者是时:分:秒格式。</p>
<p><code>-to</code> 表示结束时间点。 但如果 <code>-ss</code> 放在 <code>-i</code> 前面，则效果和 <code>-t</code> 一样。有的blog在这个问题上说反了，特此说明。只要 <code>-ss</code> 始终放 <code>-i</code> 后面，就不会出问题了。</p>
<p><code>-y</code> 表示如果输出文件存在，则覆盖原文件</p>
<p><code>-c</code> 表示编码器，是<code>-codec</code>的缩写。 <code>-c copy</code>指复制原视频编码流。</p>
<p><code>-c:v -c:a</code> 表示分别指定视频音频编码流格式。也可以写成 <code>-vcodec -acodec</code>或者 <code>-c:0 -c:1</code>一般0是视频流，1是音频流。如果出现多音频流，可以用<code>-c:a:0</code>形式去选择。</p>
<p><code>-vn -an</code> 分别表示屏蔽视频流，音频流。 </p>
<p>在使用命令时好像必须同时指定视频流和音频流的处理，不能只指定某一个。</p>
<h2 id="视频拼接："><a href="#视频拼接：" class="headerlink" title="视频拼接："></a>视频拼接：</h2><p>需要先将需要拼接的视频文件按以下格式保存在一个列表 list.txt 中：<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file1'</span><br><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file2'</span><br><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file3'</span><br></pre></td></tr></table></figure></p>
<p>然后使用一下命令拼接<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f concat -<span class="selector-tag">i</span> list<span class="selector-class">.txt</span> -c copy output.mp4</span><br></pre></td></tr></table></figure></p>
<h2 id="视频转换为ts格式"><a href="#视频转换为ts格式" class="headerlink" title="视频转换为ts格式"></a>视频转换为ts格式</h2><p>将视频转换为ts</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -<span class="selector-tag">i</span> <span class="selector-tag">input</span><span class="selector-class">.mp4</span> -c copy -bsf h264_mp4toannexb output.ts</span><br></pre></td></tr></table></figure>
<p><code>-bsf</code> 是比特流过滤器。不知道具体有什么用，但是必须得有。而且参数必须设置成<code>h264_mp4toannexb</code>,其他过滤器可以通过<code>ffmpeg -bsfs</code>查看。如果是转成flv则不需要该参数，其他格式没有尝试。</p>
<h1 id="视频切片并生成m3u8播放列表"><a href="#视频切片并生成m3u8播放列表" class="headerlink" title="视频切片并生成m3u8播放列表"></a>视频切片并生成m3u8播放列表</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ffmpeg</span> <span class="selector-tag">-i</span> <span class="selector-tag">output</span><span class="selector-class">.mp4</span> <span class="selector-tag">-f</span> <span class="selector-tag">segment</span> <span class="selector-tag">-segment_time</span> 10 <span class="selector-tag">-segment_format</span> <span class="selector-tag">mpegts</span> <span class="selector-tag">-segment_list</span> <span class="selector-tag">list_file</span><span class="selector-class">.m3u8</span> <span class="selector-tag">-c</span> <span class="selector-tag">copy</span> <span class="selector-tag">-bsf</span><span class="selector-pseudo">:v</span> <span class="selector-tag">h264_mp4toannexb</span> <span class="selector-tag">-map</span> 0 <span class="selector-tag">output_file-</span>%<span class="selector-tag">d</span><span class="selector-class">.ts</span></span><br></pre></td></tr></table></figure>
<p>如果输入是ts文件，不需要加<code>-bsf</code>参数</p>
<p><code>-map</code> 没有具体搞懂这个参数。只知道<code>-map 0</code>代表复制第一个文件中的所有流到输出文件中。详情参<a href="http://blog.csdn.net/tao_627/article/details/22403615" target="_blank" rel="noopener">FFMPEG转码常用命令研究</a></p>
<p><code>-segment_format</code> 去掉后不影响命令实现。可能和跟严格的格式要求和应用有关。</p>
<p>首先，我们需要有一个原生直播流。暂时采用的是将直播流分割成一个一个ts不断传给后端，然后后端进行处理。因此，我们可以使用一个本地视频</p>
<p>直播：本地运行：<br>ffmpeg -f avfoundation -framerate 30 -i “1:0” -f avfoundation -framerate 30 -video_size 640x480 -i “0” -c:v libx264 -preset ultrafast -filter_complex ‘overlay=main_w-overlay_w-10:main_h-overlay_h-10’ -acodec libmp3lame -ar 44100 -ac 1  -f flv rtmp://10.165.33.20:1935/hls/test</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/redstarofsleep/article/details/45092145" target="_blank" rel="noopener">ubuntu14.04安装ffmpeg</a></p>
<p><a href="https://segmentfault.com/a/1190000000414341" target="_blank" rel="noopener">通过 ffmpeg 无损剪切/拼接视频</a></p>
<p><a href="http://blog.csdn.net/leixiaohua1020/article/details/15811977/" target="_blank" rel="noopener">[总结]FFMPEG视音频编解码零基础学习方法</a></p>
<p><strong><em><a href="http://blog.csdn.net/tao_627/article/details/22403615" target="_blank" rel="noopener">FFMPEG转码常用命令研究</a></em></strong></p>
<p><strong><em><a href="http://www.360doc.com/content/13/0901/17/9305922_311411358.shtml" target="_blank" rel="noopener">FFMPEG详解</a></em></strong></p>
<p><a href="http://blog.csdn.net/zhichao2001/article/details/12610465" target="_blank" rel="noopener">ffmpeg教程</a></p>
<p><strong><em><a href="http://www.cnblogs.com/wainiwann/p/4128154.html" target="_blank" rel="noopener">FFmpeg常用基本命令</a></em></strong></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/opencv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/opencv/" class="post-title-link" itemprop="url">opencv</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="查看opencv配置信息"><a href="#查看opencv配置信息" class="headerlink" title="查看opencv配置信息"></a>查看opencv配置信息</h1><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -<span class="keyword">c</span> <span class="string">"import cv2; print(cv2.getBuildInformation())"</span></span><br></pre></td></tr></table></figure>
<h1 id="安装opencv"><a href="#安装opencv" class="headerlink" title="安装opencv"></a>安装opencv</h1><p>opencv安装过程需要选择支持ffmpeg，有显卡还需要支持cuda。一般是采用编译安装，安装好后不需要利用pip install方式安装opencv-python，这点非常重要！不然会覆盖先前的opencv安装。</p>
<p>下面提供一个具有python3.5+cuda+ffmpeg+opencv环境的dockerfile前半部分。该dockerfile学自<a href="https://hub.docker.com/r/valian/docker-python-opencv-ffmpeg/" target="_blank" rel="noopener">valian/docker-python-opencv-ffmpeg</a>，但做了一些修改，已确保能够跑通。</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">FROM </span><span class="string">tensorflow/</span><span class="string">tensorflow:1.</span>2.<span class="string">1-devel-</span><span class="string">gpu-py3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ENV </span><span class="string">PYTHON_VERSION </span>3.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install all dependencies for OpenCV 3.2</span></span><br><span class="line"><span class="string">RUN </span><span class="string">apt-get </span>-y <span class="string">update </span>&amp;&amp; <span class="string">apt-get </span>-y <span class="string">install </span><span class="string">python$</span><span class="string">PYTHON_VERSION-dev </span><span class="string">wget </span><span class="string">unzip </span>\</span><br><span class="line">    <span class="string">build-essential </span><span class="string">cmake </span><span class="string">git </span><span class="string">pkg-config </span><span class="string">libatlas-base-</span><span class="string">dev </span><span class="string">gfortran </span>\</span><br><span class="line">    <span class="string">libjasper-dev </span><span class="string">libgtk2.</span><span class="string">0-dev </span><span class="string">libavcodec-dev </span><span class="string">libavformat-dev </span>\</span><br><span class="line">    <span class="string">libswscale-dev </span><span class="string">libjpeg-dev </span><span class="string">libpng-dev </span><span class="string">libtiff-dev </span><span class="string">libjasper-dev </span><span class="string">libv4l-dev </span>\</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">bootstrap.</span><span class="string">pypa.</span><span class="string">io/</span><span class="built_in">get-pip.py</span> &amp;&amp; <span class="string">python3 </span><span class="built_in">get-pip.py</span> &amp;&amp; <span class="string">pip3 </span><span class="string">install </span><span class="string">numpy </span>&amp;&amp; <span class="string">rm </span><span class="built_in">get-pip.py</span> \</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Itseez/</span><span class="string">opencv/</span><span class="string">archive/</span>3.2.0.<span class="string">zip </span>-O /<span class="string">opencv3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">unzip </span>-q /<span class="string">opencv3.</span><span class="string">zip </span>-d / &amp;&amp; <span class="string">mv </span>/<span class="string">opencv-3.</span>2.0 /<span class="string">opencv </span>&amp;&amp; <span class="string">rm </span>/<span class="string">opencv3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Itseez/</span><span class="string">opencv_contrib/</span><span class="string">archive/</span>3.2.0.<span class="string">zip </span>-O <span class="string">opencv_contrib3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">unzip </span>-q <span class="string">opencv_contrib3.</span><span class="string">zip </span>-d / &amp;&amp; <span class="string">mv </span>/<span class="string">opencv_contrib-3.</span>2.0 /<span class="string">opencv_contrib </span>&amp;&amp; <span class="string">rm </span><span class="string">opencv_contrib3.</span><span class="string">zip </span>\</span><br><span class="line"></span><br><span class="line">    <span class="comment"># prepare build</span></span><br><span class="line">    &amp;&amp; <span class="string">mkdir </span>/<span class="string">opencv/</span><span class="string">build </span>&amp;&amp; <span class="string">cd </span>/<span class="string">opencv/</span><span class="string">build </span>\</span><br><span class="line">    &amp;&amp; <span class="string">cmake </span>-D <span class="string">CMAKE_BUILD_TYPE=</span><span class="string">RELEASE </span>\</span><br><span class="line">      -D <span class="string">BUILD_PYTHON_SUPPORT=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">CMAKE_INSTALL_PREFIX=</span>/<span class="string">usr/</span><span class="string">local </span>\</span><br><span class="line">      -D <span class="string">OPENCV_EXTRA_MODULES_PATH=</span>/<span class="string">opencv_contrib/</span><span class="string">modules </span>\</span><br><span class="line">      -D <span class="string">BUILD_EXAMPLES=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">PYTHON_DEFAULT_EXECUTABLE=</span>/<span class="string">usr/</span><span class="string">bin/</span><span class="string">python3 </span>\</span><br><span class="line">      -D <span class="string">BUILD_opencv_python3=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">BUILD_opencv_python2=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">WITH_IPP=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">WITH_FFMPEG=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">WITH_V4L=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">WITH_CUDA=</span><span class="string">ON </span>.. \</span><br><span class="line"></span><br><span class="line">    <span class="comment"># install</span></span><br><span class="line">    &amp;&amp; <span class="string">cd </span>/<span class="string">opencv/</span><span class="string">build </span>&amp;&amp; <span class="string">make </span>-j$(<span class="string">nproc)</span> &amp;&amp; <span class="string">make </span><span class="string">install </span>&amp;&amp; <span class="string">ldconfig </span>\</span><br><span class="line"></span><br><span class="line">    <span class="comment">#clean</span></span><br><span class="line">    &amp;&amp; <span class="string">apt-get </span>-y <span class="string">remove </span><span class="string">build-essential </span><span class="string">cmake </span><span class="string">git </span><span class="string">pkg-config </span><span class="string">libatlas-base-</span><span class="string">dev </span><span class="string">gfortran </span>\</span><br><span class="line">    <span class="string">libjasper-dev </span><span class="string">libgtk2.</span><span class="string">0-dev </span><span class="string">libavcodec-dev </span><span class="string">libavformat-dev </span>\</span><br><span class="line">    <span class="string">libswscale-dev </span><span class="string">libjpeg-dev </span><span class="string">libpng-dev </span><span class="string">libtiff-dev </span><span class="string">libjasper-dev </span><span class="string">libv4l-dev </span>\</span><br><span class="line">    &amp;&amp; <span class="string">apt-get </span><span class="string">clean </span>\</span><br><span class="line">    &amp;&amp; <span class="string">rm </span>-<span class="string">rf </span>/<span class="string">opencv </span>/<span class="string">opencv_contrib </span>/<span class="string">var/</span><span class="string">lib/</span><span class="string">apt/</span><span class="string">lists/</span>*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define other commands.</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://hub.docker.com/r/valian/docker-python-opencv-ffmpeg/" target="_blank" rel="noopener">valian/docker-python-opencv-ffmpeg</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/data_compute/窗口函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/data_compute/窗口函数/" class="post-title-link" itemprop="url">窗口函数</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/data-compute/" itemprop="url" rel="index"><span itemprop="name">data_compute</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://medium.com/jbennetcodes/how-to-get-rid-of-loops-and-use-window-functions-in-pandas-or-spark-sql-907f274850e4" target="_blank" rel="noopener">How to get rid of loops and use window functions, in Pandas or Spark SQL</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/PCA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/PCA/" class="post-title-link" itemprop="url">PCA</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="PCA原理"><a href="#PCA原理" class="headerlink" title="PCA原理"></a>PCA原理</h1><p><a href="http://blog.codinglabs.org/articles/pca-tutorial.html" target="_blank" rel="noopener">PCA的数学原理</a> 这篇blog已经做非常好的说明。我在这里简单归纳下。</p>
<p>PCA是一种降维技术。它希望降维后样本的新生成的特征方差尽可能大，同时特征之间的相关性尽可能小，以此来尽可能的保留全部信息信息。</p>
<p>方差尽可能大的直观理解是数据越分散，差异性越大，体现的信息越多。</p>
<p>特征间相关性尽可能小的直观理解是避免相同信息在不同特征中重复出现。</p>
<h1 id="PCA进一步讨论"><a href="#PCA进一步讨论" class="headerlink" title="PCA进一步讨论"></a>PCA进一步讨论</h1><p>传统PCA是使用协方差度量相关性。因此所度量的也只是线性相关性。对于非线性相关，可以考虑使用KernelPCA，通过Kernel函数将非线性相关转为线性相关。</p>
<p>PCA假设数据各主特征是分布在正交方向上，如果在非正交方向上存在几个方差较大的方向，PCA的效果就大打折扣了。</p>
<h1 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><ol>
<li><p>PCA在使用过程中必须标准化么？为什么？<br>PCA追求特征之间的协方差为0.而计算协方差需要对特征去中心化。<br>[TBC]不去中心化会有什么坏处？是否需要归一化消除量纲？</p>
</li>
<li><p>为什么协方差可以度量相关性？并且是线性相关性？<br>根本上是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>从线性拟合和最小二乘的角度来看，拟合效果越好，相关系数绝对值越接近于1。从这个角度可以说相关系数刻画的是线性相关关系。（《概率论与数理统计》陈希孺 中科大出版社 第三章3.3节）</p>
</li>
<li><p>相关系数和修正余弦相似度区别？<br>根本上都是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>区别在于去中心化上。<br>相关系数考虑的是消除不同样本的基数差异。比如A可能对所有电影的打分都虚高，而B都会压低，相关系数可以消除这样的基数。<br>修正余弦相似度考虑的是消除不同特征之间的量纲差异。比如电影a的评分水平高于电影b，消除之后就不会令电影a对于相似性度量带来更大的影响。保持不同电影权重相同。<br>数据稀疏时选择修正余弦相似度更好。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/SNE与t-SNE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/SNE与t-SNE/" class="post-title-link" itemprop="url">SNE与t-SNE</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h1><p>本文是对 <a href="http://bindog.github.io/blog/2016/06/04/from-sne-to-tsne-to-largevis/" target="_blank" rel="noopener">从SNE到t-SNE再到LargeVis</a> 的阅读笔记。</p>
<h1 id="SNE"><a href="#SNE" class="headerlink" title="SNE"></a>SNE</h1><p>SNE原理是希望尽可能保存原数据的空间结构。</p>
<p>它利用条件概率来描述两个点之间的距离，距离越近，概率越大。之所以如此是因为直接使用欧式距离并不合适。[TBC]<br>\begin{split} p_{j|i} = \frac{\exp ((- \Vert x_i - x_j \Vert)^2)/2 \sigma^2}{\sum_{k \neq i} \exp ((- \Vert x_i - x_k \Vert)^2)/2 \sigma^2}\end{split}<br>其中 \(\sigma_i\) 是以 $x_i$ 为中心点的高斯分布的方差。设定 $p_{i|i} = 0$  。<br>降维后对应 \( y_i\) 点的条件分布相似定义，但是方差直接定为 \(\frac{1}{\sqrt{2}}\) ，有：<br>\begin{split} q_{j|i} = \frac{\exp ((- \Vert y_i - y_j \Vert)^2)}{\sum_{k \neq i} \exp ((- \Vert y_i - y_k \Vert)^2)}\end{split}</p>
<p>我们希望降维后点的条件概率分布应当尽可能与原数据条件概率一致。故而选择KL散度作为代价函数。<br>\begin{split} C =  \sum_i KL(P_i \Vert Q_i) = \sum_i \sum_j p_{j|i} \log \frac{p_{j|i}}{q_{j|i}}\end{split}<br>但是由于KL的不对称性，会出现一个问题：当p大q小时，代价较高，反之，则代价较低。因此代价函数更关注局部结构而忽视了全局结构。</p>
<h1 id="t-SNE"><a href="#t-SNE" class="headerlink" title="t-SNE"></a>t-SNE</h1><p>t-SNE解决了SNE的两个问题：对称性和拥挤问题。</p>
<p>先看对称性。（我并没有理解它是如何解决KL不对称带来的代价函数不对称性的[TBC]）<br>在SNE中，$p_{i|j}$ 和 $p_{j|i}$ 是不对等的，降维后的空间中也是如此。因此现在我们寻找一个满足对称性的联合概率分布：<br>\begin{split} q_{ij} = \frac{\exp ((- \Vert y_i - y_j \Vert)^2)}{\sum_{k \neq l} \exp ((- \Vert y_l - y_k \Vert)^2)}\end{split}</p>
<p>那么，在原空间是否也可以这样定义呢？如果这样，考虑一个离群点 $x_i$ ,那么对任意j， $p_{ij}$ 都会较小，从而不管降维后处于什么位置，代价都不会太大。<br>故而采用更简单直观的方式进行定义：<br>\begin{split} p_{ij} = \frac{p_{j|i} + p_{i|j}}{2n}\end{split}<br>代价函数为：<br>\begin{split} C =  \sum_i KL(P_i \Vert Q_i) = \sum_i \sum_j p_{ij} \log \frac{p_{ij}}{q_{ij}}\end{split}</p>
<p>在来看拥挤问题的解决。<br>在SNE时，虽然可以区分出不同类，但是类间边界并不明显，不同类依旧簇拥在一起，这就是拥挤问题。</p>
<p>通过对降维数据使用自由度为1的t分布描述条件概率，就可以解决这个问题。<br>\begin{split} q_{ij} = \frac{(1 + (\Vert y_i - y_j \Vert)^2)^{-1}}{\sum_{k \neq l} （1 + (\Vert y_k - y_l \Vert)^2)^{-1}}\end{split}<br>原数据空间依旧使用高斯分布。</p>
<p>我们通过以下两幅图来描述使用t分布的好处。</p>
<p>首先，t分布是长尾分布，对于边缘异常值不敏感，因此可以更好的捕捉全局特征。<br><img src="http://i4.buimg.com/567571/962ae3921b331a8f.png" alt></p>
<p>其次，高斯分布转t分布，可以使得邻近点间距离更近，距离大的点间距离更大，从而有效分离不同类。<br><img src="http://i1.piimg.com/567571/f26982cc085019a5.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/SVD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/SVD/" class="post-title-link" itemprop="url">SVD</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="基变换"><a href="#基变换" class="headerlink" title="基变换"></a>基变换</h1><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/young_gy/article/details/50042885#推荐系统" target="_blank" rel="noopener">SVD分解及其应用</a><br><a href="http://www.cnblogs.com/lzllovesyl/p/5243370.html" target="_blank" rel="noopener">[机器学习笔记]奇异值分解SVD简介及其在推荐系统中的简单应用</a><br><a href="http://blog.csdn.net/zhongkejingwang/article/details/43053513" target="_blank" rel="noopener">奇异值分解(SVD)原理详解及推导</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/reduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/reduction/" class="post-title-link" itemprop="url">reduction</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="一些进行降维的方法"><a href="#一些进行降维的方法" class="headerlink" title="一些进行降维的方法"></a>一些进行降维的方法</h1><ul>
<li>use clustering to extract feature</li>
<li>t-sne</li>
<li>pca</li>
<li>autoencoder</li>
<li>any others to reduction?</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/documentation/documentation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/documentation/documentation/" class="post-title-link" itemprop="url">documentation</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/documentation/" itemprop="url" rel="index"><span itemprop="name">documentation</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://mqshen.gitbooks.io/prml/Chapter9/mixtures_gaussian.html" target="_blank" rel="noopener">PRML中文版</a></p>
<p><a href="http://ufldl.stanford.edu/wiki/index.php/UFLDL%E6%95%99%E7%A8%8B" target="_blank" rel="noopener">UFLDL教程</a></p>
<p><a href="http://www.efimov-ml.com/index.html" target="_blank" rel="noopener">Kaggle开源代码</a></p>
<p><a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers" target="_blank" rel="noopener">Probabilistic-Programming-and-Bayesian-Methods-for-Hackers</a></p>
<p><a href="http://yerevann.com/a-guide-to-deep-learning/" target="_blank" rel="noopener">A Guide to Deep Learning by yerevaNN</a></p>
<p><a href="http://deeplearning.net/reading-list/" target="_blank" rel="noopener">reading list of NN papers</a></p>
<p><a href="http://mlwave.com/" target="_blank" rel="noopener">Kaggle guide</a></p>
<p><a href="http://www.efimov-ml.com/index.html" target="_blank" rel="noopener">Kaggle solutions</a></p>
<p><a href="https://github.com/songrotek/Deep-Learning-Papers-Reading-Roadmap" target="_blank" rel="noopener">Deep Learning Papers Reading Roadmap</a></p>
<p><a href="http://www.jianshu.com/p/7b896793196b" target="_blank" rel="noopener">数据可视化 - Mosaic Plot(马赛克图)</a> 这个人的blog可以学习下。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/ensemble/GBM and Xgboost/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/ensemble/GBM and Xgboost/" class="post-title-link" itemprop="url">GBM and Xgboost</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ensemble/" itemprop="url" rel="index"><span itemprop="name">ensemble</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="GBDT概述"><a href="#GBDT概述" class="headerlink" title="GBDT概述"></a>GBDT概述</h1><p>与Adaboost不同，GBM虽然也是加性模型，但它却是通过不断拟合残差来逐步提高模型效果。  </p>
<p><strong><em>需要强调的是，融合模型融合的是函数空间，而不是参数空间！！！*</em></strong></p>
<h1 id="梯度提升"><a href="#梯度提升" class="headerlink" title="梯度提升"></a>梯度提升</h1><p>t轮迭代的损失函数为：<br>\begin{split} J_t = L(y,F_t(x)) = L(y,\sum_{t=0}^t h_t(x))\end{split}</p>
<p>通过梯度下降法优化损失函数：<br>\begin{split} F_{t+1}(x) := F_t(x) - \rho_t \frac{\partial J_t}{\partial F_t(x)} \end{split}<br><strong><em>注意，这里直接优化的是分类器！$\rho$是加法模型的系数（类似于adaboost的系数）,利用牛顿法最小化$J_{t+1}$求得。</em></strong>[TBC]学习率真的是这样??</p>
<p>注意shrinkage与学习率是两个不同概念,它是在得到新拟合出的模型之后通过乘以收缩率去控制过拟合，类似于动量。也就是说，最终应该有：<br>\begin{split} F_{t+1}(x) = (1 - \text{shrinkage})F_t(x) - \text{shrinkage } \rho_t \frac{\partial J_t}{\partial F_t(x)} \end{split}<br>[TBC]？？是每次迭代之后都直接使用shinkage，还是建好模型以后统一使用shrinkage？</p>
<p><strong><em>GBM用的都是回归树！</em></strong> 应该是为了计算方便和更加精确。如果是分类问题，最后再对结果进行转换。</p>
<h1 id="Xgboost"><a href="#Xgboost" class="headerlink" title="Xgboost"></a>Xgboost</h1><p>相较于GBM，引入了L2正则项，将叶节点数和叶节点得分作为罚项显化，并且利用泰勒展开进行优化求解。</p>
<p>利用得分增益进行树的分裂。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://zkread.com/article/1012129.html" target="_blank" rel="noopener">GBDT（梯度提升决策树）</a></p>
<p><a href="http://www-stat.stanford.edu/~jhf/ftp/trebst.pdf" target="_blank" rel="noopener">Greedy function approximation: a gradient boosting machine</a></p>
<p><a href="http://www.chengli.io/tutorials/gradient_boosting.pdf" target="_blank" rel="noopener">A Gentle Introduction to Gradient Boosting</a></p>
<p><a href="http://xgboost.readthedocs.io/en/latest/model.html" target="_blank" rel="noopener">Xgboost</a></p>
<p><a href="http://blog.csdn.net/shenxiaoming77/article/details/51542982" target="_blank" rel="noopener">一步一步理解GB、GBDT、xgboost</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/ensemble/gbdt组合特征/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/ensemble/gbdt组合特征/" class="post-title-link" itemprop="url">gbdt组合特征</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ensemble/" itemprop="url" rel="index"><span itemprop="name">ensemble</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/zhangf666/article/details/70183788" target="_blank" rel="noopener">XGBoost Plotting API以及GBDT组合特征实践</a></p>
<p><a href="http://blog.csdn.net/bryan__/article/details/51769118" target="_blank" rel="noopener">利用GBDT模型构造新特征</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/ensemble/gcforest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/ensemble/gcforest/" class="post-title-link" itemprop="url">gcforest</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ensemble/" itemprop="url" rel="index"><span itemprop="name">ensemble</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="gcForest"><a href="#gcForest" class="headerlink" title="gcForest"></a>gcForest</h1><p>gcForest包含两大模块：级联森林和多粒度扫描。<br><img src="http://i4.buimg.com/567571/19c73bb7503caa72.png" alt></p>
<h1 id="多粒度扫描（Multi-Grained-Scanning）"><a href="#多粒度扫描（Multi-Grained-Scanning）" class="headerlink" title="多粒度扫描（Multi-Grained Scanning）"></a>多粒度扫描（Multi-Grained Scanning）</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-4/47305608-file_1493888234733_e64c.png" alt><br>对特征进行有规则滑动采样，拿采样后数据分别建立标准随机森林和完全随机森林，将输出概率进行拼接构成新的特征向量。</p>
<h1 id="级联森林（Cascade-Forest）"><a href="#级联森林（Cascade-Forest）" class="headerlink" title="级联森林（Cascade Forest）"></a>级联森林（Cascade Forest）</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-4/88211704-file_1493888546752_1059d.png" alt><br>利用多个随机森林训练的输出作为新特征和原特征合并，多次级联操作，最终多个森林输出结果取均值，得到最后的类别概率分布。<br>每次级联后验证输出效果是否有提升，没有提升则终止级联，输出结果。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://www.qcloud.com/community/article/536731001491381531" target="_blank" rel="noopener">小菜鸟对周志华大神gcForest的理解</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/error-process/Q&A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/error-process/Q&A/" class="post-title-link" itemprop="url">Q&A</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/error-process/" itemprop="url" rel="index"><span itemprop="name">error-process</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="xgboost-feature-names-mismatch"><a href="#xgboost-feature-names-mismatch" class="headerlink" title="xgboost feature_names mismatch"></a>xgboost feature_names mismatch</h1><p>在使用xgboost的时候出现这个问题，就是字面意思，列不匹配。而我出现的这个问题的原因则是因为，我使用了一个稀疏矩阵train_test_split分割后进行训练和预测。但是，分割之后的矩阵很可能出现某列都是0的情况，一旦这样，则进行xgb.DMatrix变换时，会缺失这一列信息（丢弃这一列，），也就出现了列名和实际列数对不上的情况。</p>
<p>但是这一情况仅仅出现在trian过程，在predict过程进行某列都是0也不影响。</p>
<h1 id="xgbosot-get-fsocre输出为空字典"><a href="#xgbosot-get-fsocre输出为空字典" class="headerlink" title="xgbosot get_fsocre输出为空字典"></a>xgbosot get_fsocre输出为空字典</h1><p>需要在训练时加上参数 bias_score,奇怪的是这本身就是一个有值的默参，不能理解为什么一定要显式指定。仅为mac测试。</p>
<h1 id="xgb预测时加上-model-bset-iteration或其他两个参数时，输出概率为负"><a href="#xgb预测时加上-model-bset-iteration或其他两个参数时，输出概率为负" class="headerlink" title="xgb预测时加上 model.bset_iteration或其他两个参数时，输出概率为负"></a>xgb预测时加上 model.bset_iteration或其他两个参数时，输出概率为负</h1><p>因为在传参时没有使用ntree_limit=bst.best_iteration,而是直接传了bst.best_iteration,但是predict方法第二个参数根本不是ntree_limit!所以传参最好正规化，使用参数名=？的方式！</p>
<h1 id="xgb-的bst-best-iteration和bst-best-ntree-limit有什么区别"><a href="#xgb-的bst-best-iteration和bst-best-ntree-limit有什么区别" class="headerlink" title="xgb 的bst.best_iteration和bst.best_ntree_limit有什么区别"></a>xgb 的bst.best_iteration和bst.best_ntree_limit有什么区别</h1><p>best_iteration是指最佳迭代次数，从0开始计数。best.best_ntree_limit是指最佳树的数量，所以比迭代次数大1，因为树的数量是从1开始数的。</p>
<p>如果booster=’gbtree’,那么这两个参数都是有的，如果booster=’gblinear’，那么只有best_iteration，因为不存在树的说法。</p>
<p>在使用bst.predict时，如果想要指定ntree_limit,对于’gbtree’直接使用best_ntree_limit就可以了，对于’gblinear’可以使用best_iteration+1的方式。（是否可以有一样的效果没严格考证）</p>
<h1 id="sklearn-TfidfVectorizer-变换后出现了没有文本中没有的词，而且词数和文本的词数对不上"><a href="#sklearn-TfidfVectorizer-变换后出现了没有文本中没有的词，而且词数和文本的词数对不上" class="headerlink" title="sklearn TfidfVectorizer 变换后出现了没有文本中没有的词，而且词数和文本的词数对不上"></a>sklearn TfidfVectorizer 变换后出现了没有文本中没有的词，而且词数和文本的词数对不上</h1><p>需要注意TfidfVectorizer有几个参数，lowercase, max_df, min_df，出现没有的词其实是做了小写变换出现的，词数对不上也是这三个参数的原因。</p>
<h1 id="pandas-groupby组内顺序会按照df本身的内部顺序么？"><a href="#pandas-groupby组内顺序会按照df本身的内部顺序么？" class="headerlink" title="pandas groupby组内顺序会按照df本身的内部顺序么？"></a>pandas groupby组内顺序会按照df本身的内部顺序么？</h1><p>会！</p>
<p><a href="https://stackoverflow.com/questions/8409498/attributeerror-numpy-ndarray-object-has-no-attribute-append" target="_blank" rel="noopener">[AttributeError: ‘numpy.ndarray’ object has no attribute ‘append’]</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/feature engineering/category encoding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/feature engineering/category encoding/" class="post-title-link" itemprop="url">category encoding</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/feature-engineering/" itemprop="url" rel="index"><span itemprop="name">feature engineering</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>类别变量编码方式：</p>
<ol>
<li>Ordinal: 给每个类赋予一个值</li>
<li>One-Hot: 转化成n个0-1两值列（n为类别数），每一列代表一个类别。case的类别对应的那一列取值为1， 其他列为0</li>
<li>Binary: 先将每个类赋予一个值，然后将值转化为二进制码，然后将二进制码按字符分裂成多列</li>
<li>Sum: </li>
</ol>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://www.willmcginnis.com/2015/11/29/beyond-one-hot-an-exploration-of-categorical-variables/" target="_blank" rel="noopener">BEYOND ONE-HOT: AN EXPLORATION OF CATEGORICAL VARIABLES</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/feature engineering/entity embeddings of categorical variables/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/feature engineering/entity embeddings of categorical variables/" class="post-title-link" itemprop="url">entity embeddings of categorical variables</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/feature-engineering/" itemprop="url" rel="index"><span itemprop="name">feature engineering</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文为论文<a href="https://arxiv.arg/abs/1604.06737" target="_blank" rel="noopener">《Entity Embeddings of Categorical Variables》</a> 的阅读笔记。</p>
<ol>
<li><p>Introduction</p>
<blockquote>
<p>In principle a neural network can approximate any continuous function and piece wise continuous function.However, it is not suitable to approximate arbitrary non-continuous functions as it assumes certain level of continuity in its general form.</p>
</blockquote>
<p>这一部分首先明确NN适合于拟合连续函数或者分段连续函数，但对于非连续函数拟合效果较差。同时认为大部分数据都是连续的，即使表面看不出来连续性。非连续性这一点在结构化数据的类别变量上表现尤为突出。因此希望找到方法对类别数据进行处理，表征出它们的连续性。一般方法是使用onehot，但会带来两个问题：</p>
<ol>
<li>计算资源的巨大需求</li>
<li>onehot会忽视类别之间的相互关系</li>
</ol>
<p>本论文则将提出一种embedding方法用于表征数据内部的连续性，使之适用于NN以及一般机器学习模型。</p>
<p>​</p>
</li>
<li><p>Related Work</p>
<p>已经有相关工作出现，例如NLP中的词嵌入相关方法。最快的一种方式是使用词的上下文信息来最大化以下目标函数：<br>$$<br>p(\omega_c|\omega) = \frac{\exp(\omega \centerdot \omega_c)}{\sum_i \exp(\omega \centerdot \omega_i)}<br>$$<br>$\omega_c$在$\omega$的上下文窗口中，希望条件概率最大化。求和是针对整个词汇空间。</p>
<p>​</p>
</li>
<li><p>基于树的方法</p>
<p>由于树方法是本文的主要比较对象，因此做下简单介绍。</p>
<ul>
<li><p>单决策树</p>
<p>决策树将特征空间$X$分割$M$个不同的子空间$R_1, R_2, …,R_M$， 拟合的函数其实是：<br>$$<br>f(x) = \sum\limits_{m=1}^M c_m I(x \in R_m)<br>$$<br>使用均方误差作为损失函数：<br>$$<br>L = \sum\limits_i(y_i - f(x_i))^2<br>$$<br>可以求得最优解（其实就是子空间包含样本label的均值）：<br>$$<br>\hat{c_m} = \frac{1}{\left|R_m\right|}\sum_{x_i \in R_m} y_i<br>$$<br>由于全局优化是困难的，实际上一般采用序贯二分的方法进行学习，也就是M=2。</p>
<p>​</p>
</li>
<li><p>random forest</p>
<p>样本和特征两方面的bootstrap以及多棵树结果的线性平均在保持偏差效果的同时降低了方差。</p>
<p>​</p>
</li>
<li><p>GBM</p>
<p>不同于单树的参数优化，GBM是函数优化，每一步都是寻找一个最优函数优化前面的残差。</p>
<p>​</p>
</li>
</ul>
</li>
<li><p>Structured data</p>
<p>解释了下结构化数据是什么。以及说明了nominal numbers（无序）和cardinal numbers（有序）。</p>
<p>​</p>
</li>
<li><p>Entity embedding</p>
<p>将类别变量onehot以后嵌入到一个低维空间中。具体怎么嵌入合适，论文中没有实在讨论。同时从作者源码看，也仅仅是简单调用了keras的embedding层而已。如果是使用NN的话，可以将embedding设置为可训练的，这样就可以通过label来学习嵌入方式。但如果是非NN，就不好这么做了。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/imbalance data/learning from imbalance data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/imbalance data/learning from imbalance data/" class="post-title-link" itemprop="url">learning from imbalance data</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/imbalance-data/" itemprop="url" rel="index"><span itemprop="name">imbalance data</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://zhpmatrix.github.io/2017/02/20/learning-from-imbalanced-data/" target="_blank" rel="noopener">Learning from Imbalanced Data</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/machine learning/Fast Effective Rule Induction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/machine learning/Fast Effective Rule Induction/" class="post-title-link" itemprop="url">Fast Effective Rule Induction</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine learning</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<p>本文为论文《Fast Effective Rule Induction》的阅读笔记。</p>
<h1 id="REP-amp-IREP"><a href="#REP-amp-IREP" class="headerlink" title="REP&amp;IREP"></a>REP&amp;IREP</h1><p>REP(reduced error pruning)将数据分成两部分，growing set和pruning set，在growing set上贪婪学习，然后根据pruning set来进行剪枝。REP的时间复杂度较高。</p>
<p>IREP（incremental reduced error pruning）则是在每一个规则的发现过程中都进行数据集分割，并且学习完规则立刻进行剪枝操作。IREP在精度上略差于C4.5，在large noisy dataset的处理能力也还不错。</p>
<p>下面是一个作者在文中给出的二分类IREP伪代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">	produce IREP(Pos,Neg)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">   Ruleest := ∅</span><br><span class="line">   <span class="keyword">while</span> Pos ≠ ∅ <span class="keyword">do</span></span><br><span class="line">      <span class="comment">/* grow and prune a new rule */</span></span><br><span class="line">      <span class="keyword">split</span> (Pos, Neg) <span class="keyword">into</span> (GrowPos, GrowNeg) <span class="keyword">and</span> (PrunePos, PruneNeg)</span><br><span class="line">      Rule := GrowRule(GrowPos, GrowNeg)</span><br><span class="line">      Rule := PruneRule(Rule, PrunePos, PruneNeg)</span><br><span class="line">      <span class="keyword">if</span> the <span class="keyword">error</span> rate <span class="keyword">of</span> Rule <span class="keyword">on</span> (PrunePos, PruneNeg) exceeds <span class="number">50</span>% <span class="keyword">then</span></span><br><span class="line">         <span class="keyword">return</span> Ruleset</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">         <span class="keyword">add</span> Rule <span class="keyword">to</span> Ruleset</span><br><span class="line">         remove examples covered <span class="keyword">by</span> Rule</span><br><span class="line">         <span class="keyword">from</span> (Pos, Neg)</span><br><span class="line">      endif</span><br><span class="line">   endwhile</span><br><span class="line">   <span class="keyword">return</span> Ruleset</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>其中<br>$$<br>v = PruneRule(Rule, PrunePos, PruneNeg) \equiv \frac{p + (N-n)}{P+N}  \tag{1}<br>$$<br>如果是多分类，则按类的占比从低往高排序${C_1, C_2, , …, C_k}$，先针对$C_1$开始进行规则学习，把该类完全排除后，继续学习$C_2$，依此类推。</p>
<p>如果某特征$A$中存在缺失值，那么$A=v$(离散)或者$A&lt;=\theta$（连续）这个条件会被认为不cover缺失值样本。我的理解是这样做的含义其实是更倾向于让缺失值归于多数类。</p>
<p>以上IREP(为方便说明，我自行标记为IREPn)和初始IREP有以下区别：</p>
<ol>
<li>IREP原作者有提出两套剪枝算法，分为为IREP和IREP2。IREP使用Equation 1作为剪枝准则，使用$p/(p+n) &lt; N/(P+N)$作为停止准则；IREP2使用$\frac{p}{p+n}$作为剪枝准则，使用$p/(p+n) &lt; 1/2$作为停止准则。本论文作者通过实验发现IREP通常好于IREP2，但也发现如果将IREP的剪枝准则和IREP2的停止准则结合可以显著的改进IREP的效果。</li>
<li>原始IREP在每次剪枝过程中仅允许剪掉一条规则，而IREPn允许在剪枝准则基础上剪掉任意条规则。</li>
<li>IREPn支持缺失值处理，数值型变量和多类别变量。</li>
</ol>
<h1 id="效率对比"><a href="#效率对比" class="headerlink" title="效率对比"></a>效率对比</h1><p>和C4.5rules进行实验比较:</p>
<ol>
<li>C4.5rules时间复杂度为样本量的立方，而IREP则是线性对数的复杂度。</li>
<li>IREP及其所有变种效果均差于C4.5rules，也差于通过无剪枝的学习方法（FOIL）学到的规则效果。</li>
<li>IREP在一些数据集上无法收敛，它在少量数据上学习到规则的误差率，当数据量增加后依旧没有显著改善。</li>
</ol>
<h1 id="IPEP改进"><a href="#IPEP改进" class="headerlink" title="IPEP改进"></a>IPEP改进</h1><ol>
<li><p>剪枝规则的改进</p>
<p>Equation 1的剪枝规则本质上就是$p-n$,受到绝对量影响。比如rule1 cover 2000个正例和1000个负例，rule2 cover 1000个正例和1个负例，使用Equation 1进行评价，则rule1好于rule2。论文作者提出一种改进：<br>$$<br>v^* (Rule, PrunePos, PruneNeg)  \equiv \frac{p-n}{p+n}<br>$$</p>
</li>
<li><p>停止规则的改进</p>
<p>对于有偏样本（比如说正样本占比10%），规则子集的错误率很容易超过50%，由此触发停止规则。但如果这个规则子集的正样本占比能够达到40%，显然这是一个好规则。而且严重有偏样本在prunset上也往往有很大的方差，导致更容易错误率超过50%。因此，50%的停止规则容易导致IREP过早停止学习。作者提出使用最小描述长度来设定停止规则。这样改进后的IREP称为IREP*</p>
</li>
<li><p>规则优化</p>
<p>没看懂？</p>
<p>​</p>
</li>
</ol>
<h1 id="泛化能力"><a href="#泛化能力" class="headerlink" title="泛化能力"></a>泛化能力</h1><p>RIPPER好于IREP*，略逊于C4.5rules，RIPPER2略优于C4.5rules。</p>
<h1 id="RIPPERk效率"><a href="#RIPPERk效率" class="headerlink" title="RIPPERk效率"></a>RIPPERk效率</h1><p>论述了RIPPERk的在时间和空间上的高效率。RIPPERk和C4.5rules都是先生成一个初始模型，然后在初始模型上迭代。但对于large noisy datasets，C4.5rules生成的初始模型（完全生成的决策树，由于noisy，可能会细分到每个叶子节点只包含一个样本）会过大，而RIPPEk一开始使用IREP*生成的初始模型的规模则会和目标空间较为接近。另外，在大数据集（样本数超过150）上， RIPPERk优于C4.5rules，反之相反。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">muzhen</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">358</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">113</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">muzhen</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  
  



  




  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  

  

  

  

  

  

  

  

  

  

</body>
</html>
