<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="the Home of MuZhen">
<meta property="og:url" content="http://www.muzhen.tk/page/7/index.html">
<meta property="og:site_name" content="the Home of MuZhen">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="the Home of MuZhen">






  <link rel="canonical" href="http://www.muzhen.tk/page/7/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>the Home of MuZhen</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">the Home of MuZhen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/lstm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/lstm/" class="post-title-link" itemprop="url">lstm</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="如何理解TF中BasicLSTMCell的输入参数size"><a href="#如何理解TF中BasicLSTMCell的输入参数size" class="headerlink" title="如何理解TF中BasicLSTMCell的输入参数size"></a><a href="https://www.zhihu.com/question/57981847" target="_blank" rel="noopener">如何理解TF中BasicLSTMCell的输入参数size</a></h1><p>就是指隐藏状态的维数。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/rnn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/rnn/" class="post-title-link" itemprop="url">rnn</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<h1 id="lstm"><a href="#lstm" class="headerlink" title="lstm"></a>lstm</h1><p>此处先说明tensorflow中以下代码的输出<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outputs,final_state = tf<span class="selector-class">.nn</span><span class="selector-class">.dynamic_rnn</span>(lstm_cell,x_in,initial_state=init_state,time_major=False)</span><br></pre></td></tr></table></figure></p>
<p>outputs储存每个时刻的输出，也就是下面的分线输出（它也同时被复制为当时时刻的外部输出）,它的形状是[batch_size,n_steps,n_hidden_units]（如果一开始的输入形式为[n_steps,batch_size,n_inputs]，则time_major=True，output形状为[n_steps,batch_size,n_hidden_units]）</p>
<p>final_state仅仅只记录最后时刻的主线状态和分线状态，默认以元组形式保存，主线状态在前。</p>
<p>因此，分线state和outputs最后一个时刻的记录是相同的，至少在基础lstm上。</p>
<p>lstm一开始需要定义的初始状态应该就是指一开始的主线和分线state。</p>
<p><img src="http://i2.muimg.com/567571/e28747d6a50b8fad.png" alt></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/mydear_11000/article/details/52414342" target="_blank" rel="noopener">解读tensorflow之rnn</a><br><a href="http://www.jianshu.com/p/9dc9f41f0b29" target="_blank" rel="noopener">[译] 理解 LSTM 网络</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/tensorflow函数说明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/tensorflow函数说明/" class="post-title-link" itemprop="url">tensorflow函数说明</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="tf-nn-embedding-lookup-amp-tf-nn-embedding-lookup-sparse"><a href="#tf-nn-embedding-lookup-amp-tf-nn-embedding-lookup-sparse" class="headerlink" title="tf.nn.embedding_lookup&amp;tf.nn.embedding_lookup_sparse"></a>tf.nn.embedding_lookup&amp;tf.nn.embedding_lookup_sparse</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">tf.nn.embedding_lookup(</span><br><span class="line">    params,</span><br><span class="line">    ids,</span><br><span class="line">    partition_strategy=<span class="string">'mod'</span>,</span><br><span class="line">    name=<span class="keyword">None</span>,</span><br><span class="line">    validate_indices=<span class="keyword">True</span>,</span><br><span class="line">    max_norm=<span class="keyword">None</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">tf.nn.embedding_lookup_sparse(</span><br><span class="line">    params,</span><br><span class="line">    sp_ids,</span><br><span class="line">    sp_weights,</span><br><span class="line">    partition_strategy=<span class="string">'mod'</span>,</span><br><span class="line">    name=<span class="keyword">None</span>,</span><br><span class="line">    combiner=<span class="keyword">None</span>,</span><br><span class="line">    max_norm=<span class="keyword">None</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>params是embedding的参数tensor（设为$F*K$），ids是指明索引的tensor， sp_ids是指明索引的sparse_tensor。</p>
<p>函数的目的是根据索引来进行embedding tensor的按第一维度切片。</p>
<p>如果ids是一维张量N，就是按ids寻找index对应元素，返回tensor是$N*K$。</p>
<p>如果是ids二维张量$N<em>M$，则是按照第二维度寻找index对应元素，寻找N次，组合后返回就是$N</em>M*K$。</p>
<p>在embedding_lookup_sparse中，则是根据稀疏矩阵sp_ids（设为$N<em>M$）来寻找index对应元素。不同点在于，按照index找到的元素需要根据combiner参数指定的方式来进行聚合操作，最终变成$(K,)$的tensor。因此完整的返回是$N</em>K$</p>
<p>另外需要注意的是partition_strategy参数。当params为多个tensor构成的list（实际上会合并成一个大tensor）时，该参数负责指定合并后大tensor的index编排方法。list的长度为分区数，设为p。总元素数量（第一维度总长度）设为$id+1$。</p>
<p>在div情况下就按照顺序来排index；</p>
<p>在mod情况下，每个分区的基本元素数量为$id //p$，由于不一定能够整除，前$(id+ 1) \% p$个分区的元素数量加一。那么index的编排就是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">params = [<span class="number">2</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>, <span class="number">3</span>*<span class="number">4</span>]</span><br><span class="line">三个分区，每个分区的基本元素数为<span class="number">6</span>//<span class="number">3</span>=<span class="number">2</span>, 前<span class="number">7</span>%<span class="number">3</span>=<span class="number">1</span>个分区元素数量加一</span><br><span class="line">重新编排后就是</span><br><span class="line">[<span class="number">3</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>]</span><br><span class="line">他们的index则是</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]*<span class="number">3</span>+<span class="number">0</span>, [<span class="number">0</span>,<span class="number">1</span>]*<span class="number">3</span>+<span class="number">1</span>, [<span class="number">0</span>,<span class="number">1</span>]*<span class="number">3</span>+<span class="number">2</span>, 即是</span><br><span class="line">[<span class="number">0</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">5</span>]。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/tensorflow变量初始化方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/tensorflow变量初始化方法/" class="post-title-link" itemprop="url">tensorflow变量初始化方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/fireflychh/article/details/73692183" target="_blank" rel="noopener">tensorflow中tf.random_normal和tf.truncated_normal的区别</a></p>
<p><a href="http://www.bubuko.com/infodetail-2099623.html" target="_blank" rel="noopener">tensorflow 1.0 学习：参数初始化（initializer)</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第三章——改进神经网络的学习方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第三章——改进神经网络的学习方法/" class="post-title-link" itemprop="url">《神经网络和深度学习》第三章——改进神经网络的学习方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="损失函数选择"><a href="#损失函数选择" class="headerlink" title="损失函数选择"></a>损失函数选择</h1><p>当均方误差作为损失函数，S型曲线作为激活函数时，梯度和激活函数导数相关。<br>因此当严重误判时（i.e.真值为0预测输出接近1），由于此时S型激活函数在两侧导数都非常小，会出现犯了明显错误但学习却非常缓慢的情况。<br>而交叉熵和S型输出层组合并不会出现这个问题，因为经过计算可知梯度和预测错误相关（预测错误 = 预测值-真值），但仅仅限于输出神经元上。但遗憾的是，<br>交叉熵情况下，对权重梯度跟输入\(a_j^l\)相关，因此当\(a_j^l\)趋向于0时，权重梯度会很小，学习缓慢。  </p>
<p>回顾logistic回归，交叉熵可以由极大似然估计推出。</p>
<p>softmax输出层和对数似然代价组合是另一种可能。</p>
<p><em>交叉熵代价在变大，而分类准确率在上升，这是可能的。合理的选用代价函数（便于优化），以及合理的调参（提高分类准确率）。</em></p>
<h1 id="防止过拟合"><a href="#防止过拟合" class="headerlink" title="防止过拟合"></a>防止过拟合</h1><ol>
<li><p>增加样本</p>
</li>
<li><p>L2规范化/权重衰减<br>规范化项里面不包含偏置。因此，对于偏置梯度不变。对于权重梯度：<br>$$\frac{\partial C}{\partial \omega} = \frac{\partial C_0}{\partial \omega} + \frac{\lambda}{n}\omega$$<br>$$\frac{\partial C}{\partial b} = \frac{\partial C_0}{\partial b}$$<br>其中\(C_0\)是原始代价函数：<br>$$C = C_0 + \frac{\lambda}{2n}\sum_\omega\omega^2$$<br>因此，权重学习规则就变成：<br>\begin{split}\omega \rightarrow \omega - \eta\frac{\partial C_0}{\partial \omega} - \frac{\eta\lambda}{n}\omega\newline<br>= (1 - \frac{\eta\lambda}{n})\omega - \eta\frac{\partial C_0}{\partial \omega}\end{split}<br>故而它又被称作权重衰减。<br><em>L2规范化还可以帮助逃离局部最优值。</em><br>规范化更倾向于小权重，对于输入噪音不会过度敏感。<br>不对偏置进行规范化，是因为：</p>
<ul>
<li>实践看来改善不明显</li>
<li>大的偏置并不会对噪音敏感</li>
<li>大的偏置让网络更加灵活，让神经元更加容易饱和  </li>
</ul>
</li>
</ol>
<p>为什么L2规范化往往比不做规范化有更好的结果？<br>仅是实践经验，并不是因为“奥卡姆剃刀”。因为简单更好本身就无法证明，何况也无法严格判定在他同等效果下哪个模型更简单（对效果除权很难）。<br>对模型真正的测试不是简单性，而是在新场景中新活动的预测能力。</p>
<ol start="3">
<li><p>L1规范化<br>代价函数变为：<br>$$C = C_0 + \frac{\lambda}{2n}\sum_\omega|\omega|$$<br>求导得：<br>$$\frac{\partial C}{\partial \omega} = \frac{\partial C_0}{\partial \omega} + \frac{\lambda}{n}sgn(\omega)$$<br>因此更新规则为：<br>$$\omega \rightarrow \omega - \frac{\lambda}{n}sgn(\omega) - \frac{\partial C_0}{\partial \omega}$$<br>在L2规范化中，权重通过一个和$\omega$成比例的量进行缩小。在L1中，权重通过一个常量向0缩小。<br>所以，当权重绝对值很大时，L1规范化的权重缩小原比L2规范化要小的多。相反，当一个特定的权重绝对值很小时，L1规范化的权重缩小要比L2规范化大的多。<br>最终结果就是，L1规范化倾向于聚集网络权重在相对少量的高重要度连接上，而其他权重就会被驱使向0接近。</p>
</li>
<li><p>弃权（dropout）<br>在训练过程中通过概率使得部分隐藏神经元不参与计算和更新，不断重复这个过程使得权重选择性更新。最终得到的结果就可以视为bagging。<br>这样理解好象是错的？</p>
</li>
<li><p>人为扩展训练数据<br>就MNIST而言，可以通过对图像进行小幅旋转来认为产生新数据。<br>在语音识别中，还可以通过增加背景噪声来扩展训练数据，从而更加关注普适特征，训练出更具范化能力的模型。</p>
</li>
</ol>
<h1 id="权重初始化"><a href="#权重初始化" class="headerlink" title="权重初始化"></a>权重初始化</h1><p>一般采用标准正态分布来进行权重和偏置初始化。<br>考虑一个极端情况，一共n个输入神经元，输入值都为1。那么加权和就会服从均值0,方差n+1的正态分布，形如：<br><img src="http://p1.bpimg.com/567571/d42d2eff91ab2285.png" alt><br>就会造成带权和很大，从而相对应的隐藏神经元饱和，激活值接近0或1。从而梯度下降学习将会非常缓慢。<br>因此，我们可以选择均值0,方差1/n的正态分布来进行权重初始化，对于偏置习惯上依旧使用标准正态分布。</p>
<h1 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h1><ul>
<li>学习率</li>
<li>正则项系数</li>
<li>minibatch数量</li>
<li>迭代次数</li>
<li>隐藏神经元数量</li>
<li>层数</li>
<li>输出编码方式</li>
</ul>
<h1 id="其他技术"><a href="#其他技术" class="headerlink" title="其他技术"></a>其他技术</h1><ol>
<li><p>Hessian优化（泰勒展开与二阶近似）</p>
</li>
<li><p>基于momentum的梯度下降</p>
</li>
</ol>
<h1 id="其他激活函数"><a href="#其他激活函数" class="headerlink" title="其他激活函数"></a>其他激活函数</h1><ul>
<li><p>tanh<br><img src="http://i1.piimg.com/567571/32cda276ddd538ca.png" alt>  </p>
</li>
<li><p>relu<br><img src="http://i1.piimg.com/567571/c10b3dae75ed663c.png" alt></p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第五章——深度神经网络为何很难训练/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第五章——深度神经网络为何很难训练/" class="post-title-link" itemprop="url">《神经网络和深度学习》第五章——深度神经网络为何很难训练</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="不稳定的梯度问题"><a href="#不稳定的梯度问题" class="headerlink" title="不稳定的梯度问题"></a>不稳定的梯度问题</h1><p><img src="http://p1.bpimg.com/567571/c337283e1a426f2f.png" alt>  </p>
<p>以上图为例，会出现：</p>
<ol>
<li><p><strong>消失的梯度问题</strong>：<br>当$\omega_i\sigma_i^{‘}$小于1时。由于一般初始权重在0附近，且使用sigmoid神经元，所以消失的梯度问题更容易出现。<br>其实，即使权重很大，对于sigmoid函数而言，越大的权重会导致对应的sigmoid函数倒数越接近0,因此更容易梯度消失。</p>
</li>
<li><p><strong>激增的梯度问题</strong>：<br>当$\omega_i\sigma_i^{‘}$大于1时。当初始权重很大时出现。</p>
</li>
</ol>
<p>根本问题是因为前面层上的梯度是来自后面层上项的乘积。当存在过多的层次时，就出现了内在本质上的不稳定场景。<br>所以，如果我们使用标准的基于梯度的学习算法，在网络中的不同层就会出现按照不同学习速度学习的情况。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第二章——反向传播算法如何工作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第二章——反向传播算法如何工作/" class="post-title-link" itemprop="url">《神经网络和深度学习》第二章——反向传播算法如何工作</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="反向传播算法"><a href="#反向传播算法" class="headerlink" title="反向传播算法"></a>反向传播算法</h1><p>反向传播算法通过<em>链式法则</em>来简化计算<em>损失函数对各权重和偏置的梯度</em>。</p>
<h2 id="符号说明、一个定义、四个关键方程："><a href="#符号说明、一个定义、四个关键方程：" class="headerlink" title="符号说明、一个定义、四个关键方程："></a>符号说明、一个定义、四个关键方程：</h2><ol>
<li><p>符号说明：<br>\(l-1\)层\(k\)神经元与\(l\)层\(j\)神经元连接权重： \(\omega_{jk}^l\)<br>带权和： \(z_j^{l} = \sum\limits_{k}{\omega_{jk}^{l}a_k^{l-1}} + b_j^l\)<br>激活值： \(a_j^l = \sigma(z_j^l)\)</p>
</li>
<li><p>定义\(l\)层\(j\)神经元误差：<br>$$\delta_j^l = \frac{\partial C}{\partial z_j^l}$$<br>最优化时，梯度应当为0,因此可以理解为梯度绝对值越大，离最优化状态越远，误差越大。之所以对z而不是a求梯度，则是计算方便的考虑。</p>
</li>
<li><p>输出层误差方程：<br>$$\delta_j^L = \frac{\partial C}{\partial a_j^L}\sigma^{‘}(z_j^L)$$<br>矩阵形式：<br>$$\delta^L = \nabla_aC \odot \sigma^{‘}(z^L)$$</p>
</li>
<li><p>使用下一层的误差\(\delta^{l+1}\)来表示当前层的误差\(\delta^l\)：<br>$$\delta_j^l = \sum_k{\omega_{kj}^{l+1}\delta_k^{l+1}\sigma^{‘}(z_j^l)}$$<br>矩阵形式：<br>$$\delta^l = ((\omega^{l+1})^T\delta^{l+1}) \odot \sigma^{‘}(z^l)$$</p>
</li>
<li><p>损失函数对偏置的导数：<br>$$\frac{\partial C}{\partial b_j^l} = \delta_j^l$$</p>
</li>
<li><p>损失函数对权重的导数：<br>$$\frac{\partial C}{\partial \omega_{jk}^l} = a_k^{l-1}\sigma_j^l$$</p>
</li>
</ol>
<h2 id="伪代码如下："><a href="#伪代码如下：" class="headerlink" title="伪代码如下："></a>伪代码如下：</h2><ol>
<li><p>计算并记录前向传播过程中<em>带权和</em>和<em>激活值</em>;</p>
</li>
<li><p>利用公式计算代价函数对参数梯度</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第六章——深度学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第六章——深度学习/" class="post-title-link" itemprop="url">《神经网络和深度学习》第六章——深度学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="CNN"><a href="#CNN" class="headerlink" title="CNN"></a>CNN</h1><p>充分利用空间特征。</p>
<ul>
<li><p>局部感受野<br>隐藏层中每个神经元链接到输入神经元的一个小区域。</p>
</li>
<li><p>共享权重和偏置<br>即是应用相同的特征检测器。因此也可以很好的适应图像的平移不变性。<br>我们有时候把从输入层到隐藏层的映射称为一个特征映射。我们把定义特征映射的权重称为共享权重。我们把以这种方式定义特征映射的偏置称为共享偏置。<br>共享权重和偏置经常被称为一个卷积核或者滤波器。</p>
</li>
<li><p>混合层（pooling layers）<br>混合层通常紧接着在卷积层之后使用。用于简化从卷积层输出的信息。</p>
</li>
</ul>
<p>一些常用的混合程序：</p>
<ul>
<li>最大值混合（max-pooling）：取最大值</li>
<li>L2混合（L2-pooling）：取激活值平方和的平方根</li>
</ul>
<p>一个使用5×5局部感受野和3个特征映射，以及应用于2×2区域的最大值混合层如下所示：</p>
<p><img src="http://i4.buimg.com/567571/3dae256ad7f99167.png" alt></p>
<p>[TBC]卷积网络中的反向传播？</p>
<h1 id="CNN实践"><a href="#CNN实践" class="headerlink" title="CNN实践"></a>CNN实践</h1><ul>
<li><p>加入第二个卷积-混合层<br>地一个卷积-混合层的输出是经过抽象和凝缩过的版本，但仍然有大量的空间结构。因此使用第二个卷积-混合层是有意义的。<br>以上例来说，输出是3×12×12,那么第二个卷积层的局部感受野应该是3×k×k。也就是说使用前面所有混合层数据。这是一个需要注意的地方。</p>
</li>
<li><p>切换激活函数<br>tanh，relu等。</p>
</li>
<li><p>扩展训练数据</p>
</li>
<li><p>插入额外的全连接层</p>
</li>
<li><p>使用组合网络<br>训练多个网络进行投票</p>
</li>
<li><p>对全连接层进行dropout<br>卷积层先天可以抵抗过拟合。原因是共享权重意味着卷积滤波器被强制从整个图像中学习。这使他们不太可能去选择在训练数据中的局部特质。于是就很少有必要来应用其他规范化，例如弃权。</p>
</li>
</ul>
<h1 id="为什么我们能够训练"><a href="#为什么我们能够训练" class="headerlink" title="为什么我们能够训练"></a>为什么我们能够训练</h1><p>我们是如何克服不稳定的梯度问题的？</p>
<ul>
<li>使用卷积层极大的减少了这些层中的参数的数目，使学习的问题更容易</li>
<li>使用更多强有力的规范化技术（尤其是弃权和卷积层）来减少过度拟合</li>
<li>使用修正线性单元而不是S型神经元，来加速训练 [TBC]?</li>
<li>使用GPU并愿意长时间训练</li>
</ul>
<p>以及其他技巧：</p>
<ul>
<li>使用充分大的数据集（避免过拟合）</li>
<li>使用正确的代价函数（避免学习减速）</li>
<li>使用好的权重初始化（避免神经元饱和和其引起的学习减速）</li>
</ul>
<h1 id="TBC-一些问题"><a href="#TBC-一些问题" class="headerlink" title="[TBC]一些问题"></a>[TBC]一些问题</h1><ul>
<li><p>对relu使用sigmoid函数的初始化方法会怎么样？</p>
</li>
<li><p>前面不稳定的梯度问题是针对sigmoid函数讨论的，对relu，会有什么差异？</p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明/" class="post-title-link" itemprop="url">《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script><br>神经网络一个最显著的事实就是它可以计算任何的函数。它具有一种<em>普遍性</em>！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cluster/cluster evaluation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cluster/cluster evaluation/" class="post-title-link" itemprop="url">cluster evaluation</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cluster/" itemprop="url" rel="index"><span itemprop="name">cluster</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<p>本文总结聚类结果的好坏评估。评估可以分为两大类，已知类别和未知类别。</p>
<h1 id="已知类别"><a href="#已知类别" class="headerlink" title="已知类别"></a>已知类别</h1><h2 id="Rand-index-amp-Adjusted-Rand-index"><a href="#Rand-index-amp-Adjusted-Rand-index" class="headerlink" title="Rand index &amp; Adjusted Rand index"></a>Rand index &amp; Adjusted Rand index</h2><p>设样本数为\(n\),实际类别信息为\(C \),聚类结果为\(K\),\(a\)表示在\(C \)和\(K\)中都是同类别的元素对数，\(b\)表示在\(C \)和\(K\)中都是不同类别的元素对数，则兰德指数为：<br>$$ RI = \frac{a+b}{C^{2}_{n}}$$<br>显然，Rand index取值范围[0,1],越大聚类效果越好。</p>
<p>但对于随机结果，并不能保证分数接近零。为了实现这个目标，提出ARI，它具有更高的区分度：<br>$$ ARI = \frac{RI - E[RI]}{\max(RI) - E[RI]}$$</p>
<p>我一开始觉得RI存在一个问题，那就是只使用元素对去评估效果，可能忽略整体聚类情况。但细想之后发现并不会。因为任意两个元素对都会被计算，因此整体类别情况也会被考虑到。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)  </span><br><span class="line"><span class="number">0.24</span></span><br></pre></td></tr></table></figure>
<h2 id="Mutual-Information-based-scores"><a href="#Mutual-Information-based-scores" class="headerlink" title="Mutual Information based scores"></a>Mutual Information based scores</h2><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/sinat_26917383/article/details/70577710" target="_blank" rel="noopener">聚类︱python实现 六大 分群质量评估指标（兰德系数、互信息、轮廓系数）</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/competition/trick/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/competition/trick/" class="post-title-link" itemprop="url">trick</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/competition/" itemprop="url" rel="index"><span itemprop="name">competition</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="benchmark"><a href="#benchmark" class="headerlink" title="benchmark"></a>benchmark</h1><p>就0-1分类问题而言，可以将训练集target整体均值作为测试集每个样本的预测概率。从而找到最基本的benchmark。</p>
<p><a href="https://www.kaggle.com/davidthaler/quora-question-pairs/how-many-1-s-are-in-the-public-lb" target="_blank" rel="noopener">而且，还可以根据提交得分反推出1类占比。</a></p>
<p>\begin{split} logloss &amp;&amp;= - \frac{1}{n} \sum y_i \log p + (1 - y_i) \log (1-p) \newline<br>&amp;&amp;= - (r \log p + (1 - r) \log (1 - p)) \newline<br>&amp;&amp;= r \log \frac{1-p}{p} - \log (1 - p)\end{split}<br>由此推得1类占比：<br>\begin{split} r = (logloss + \log (1-p))/ \log \frac{1-p}{p}\end{split}</p>
<h1 id="score"><a href="#score" class="headerlink" title="score"></a>score</h1><p>以logloss得分为例。</p>
<p>假设原训练集不均衡。在建模时通过采样使得训练集均衡，然后对测试集进行预测。通过设定threshold，将预测概率0-1化，计算准确率是没有问题的。</p>
<p>但是，由于采用logloss评分，实际上预测概率会偏大！因为真实的正负样本比例小于0.5！最简单的方法就是将预测结果除以采样后正负样本比例再乘以真实比例！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/competition/quora/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/competition/quora/" class="post-title-link" itemprop="url">quora</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/competition/" itemprop="url" rel="index"><span itemprop="name">competition</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="sources"><a href="#sources" class="headerlink" title="sources"></a>sources</h1><p><a href="https://www.kaggle.com/c/quora-question-pairs" target="_blank" rel="noopener">quora</a></p>
<h1 id="what-have-I-learned"><a href="#what-have-I-learned" class="headerlink" title="what have I learned?"></a>what have I learned?</h1><p><a href="https://www.kaggle.com/anokas/quora-question-pairs/data-analysis-xgboost-starter-0-35460-lb/notebook" target="_blank" rel="noopener">Data Analysis &amp; XGBoost Starter (0.35460 LB)
</a></p>
<ul>
<li><p>画图时通过<code>plt.yscale(&#39;log&#39;, nonposy=&#39;clip&#39;)</code>可以改变纵轴量级，使得原本因为量级差距巨大而造成的图形更有可看性。</p>
</li>
<li><p>通过提交均值来寻找一个基础的benchmark。</p>
</li>
<li><p>根据提交均值后的得分估算出测试集中的正样本比例。</p>
</li>
<li><p>绘制词云图。</p>
</li>
<li><p>用nltk包中的stopwords来进行停用词剔除。</p>
</li>
<li><p>计算两个句子共享词时，用共有词的数量除以两个句子长度均值来正则化。</p>
</li>
<li><p>能够自己实现并定制tf，idf。</p>
</li>
<li><p>平衡数据集比例，使得train和test一致，从而得到好的结果。</p>
</li>
<li><p>会使用xgboost的early_stopping_rounds参数</p>
</li>
</ul>
<p><a href="https://www.kaggle.com/philschmidt/quora-question-pairs/quora-eda-model-selection-roc-pr-plots/comments" target="_blank" rel="noopener">Quora EDA &amp; Model selection (ROC, PR plots)
</a></p>
<ul>
<li>优美的降维和可视化技巧。待学习[TBC]</li>
</ul>
<p><a href="https://www.kaggle.com/puneetsl/quora-question-pairs/unusual-meaning-map/notebook" target="_blank" rel="noopener">Unusual meaning map
</a></p>
<ul>
<li><p>学习到了nltk.word_tokenize</p>
</li>
<li><p>巧妙的特征构造方法，利用笛卡尔积形式计算两个句子各词的相似度。并最后扑展（扩充）成一定维数的特征。</p>
</li>
<li><p>进一步了解了w2v和wmd</p>
</li>
</ul>
<p><a href="https://www.kaggle.com/c/quora-question-pairs/discussion/31019" target="_blank" rel="noopener">fm benchmark with tfidf around 29</a></p>
<ul>
<li><p>学习到了使用nltk寻找词干，<a href="https://www.kaggle.com/currie32/quora-question-pairs/the-importance-of-cleaning-text/comments" target="_blank" rel="noopener">The Importance of Cleaning Text
</a>中亦有介绍，更为简单。</p>
</li>
<li><p>学习到了使用a.intersection(b)计算集合间的交集。</p>
</li>
<li><p>学习到了如何清爽的整理代码，生成特征。</p>
</li>
<li><p>学习到了字串的jaccard距离，编辑距离及其计算。</p>
</li>
<li><p>给出了fm实现，待学习[TBC]。</p>
<p><a href="https://www.kaggle.com/c/quora-question-pairs/discussion/30967" target="_blank" rel="noopener">Score 0.3250 (or 0.31) using StackNet with sparse data</a></p>
<ul>
<li>stacknet，待学习[TBC]。</li>
</ul>
</li>
</ul>
<p> # </p>
<ul>
<li>crowdfloer</li>
<li>homedepot</li>
<li>SemEval<br><a href="https://github.com/rgtjf/Semantic-Texual-Similarity-Toolkits" target="_blank" rel="noopener">https://github.com/rgtjf/Semantic-Texual-Similarity-Toolkits</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/coss function/对数损失函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/coss function/对数损失函数/" class="post-title-link" itemprop="url">对数损失函数</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/coss-function/" itemprop="url" rel="index"><span itemprop="name">coss function</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>



<h1 id="对数损失函数"><a href="#对数损失函数" class="headerlink" title="对数损失函数"></a>对数损失函数</h1><p>$$<br>L(Y, P(Y|X)) = -\log(P(Y|X))<br>$$</p>
<p>对数损失函数的含义是，对于分类y，在给定X情况下，使得$P(Y=y|X)$的概率最大化。</p>
<h1 id="logistic回归"><a href="#logistic回归" class="headerlink" title="logistic回归"></a>logistic回归</h1><p>那么，对于logsitic损失函数，除了使用极大似然法进行推导外，还可以直接从对数损失函数的角度出发进行推导：<br>$$<br>\begin{equation}<br>P(Y|X) = \left\{<br>\begin{array}{lr}<br>h_\theta(x) = \sigma(f(x)) = \frac{1}{1 + \exp(-f(x))}, &amp; y=1\\<br>1 - h_\theta(x) = 1 - \sigma(f(x)) = \frac{1}{1 + \exp(f(x))}, &amp; y= 0<br>\end{array}<br>\right. \\</p>
<p>L(Y, P(Y=y|X)) = \left\{<br>\begin{array}{lr}<br>-\log h_\theta(x) = \log (1 + \exp(-f(x))), &amp; y=1\\</p>
<ul>
<li>\log(1 - h_\theta(x)) = \log (1 + \exp(f(x))), &amp; y= 0<br>\end{array}<br>\right. \\</li>
</ul>
<p>J(\theta) = -\frac{1}{n}\sum_{i=1}^{n}( y^{i}\log h_\theta(x^i)  + (1 - y^i)\log(1 - h_\theta(x^i)) )<br>\end{equation}<br>$$<br>如果将y标签设置为1和-1，则可以有另外一种形式实现表达式的统一：<br>$$<br>\begin{equation}<br>P(Y|X) = \left\{<br>\begin{array}{lr}<br>h_\theta(x) = \sigma(f(x)) = \frac{1}{1 + \exp(-f(x))} = \frac{1}{1 + \exp(-yf(x))}, &amp; y=1\\<br>1 - h_\theta(x) = 1 - \sigma(f(x)) = \frac{1}{1 + \exp(f(x))} = \frac{1}{1 + \exp(-yf(x))}, &amp; y= -1<br>\end{array}<br>\right. \\<br>L(Y, P(Y=y|X)) = -\log h_\theta(x) = \log (1 + \exp(-yf(x))) = \log \sigma(yf(x)) \\<br>J(\theta) = -\frac{1}{n}\sum_{i=1}^{n}\log (1 + \exp(-y^if(x^i)))<br>\end{equation}<br>$$</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><strong><em><a href="https://www.cnblogs.com/ljygoodgoodstudydaydayup/p/6340129.html" target="_blank" rel="noopener">FM算法及FFM算法</a></em></strong></p>
<p><a href="https://www.zhihu.com/question/27126057/answer/92250611" target="_blank" rel="noopener">对数损失函数是如何度量损失的</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/End-to-End Learning of Motion Representation for Video Understanding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/End-to-End Learning of Motion Representation for Video Understanding/" class="post-title-link" itemprop="url">End-to-End Learning of Motion Representation for Video Understanding</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>人工抽取的光流特征被广泛的应用在视频分析问题上，并没有能够end-to-end。本文提出TVNet解决这个问题。</p>
<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p>现有的光流特征提取方法有效但是运算低效。存在一些显著的缺点：</p>
<ul>
<li>训练分为两步。先抽取光流特征在训练，不是end-to-end</li>
<li>光流特征抽取时间和空间资源占用很大</li>
</ul>
<p>为了处理这些问题，通过模仿和展开TV-L1的迭代优化过程，文章提出了TVNet。特别的，我们将TV-L1的迭代方法做成了nn的一个自定义层。结果是：</p>
<ul>
<li>TVNet可以直接使用，而不需要基于标注好的光流数据进行额外训练</li>
<li>TVNet可以end-to-end，不需要预计算和存储光流特征</li>
<li>由于网络直接和label关联，因此可以进一步自动学习光流抽取器的参数，使得特征更加丰富和task-specific</li>
</ul>
<h1 id="2-Related-Work"><a href="#2-Related-Work" class="headerlink" title="2. Related Work"></a>2. Related Work</h1><p>有许多深度构架的尝试去学习视频的运动特征，主要有两个大方向：</p>
<ul>
<li>将2D卷积扩展到3D，但这样会计算量大、对数据量要求高</li>
<li>two-stream networks，训练两个网络，一个使用图像（i.e. RGB）数据，一个使用手工运动特征例如光流来表征运动模式</li>
</ul>
<p>光流特征抽取一般使用cnn，需要大量的成本高昂的光流标注数据。</p>
<p>近期，FlowNet被提出，它通过单个网络，利用合成的真实数据来学习光流特征和行为识别。</p>
<h1 id="3-Notations-and-background"><a href="#3-Notations-and-background" class="headerlink" title="3. Notations and background"></a>3. Notations and background</h1><h2 id="3-1-Notations"><a href="#3-1-Notations" class="headerlink" title="3.1 Notations"></a>3.1 Notations</h2><p>视频是一个图像序列，定义$I_t(x,y)$为像素亮度函数，$x$，$y$为平面坐标，$t$为时间，$I$为亮度。</p>
<h2 id="3-2-The-TV-L1-method"><a href="#3-2-The-TV-L1-method" class="headerlink" title="3.2 The TV-L1 method"></a>3.2 The TV-L1 method</h2><p>在现有的估计光流的方法中，TV-L1很好的实现了效率和精度之间的平衡。</p>
<p>min  (|∇u (x)| + |∇u (x)|) + λ|ρ(u(x))|<br>$$<br>\min_{u(\bold x), \bold x\in \Omega} \sum_{\bold x \in \Omega}()<br>$$</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/ffmpeg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/ffmpeg/" class="post-title-link" itemprop="url">ffmpeg</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在做物体识别方面的工作，整体流程是接收直播流，用yolo进行特定物体识别，推送处理后的视频流到指定地址。其中，需要用到ffmpeg进行处理。现将ffmpeg使用过程总结一下。</p>
<h1 id="install"><a href="#install" class="headerlink" title="install"></a>install</h1><p>ffmpeg有一系列依赖包，可按照官网直接用<code>sudo apt-get</code>依次安装 <a href="https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu" target="_blank" rel="noopener">Compilation &amp; Installation</a></p>
<p><code>sudo apt-get install ffmpeg</code></p>
<h1 id="process"><a href="#process" class="headerlink" title="process"></a>process</h1><h2 id="编码格式"><a href="#编码格式" class="headerlink" title="编码格式"></a>编码格式</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffprobe <span class="selector-tag">input</span>.mp4</span><br></pre></td></tr></table></figure>
<p>可以使用以上命令去查看文件的视频和音频编码格式</p>
<h2 id="视频切割："><a href="#视频切割：" class="headerlink" title="视频切割："></a>视频切割：</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -<span class="selector-tag">i</span> <span class="selector-tag">input</span><span class="selector-class">.mp4</span> -ss <span class="number">0</span> -c copy -t <span class="number">60</span> -y output.mp4</span><br></pre></td></tr></table></figure>
<p><code>-i</code> 表示待处理的视频源</p>
<p><code>-ss</code>，<code>-t</code> 表示切割视频的起始时间点和切割时长。有两种写法：<code>0</code>，<code>00：01：20</code>。前者表示秒，后者是时:分:秒格式。</p>
<p><code>-to</code> 表示结束时间点。 但如果 <code>-ss</code> 放在 <code>-i</code> 前面，则效果和 <code>-t</code> 一样。有的blog在这个问题上说反了，特此说明。只要 <code>-ss</code> 始终放 <code>-i</code> 后面，就不会出问题了。</p>
<p><code>-y</code> 表示如果输出文件存在，则覆盖原文件</p>
<p><code>-c</code> 表示编码器，是<code>-codec</code>的缩写。 <code>-c copy</code>指复制原视频编码流。</p>
<p><code>-c:v -c:a</code> 表示分别指定视频音频编码流格式。也可以写成 <code>-vcodec -acodec</code>或者 <code>-c:0 -c:1</code>一般0是视频流，1是音频流。如果出现多音频流，可以用<code>-c:a:0</code>形式去选择。</p>
<p><code>-vn -an</code> 分别表示屏蔽视频流，音频流。 </p>
<p>在使用命令时好像必须同时指定视频流和音频流的处理，不能只指定某一个。</p>
<h2 id="视频拼接："><a href="#视频拼接：" class="headerlink" title="视频拼接："></a>视频拼接：</h2><p>需要先将需要拼接的视频文件按以下格式保存在一个列表 list.txt 中：<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file1'</span><br><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file2'</span><br><span class="line"><span class="built_in">file</span> '/path/<span class="keyword">to</span>/file3'</span><br></pre></td></tr></table></figure></p>
<p>然后使用一下命令拼接<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f concat -<span class="selector-tag">i</span> list<span class="selector-class">.txt</span> -c copy output.mp4</span><br></pre></td></tr></table></figure></p>
<h2 id="视频转换为ts格式"><a href="#视频转换为ts格式" class="headerlink" title="视频转换为ts格式"></a>视频转换为ts格式</h2><p>将视频转换为ts</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -<span class="selector-tag">i</span> <span class="selector-tag">input</span><span class="selector-class">.mp4</span> -c copy -bsf h264_mp4toannexb output.ts</span><br></pre></td></tr></table></figure>
<p><code>-bsf</code> 是比特流过滤器。不知道具体有什么用，但是必须得有。而且参数必须设置成<code>h264_mp4toannexb</code>,其他过滤器可以通过<code>ffmpeg -bsfs</code>查看。如果是转成flv则不需要该参数，其他格式没有尝试。</p>
<h1 id="视频切片并生成m3u8播放列表"><a href="#视频切片并生成m3u8播放列表" class="headerlink" title="视频切片并生成m3u8播放列表"></a>视频切片并生成m3u8播放列表</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ffmpeg</span> <span class="selector-tag">-i</span> <span class="selector-tag">output</span><span class="selector-class">.mp4</span> <span class="selector-tag">-f</span> <span class="selector-tag">segment</span> <span class="selector-tag">-segment_time</span> 10 <span class="selector-tag">-segment_format</span> <span class="selector-tag">mpegts</span> <span class="selector-tag">-segment_list</span> <span class="selector-tag">list_file</span><span class="selector-class">.m3u8</span> <span class="selector-tag">-c</span> <span class="selector-tag">copy</span> <span class="selector-tag">-bsf</span><span class="selector-pseudo">:v</span> <span class="selector-tag">h264_mp4toannexb</span> <span class="selector-tag">-map</span> 0 <span class="selector-tag">output_file-</span>%<span class="selector-tag">d</span><span class="selector-class">.ts</span></span><br></pre></td></tr></table></figure>
<p>如果输入是ts文件，不需要加<code>-bsf</code>参数</p>
<p><code>-map</code> 没有具体搞懂这个参数。只知道<code>-map 0</code>代表复制第一个文件中的所有流到输出文件中。详情参<a href="http://blog.csdn.net/tao_627/article/details/22403615" target="_blank" rel="noopener">FFMPEG转码常用命令研究</a></p>
<p><code>-segment_format</code> 去掉后不影响命令实现。可能和跟严格的格式要求和应用有关。</p>
<p>首先，我们需要有一个原生直播流。暂时采用的是将直播流分割成一个一个ts不断传给后端，然后后端进行处理。因此，我们可以使用一个本地视频</p>
<p>直播：本地运行：<br>ffmpeg -f avfoundation -framerate 30 -i “1:0” -f avfoundation -framerate 30 -video_size 640x480 -i “0” -c:v libx264 -preset ultrafast -filter_complex ‘overlay=main_w-overlay_w-10:main_h-overlay_h-10’ -acodec libmp3lame -ar 44100 -ac 1  -f flv rtmp://10.165.33.20:1935/hls/test</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/redstarofsleep/article/details/45092145" target="_blank" rel="noopener">ubuntu14.04安装ffmpeg</a></p>
<p><a href="https://segmentfault.com/a/1190000000414341" target="_blank" rel="noopener">通过 ffmpeg 无损剪切/拼接视频</a></p>
<p><a href="http://blog.csdn.net/leixiaohua1020/article/details/15811977/" target="_blank" rel="noopener">[总结]FFMPEG视音频编解码零基础学习方法</a></p>
<p><strong><em><a href="http://blog.csdn.net/tao_627/article/details/22403615" target="_blank" rel="noopener">FFMPEG转码常用命令研究</a></em></strong></p>
<p><strong><em><a href="http://www.360doc.com/content/13/0901/17/9305922_311411358.shtml" target="_blank" rel="noopener">FFMPEG详解</a></em></strong></p>
<p><a href="http://blog.csdn.net/zhichao2001/article/details/12610465" target="_blank" rel="noopener">ffmpeg教程</a></p>
<p><strong><em><a href="http://www.cnblogs.com/wainiwann/p/4128154.html" target="_blank" rel="noopener">FFmpeg常用基本命令</a></em></strong></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/data_compute/窗口函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/data_compute/窗口函数/" class="post-title-link" itemprop="url">窗口函数</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/data-compute/" itemprop="url" rel="index"><span itemprop="name">data_compute</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://medium.com/jbennetcodes/how-to-get-rid-of-loops-and-use-window-functions-in-pandas-or-spark-sql-907f274850e4" target="_blank" rel="noopener">How to get rid of loops and use window functions, in Pandas or Spark SQL</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cv/opencv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cv/opencv/" class="post-title-link" itemprop="url">opencv</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cv/" itemprop="url" rel="index"><span itemprop="name">cv</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="查看opencv配置信息"><a href="#查看opencv配置信息" class="headerlink" title="查看opencv配置信息"></a>查看opencv配置信息</h1><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -<span class="keyword">c</span> <span class="string">"import cv2; print(cv2.getBuildInformation())"</span></span><br></pre></td></tr></table></figure>
<h1 id="安装opencv"><a href="#安装opencv" class="headerlink" title="安装opencv"></a>安装opencv</h1><p>opencv安装过程需要选择支持ffmpeg，有显卡还需要支持cuda。一般是采用编译安装，安装好后不需要利用pip install方式安装opencv-python，这点非常重要！不然会覆盖先前的opencv安装。</p>
<p>下面提供一个具有python3.5+cuda+ffmpeg+opencv环境的dockerfile前半部分。该dockerfile学自<a href="https://hub.docker.com/r/valian/docker-python-opencv-ffmpeg/" target="_blank" rel="noopener">valian/docker-python-opencv-ffmpeg</a>，但做了一些修改，已确保能够跑通。</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">FROM </span><span class="string">tensorflow/</span><span class="string">tensorflow:1.</span>2.<span class="string">1-devel-</span><span class="string">gpu-py3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ENV </span><span class="string">PYTHON_VERSION </span>3.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install all dependencies for OpenCV 3.2</span></span><br><span class="line"><span class="string">RUN </span><span class="string">apt-get </span>-y <span class="string">update </span>&amp;&amp; <span class="string">apt-get </span>-y <span class="string">install </span><span class="string">python$</span><span class="string">PYTHON_VERSION-dev </span><span class="string">wget </span><span class="string">unzip </span>\</span><br><span class="line">    <span class="string">build-essential </span><span class="string">cmake </span><span class="string">git </span><span class="string">pkg-config </span><span class="string">libatlas-base-</span><span class="string">dev </span><span class="string">gfortran </span>\</span><br><span class="line">    <span class="string">libjasper-dev </span><span class="string">libgtk2.</span><span class="string">0-dev </span><span class="string">libavcodec-dev </span><span class="string">libavformat-dev </span>\</span><br><span class="line">    <span class="string">libswscale-dev </span><span class="string">libjpeg-dev </span><span class="string">libpng-dev </span><span class="string">libtiff-dev </span><span class="string">libjasper-dev </span><span class="string">libv4l-dev </span>\</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">bootstrap.</span><span class="string">pypa.</span><span class="string">io/</span><span class="built_in">get-pip.py</span> &amp;&amp; <span class="string">python3 </span><span class="built_in">get-pip.py</span> &amp;&amp; <span class="string">pip3 </span><span class="string">install </span><span class="string">numpy </span>&amp;&amp; <span class="string">rm </span><span class="built_in">get-pip.py</span> \</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Itseez/</span><span class="string">opencv/</span><span class="string">archive/</span>3.2.0.<span class="string">zip </span>-O /<span class="string">opencv3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">unzip </span>-q /<span class="string">opencv3.</span><span class="string">zip </span>-d / &amp;&amp; <span class="string">mv </span>/<span class="string">opencv-3.</span>2.0 /<span class="string">opencv </span>&amp;&amp; <span class="string">rm </span>/<span class="string">opencv3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">wget </span><span class="string">https:</span>//<span class="string">github.</span><span class="string">com/</span><span class="string">Itseez/</span><span class="string">opencv_contrib/</span><span class="string">archive/</span>3.2.0.<span class="string">zip </span>-O <span class="string">opencv_contrib3.</span><span class="string">zip </span>\</span><br><span class="line">    &amp;&amp; <span class="string">unzip </span>-q <span class="string">opencv_contrib3.</span><span class="string">zip </span>-d / &amp;&amp; <span class="string">mv </span>/<span class="string">opencv_contrib-3.</span>2.0 /<span class="string">opencv_contrib </span>&amp;&amp; <span class="string">rm </span><span class="string">opencv_contrib3.</span><span class="string">zip </span>\</span><br><span class="line"></span><br><span class="line">    <span class="comment"># prepare build</span></span><br><span class="line">    &amp;&amp; <span class="string">mkdir </span>/<span class="string">opencv/</span><span class="string">build </span>&amp;&amp; <span class="string">cd </span>/<span class="string">opencv/</span><span class="string">build </span>\</span><br><span class="line">    &amp;&amp; <span class="string">cmake </span>-D <span class="string">CMAKE_BUILD_TYPE=</span><span class="string">RELEASE </span>\</span><br><span class="line">      -D <span class="string">BUILD_PYTHON_SUPPORT=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">CMAKE_INSTALL_PREFIX=</span>/<span class="string">usr/</span><span class="string">local </span>\</span><br><span class="line">      -D <span class="string">OPENCV_EXTRA_MODULES_PATH=</span>/<span class="string">opencv_contrib/</span><span class="string">modules </span>\</span><br><span class="line">      -D <span class="string">BUILD_EXAMPLES=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">PYTHON_DEFAULT_EXECUTABLE=</span>/<span class="string">usr/</span><span class="string">bin/</span><span class="string">python3 </span>\</span><br><span class="line">      -D <span class="string">BUILD_opencv_python3=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">BUILD_opencv_python2=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">WITH_IPP=</span><span class="string">OFF </span>\</span><br><span class="line">      -D <span class="string">WITH_FFMPEG=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">WITH_V4L=</span><span class="string">ON </span>\</span><br><span class="line">      -D <span class="string">WITH_CUDA=</span><span class="string">ON </span>.. \</span><br><span class="line"></span><br><span class="line">    <span class="comment"># install</span></span><br><span class="line">    &amp;&amp; <span class="string">cd </span>/<span class="string">opencv/</span><span class="string">build </span>&amp;&amp; <span class="string">make </span>-j$(<span class="string">nproc)</span> &amp;&amp; <span class="string">make </span><span class="string">install </span>&amp;&amp; <span class="string">ldconfig </span>\</span><br><span class="line"></span><br><span class="line">    <span class="comment">#clean</span></span><br><span class="line">    &amp;&amp; <span class="string">apt-get </span>-y <span class="string">remove </span><span class="string">build-essential </span><span class="string">cmake </span><span class="string">git </span><span class="string">pkg-config </span><span class="string">libatlas-base-</span><span class="string">dev </span><span class="string">gfortran </span>\</span><br><span class="line">    <span class="string">libjasper-dev </span><span class="string">libgtk2.</span><span class="string">0-dev </span><span class="string">libavcodec-dev </span><span class="string">libavformat-dev </span>\</span><br><span class="line">    <span class="string">libswscale-dev </span><span class="string">libjpeg-dev </span><span class="string">libpng-dev </span><span class="string">libtiff-dev </span><span class="string">libjasper-dev </span><span class="string">libv4l-dev </span>\</span><br><span class="line">    &amp;&amp; <span class="string">apt-get </span><span class="string">clean </span>\</span><br><span class="line">    &amp;&amp; <span class="string">rm </span>-<span class="string">rf </span>/<span class="string">opencv </span>/<span class="string">opencv_contrib </span>/<span class="string">var/</span><span class="string">lib/</span><span class="string">apt/</span><span class="string">lists/</span>*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define other commands.</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://hub.docker.com/r/valian/docker-python-opencv-ffmpeg/" target="_blank" rel="noopener">valian/docker-python-opencv-ffmpeg</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/PCA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/PCA/" class="post-title-link" itemprop="url">PCA</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="PCA原理"><a href="#PCA原理" class="headerlink" title="PCA原理"></a>PCA原理</h1><p><a href="http://blog.codinglabs.org/articles/pca-tutorial.html" target="_blank" rel="noopener">PCA的数学原理</a> 这篇blog已经做非常好的说明。我在这里简单归纳下。</p>
<p>PCA是一种降维技术。它希望降维后样本的新生成的特征方差尽可能大，同时特征之间的相关性尽可能小，以此来尽可能的保留全部信息信息。</p>
<p>方差尽可能大的直观理解是数据越分散，差异性越大，体现的信息越多。</p>
<p>特征间相关性尽可能小的直观理解是避免相同信息在不同特征中重复出现。</p>
<h1 id="PCA进一步讨论"><a href="#PCA进一步讨论" class="headerlink" title="PCA进一步讨论"></a>PCA进一步讨论</h1><p>传统PCA是使用协方差度量相关性。因此所度量的也只是线性相关性。对于非线性相关，可以考虑使用KernelPCA，通过Kernel函数将非线性相关转为线性相关。</p>
<p>PCA假设数据各主特征是分布在正交方向上，如果在非正交方向上存在几个方差较大的方向，PCA的效果就大打折扣了。</p>
<h1 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><ol>
<li><p>PCA在使用过程中必须标准化么？为什么？<br>PCA追求特征之间的协方差为0.而计算协方差需要对特征去中心化。<br>[TBC]不去中心化会有什么坏处？是否需要归一化消除量纲？</p>
</li>
<li><p>为什么协方差可以度量相关性？并且是线性相关性？<br>根本上是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>从线性拟合和最小二乘的角度来看，拟合效果越好，相关系数绝对值越接近于1。从这个角度可以说相关系数刻画的是线性相关关系。（《概率论与数理统计》陈希孺 中科大出版社 第三章3.3节）</p>
</li>
<li><p>相关系数和修正余弦相似度区别？<br>根本上都是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>区别在于去中心化上。<br>相关系数考虑的是消除不同样本的基数差异。比如A可能对所有电影的打分都虚高，而B都会压低，相关系数可以消除这样的基数。<br>修正余弦相似度考虑的是消除不同特征之间的量纲差异。比如电影a的评分水平高于电影b，消除之后就不会令电影a对于相似性度量带来更大的影响。保持不同电影权重相同。<br>数据稀疏时选择修正余弦相似度更好。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/SNE与t-SNE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/SNE与t-SNE/" class="post-title-link" itemprop="url">SNE与t-SNE</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h1><p>本文是对 <a href="http://bindog.github.io/blog/2016/06/04/from-sne-to-tsne-to-largevis/" target="_blank" rel="noopener">从SNE到t-SNE再到LargeVis</a> 的阅读笔记。</p>
<h1 id="SNE"><a href="#SNE" class="headerlink" title="SNE"></a>SNE</h1><p>SNE原理是希望尽可能保存原数据的空间结构。</p>
<p>它利用条件概率来描述两个点之间的距离，距离越近，概率越大。之所以如此是因为直接使用欧式距离并不合适。[TBC]<br>\begin{split} p_{j|i} = \frac{\exp ((- \Vert x_i - x_j \Vert)^2)/2 \sigma^2}{\sum_{k \neq i} \exp ((- \Vert x_i - x_k \Vert)^2)/2 \sigma^2}\end{split}<br>其中 \(\sigma_i\) 是以 $x_i$ 为中心点的高斯分布的方差。设定 $p_{i|i} = 0$  。<br>降维后对应 \( y_i\) 点的条件分布相似定义，但是方差直接定为 \(\frac{1}{\sqrt{2}}\) ，有：<br>\begin{split} q_{j|i} = \frac{\exp ((- \Vert y_i - y_j \Vert)^2)}{\sum_{k \neq i} \exp ((- \Vert y_i - y_k \Vert)^2)}\end{split}</p>
<p>我们希望降维后点的条件概率分布应当尽可能与原数据条件概率一致。故而选择KL散度作为代价函数。<br>\begin{split} C =  \sum_i KL(P_i \Vert Q_i) = \sum_i \sum_j p_{j|i} \log \frac{p_{j|i}}{q_{j|i}}\end{split}<br>但是由于KL的不对称性，会出现一个问题：当p大q小时，代价较高，反之，则代价较低。因此代价函数更关注局部结构而忽视了全局结构。</p>
<h1 id="t-SNE"><a href="#t-SNE" class="headerlink" title="t-SNE"></a>t-SNE</h1><p>t-SNE解决了SNE的两个问题：对称性和拥挤问题。</p>
<p>先看对称性。（我并没有理解它是如何解决KL不对称带来的代价函数不对称性的[TBC]）<br>在SNE中，$p_{i|j}$ 和 $p_{j|i}$ 是不对等的，降维后的空间中也是如此。因此现在我们寻找一个满足对称性的联合概率分布：<br>\begin{split} q_{ij} = \frac{\exp ((- \Vert y_i - y_j \Vert)^2)}{\sum_{k \neq l} \exp ((- \Vert y_l - y_k \Vert)^2)}\end{split}</p>
<p>那么，在原空间是否也可以这样定义呢？如果这样，考虑一个离群点 $x_i$ ,那么对任意j， $p_{ij}$ 都会较小，从而不管降维后处于什么位置，代价都不会太大。<br>故而采用更简单直观的方式进行定义：<br>\begin{split} p_{ij} = \frac{p_{j|i} + p_{i|j}}{2n}\end{split}<br>代价函数为：<br>\begin{split} C =  \sum_i KL(P_i \Vert Q_i) = \sum_i \sum_j p_{ij} \log \frac{p_{ij}}{q_{ij}}\end{split}</p>
<p>在来看拥挤问题的解决。<br>在SNE时，虽然可以区分出不同类，但是类间边界并不明显，不同类依旧簇拥在一起，这就是拥挤问题。</p>
<p>通过对降维数据使用自由度为1的t分布描述条件概率，就可以解决这个问题。<br>\begin{split} q_{ij} = \frac{(1 + (\Vert y_i - y_j \Vert)^2)^{-1}}{\sum_{k \neq l} （1 + (\Vert y_k - y_l \Vert)^2)^{-1}}\end{split}<br>原数据空间依旧使用高斯分布。</p>
<p>我们通过以下两幅图来描述使用t分布的好处。</p>
<p>首先，t分布是长尾分布，对于边缘异常值不敏感，因此可以更好的捕捉全局特征。<br><img src="http://i4.buimg.com/567571/962ae3921b331a8f.png" alt></p>
<p>其次，高斯分布转t分布，可以使得邻近点间距离更近，距离大的点间距离更大，从而有效分离不同类。<br><img src="http://i1.piimg.com/567571/f26982cc085019a5.png" alt></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/dimensionality reduction/SVD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/dimensionality reduction/SVD/" class="post-title-link" itemprop="url">SVD</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="基变换"><a href="#基变换" class="headerlink" title="基变换"></a>基变换</h1><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/young_gy/article/details/50042885#推荐系统" target="_blank" rel="noopener">SVD分解及其应用</a><br><a href="http://www.cnblogs.com/lzllovesyl/p/5243370.html" target="_blank" rel="noopener">[机器学习笔记]奇异值分解SVD简介及其在推荐系统中的简单应用</a><br><a href="http://blog.csdn.net/zhongkejingwang/article/details/43053513" target="_blank" rel="noopener">奇异值分解(SVD)原理详解及推导</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">muzhen</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">369</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">114</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">muzhen</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  
  



  




  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  

  

  

  

  

  

  

  

  

  

</body>
</html>
