<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="the Home of MuZhen">
<meta property="og:url" content="http://www.muzhen.tk/page/13/index.html">
<meta property="og:site_name" content="the Home of MuZhen">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="the Home of MuZhen">






  <link rel="canonical" href="http://www.muzhen.tk/page/13/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>the Home of MuZhen</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">the Home of MuZhen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/machine learning/NN/convalutional networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/machine learning/NN/convalutional networks/" class="post-title-link" itemprop="url">convalutional networks</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 22:23:02" itemprop="dateCreated datePublished" datetime="2017-05-14T22:23:02+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script><br>此文为 <a href="http://www.deeplearningbook.org/contents/convnets.html" target="_blank" rel="noopener">CHAPTER 9 CONVALUTIONAL NETWORKS</a> 的简要翻译。</p>
<h1 id="9-1-The-Convolution-Operation"><a href="#9-1-The-Convolution-Operation" class="headerlink" title="9.1 The Convolution Operation"></a>9.1 The Convolution Operation</h1><p>一般意义上，卷积是一个 在与一个实值参数相关的两个函数上 的操作。为了引出卷积定义，我们先来看个例子。</p>
<p>假设我们通过激光传感器来跟踪太空船的位置。我们的激光传感器提供了一个简单的输出\(x(t)\)，表示时刻 \(t\) 太空船的位置。每个瞬间（假设可以连续不间断的）光传感器都会传给我们一个值。</p>
<p>现在假设我们的光传感器有了噪音。为了降低噪音影响，我们会想对一些观测去平均。当然，时间越近的观测越重要，因此我们会做一个加权平均。我们可以利用 \(\omega(a)\) 来进行加权， \(a\) 是观测的年龄。如果我们对每个时刻运用这样一个加权操作，我们获得了一个新的函数 \(s\) ，它提供了一个太空船位置的光滑估计：</p>
<p>\[s(t) = \int x(a) \omega(t-a) da \tag{9.1}\]</p>
<p>这个操作就叫做卷积。卷积操作使用星号表示：</p>
<p>\[s(t) = (x*\omega)(t) \tag{9.2}\]</p>
<p>在我们的例子中， \(\omega\) 需要是一个概率密度函数，不然的话输出将不再是一个加权平均。通常，卷积可以定义在任意函数上，它可以用于除了加权平均之外的其他目的。</p>
<p>（译者注：太空船应该是静止不动的，只有这样对不同时刻传回观测进行加权平均去定位才有意义）</p>
<p>在卷积网络术语中，卷积的第一个参数（在这个例子中是函数 \(x\)通常被成为input（特征维度），第二个参数（函数\(\omega\)）被成为kernel。输出被成为feature map。</p>
<p>每个瞬间都回传值是不大现实的，更为现实的是每隔一段时间（比如说1秒）回传一个值。因此，我们可以去定义一个离散卷积：</p>
<p>\[s(t) = (x*\omega)(t) = \sum x(a) \omega(t-a) \tag{9.3}\]</p>
<p>在机器学习中，input通常是一个多维数组，而kernel通常是需要通过算法去学习的参数。下图表明了一个卷积过程。</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/9012565-file_1494766766447_7474.png" alt></p>
<h1 id="9-2-Motivation"><a href="#9-2-Motivation" class="headerlink" title="9.2 Motivation"></a>9.2 Motivation</h1><p>卷积运用三个重要的idea去帮助改善机器学习系统：sparse interactions,parameter sharing,equivariant representations。</p>
<p>传统神经网络层对有独立参数组成的参数矩阵使用矩阵乘法，以此来描述输入单元和输出单元之间的交互关系。这意味着每个输出单元和每个输入单元都相关。但是卷积网络则是局部相关（sparse interactions，也叫做sparse connectivity或者sparse weights）。通过使用一个比input小的kernel可以实现sparse interactions。这意味着我们只需要存储更少的参数，既可以减少内存需求，也可以改善它的统计有效性。这也意味着可以简化输出的计算量。这些效率上的改善通常非常大。如果有m个inputs和n个outputs，矩阵乘法需要m×n个参数，并且每个样本的时间复杂度是O(m×n)。但是如果我们把每个输出对输入单元的连接限制为k，那么局部连接方法仅需要k×n个参数和O(k×n)的时间复杂度。在许多实践应用中，即使k比m小几个数量级，在机器学习任务中获得好的表现也是可能的。在深度网络中，深层的单元依旧会间接的被大部分input所影响。这就允许我们通过合适的局部连接去表述复杂的变量间关系，如下图：</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/219219-file_1494768700480_12a78.png" alt></p>
<p>参数共享指的是在模型的多个函数中使用相同的参数。作为parameter sharing的同义词，我们可以说一个网络有tied weights。这并不会减少时间复杂度，但是它可以进一步降低存储需求。</p>
<h1 id="9-3-Pooling"><a href="#9-3-Pooling" class="headerlink" title="9.3 Pooling"></a>9.3 Pooling</h1><p>一个卷积层一般包含三个步骤。第一个步骤是用（多个）卷积核进行卷积，第二个步骤是用利用非线性激活函数进行转换，这个步骤也就做detector stage。第三个步骤，我们使用池化函数进一步改善输出层。</p>
<p>池化使得representation对于input的小改变具有近似不变性。</p>
<h1 id="9-4-Convolution-and-Pooling-as-an-Infinitely-Strong-Prior"><a href="#9-4-Convolution-and-Pooling-as-an-Infinitely-Strong-Prior" class="headerlink" title="9.4 Convolution and Pooling as an Infinitely Strong Prior"></a>9.4 Convolution and Pooling as an Infinitely Strong Prior</h1><p>弱先验意味着参数取值的选择更多，比如说具有高方差的高斯分布。强先验意味着取值范围更小，比如低方差的高斯分布。</p>
<p>卷积可以理解为这样一种强先验假设：除了局部区域外，其他输入单元的对应权重都是0。</p>
<p>池化可以理解为这样一种假设：小改变不导致取值变化。</p>
<p>显然，当假设和事实不符时，会出现欠拟合。</p>
<h1 id="9-5-Variants-of-the-Basic-Convolution-Function"><a href="#9-5-Variants-of-the-Basic-Convolution-Function" class="headerlink" title="9.5 Variants of the Basic Convolution Function"></a>9.5 Variants of the Basic Convolution Function</h1>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/machine learning/NN/convolutional neural networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/machine learning/NN/convolutional neural networks/" class="post-title-link" itemprop="url">convolutional neural networks</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 18:28:21" itemprop="dateCreated datePublished" datetime="2017-05-14T18:28:21+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="局部感受野"><a href="#局部感受野" class="headerlink" title="局部感受野"></a>局部感受野</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/11586442-file_1494754594758_9c25.png" alt></p>
<p>一般认为人对外界的认知是从局部到全局的，而图像的空间联系也是局部的像素联系较为紧密，而距离较远的像素相关性则较弱。因而，每个神经元其实没有必要对全局图像进行感知，只需要对局部进行感知，然后在更高层将局部的信息综合起来就得到了全局的信息。  </p>
<p>通过局部感受野，参数可以有明显减少。</p>
<p>多通道情况下，局部感受野同时作用在不同通道上，结果相加后进行激活。</p>
<h1 id="权值共享"><a href="#权值共享" class="headerlink" title="权值共享"></a>权值共享</h1><p>不同局部的权值相同，换言之不需要针对不同局部训练不同参数。</p>
<p>这其中隐含的原理则是：图像的一部分的统计特性与其他部分是一样的。这也意味着我们在这一部分学习的特征也能用在另一部分上，所以对于这个图像上的所有位置，我们都能使用同样的学习特征。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://www.36dsj.com/archives/24006" target="_blank" rel="noopener">技术向：一文读懂卷积神经网络</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/machine learning/NN/activation function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/machine learning/NN/activation function/" class="post-title-link" itemprop="url">activation function</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 16:12:19" itemprop="dateCreated datePublished" datetime="2017-05-14T16:12:19+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#references</p>
<p><a href="https://livc.io/176" target="_blank" rel="noopener">常用激活函数的总结与比较</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/python/classmethod&staticmethod/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/python/classmethod&staticmethod/" class="post-title-link" itemprop="url">classmethod&staticmethod</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 14:00:36" itemprop="dateCreated datePublished" datetime="2017-05-14T14:00:36+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="instance-method"><a href="#instance-method" class="headerlink" title="instance method"></a>instance method</h1><p>class 中最常用的是实例方法：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls</span>(<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>.params)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.params = params</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        print(<span class="keyword">self</span>.params)</span><br></pre></td></tr></table></figure>
<h1 id="classmethod"><a href="#classmethod" class="headerlink" title="classmethod"></a>classmethod</h1><p>但如果我们需要一些和类直接交互而不是和实例交互的方法怎么办呢？可以将之放在class外面单独形成一个函数，但是这样不易于代码整洁和管理。此时，可以使用类方法：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls</span>(<span class="title">object</span>):</span></span><br><span class="line">    inst = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>.params)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.params = params</span><br><span class="line">        cls.inst = <span class="class"><span class="keyword">class</span>.<span class="title">inst</span> +1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        print(<span class="keyword">self</span>.params)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_inst</span><span class="params">(cls_obj)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> cls_obj.inst</span><br><span class="line"></span><br><span class="line">ik1 = cls()</span><br><span class="line">ik2 = cls()</span><br><span class="line">print(ik1.get_inst())</span><br><span class="line">print(cls.get_inst())</span><br></pre></td></tr></table></figure>
<p>注意，上面的两个输出都是2！</p>
<p>classmethod是需要传参数的，但是不是self。</p>
<h1 id="staticmethod"><a href="#staticmethod" class="headerlink" title="staticmethod"></a>staticmethod</h1><p>另一方面，有时需要一些和class有关但是有不需要实例和类参与的方法。这种情况应该是最为常见的！此时，可以使用staticmethod：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls</span>(<span class="title">object</span>):</span></span><br><span class="line">    inst = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>.params)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.params = params</span><br><span class="line">        cls.inst = <span class="class"><span class="keyword">class</span>.<span class="title">inst</span> +1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        print(<span class="keyword">self</span>.params)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_inst</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>staticmethod不需要传参数！</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://www.zhihu.com/question/20021164" target="_blank" rel="noopener">Python 中的 classmethod 和 staticmethod 有什么具体用途？</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/python/class & instance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/python/class & instance/" class="post-title-link" itemprop="url">class & instance</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 13:10:29" itemprop="dateCreated datePublished" datetime="2017-05-14T13:10:29+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="class-amp-instance"><a href="#class-amp-instance" class="headerlink" title="class &amp; instance"></a>class &amp; instance</h1><h2 id="class-amp-instance-1"><a href="#class-amp-instance-1" class="headerlink" title="class &amp; instance"></a>class &amp; instance</h2><p>类是一个模板，对它赋属性值调用以后就是具体的对象——实例。</p>
<p>通过在类中定义方法（函数），然后通过实例去直接调用方法，就可以直接操作对象内部数据。</p>
<h2 id="私有变量"><a href="#私有变量" class="headerlink" title="私有变量"></a>私有变量</h2><p>通过在属性的名称前加上两个下划线__，就变成了私有变量，外部无法访问。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="title">object</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, name, score)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.__name = name</span><br><span class="line">        <span class="keyword">self</span>.__score = score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_score</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        print(<span class="string">'%s: %s'</span> % (<span class="keyword">self</span>.__name, <span class="keyword">self</span>.__score))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; bart = Student(<span class="string">'Bart Simpson'</span>, <span class="number">98</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; bart.__name</span><br><span class="line">Traceback (most recent call last)<span class="symbol">:</span></span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line"><span class="symbol">AttributeError:</span> <span class="string">'Student'</span> object has no attribute <span class="string">'__name'</span></span><br></pre></td></tr></table></figure>
<p>这样就确保了外部代码不能随意修改对象内部的状态，这样通过访问限制的保护，代码更加健壮。</p>
<p>但是，以双下划线开头并结尾的是特殊变量，而非私有变量，是可以直接访问的。</p>
<p>有些时候，你会看到以单下划线开头的实例变量，这样的实例变量是可以访问的，但是，按照约定俗成的约定，当你看到这样的变量时，意思就是，“虽然我可以被访问，但是，请把我视为私有变量，不要随意访问”。</p>
<h2 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h2><p>写于类中，定义对象时会被自动调用。例如 <code>def __init__():</code></p>
<p>它们经常是两个下划线包围来命名的（比如 <code>__init__，__lt__</code>）</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014318650247930b1b21d7d3c64fe38c4b5a80d4469ad7000" target="_blank" rel="noopener">廖雪峰python</a></p>
<p><a href="http://www.cnblogs.com/styier/p/6111370.html" target="_blank" rel="noopener">Python中的魔法方法</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/14/machine learning/optimization/优化方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/14/machine learning/optimization/优化方法/" class="post-title-link" itemprop="url">优化方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-14 12:38:56" itemprop="dateCreated datePublished" datetime="2017-05-14T12:38:56+08:00">2017-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/optimization/" itemprop="url" rel="index"><span itemprop="name">optimization</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h1><h2 id="SGD-batch-GD-mini-batch-GD"><a href="#SGD-batch-GD-mini-batch-GD" class="headerlink" title="SGD/batch GD/mini-batch GD"></a>SGD/batch GD/mini-batch GD</h2><p>SGD: 每次对一个样本点计算梯度进行更新<br>batch GD： 每次都所有样本点计算梯度进行更新<br>mini-batch GD: 每次对一小批样本点计算梯度进行更新</p>
<h2 id="momentum"><a href="#momentum" class="headerlink" title="momentum"></a>momentum</h2><p>\begin{split} v_t &amp;&amp;= \gamma v_{t-1} + \eta \cdot \nabla_\theta J(\theta)  \newline<br>\theta &amp;&amp;= \theta - v_t \end{split}</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-5/39961276-file_1493979742645_3f6b.png" alt><br><img src="http://omdhuynsr.bkt.clouddn.com/17-5-5/49809367-file_1493979972098_105f0.png" alt>  </p>
<p>峡谷区域： 某些方向比另一些方向上陡峭的多，常见于局部极值点<br>在这种情况下，会出现一个方向更新缓慢（如图中x轴），一个方向更新剧烈震荡（如y轴）。<br>使用momentum后，x轴方向可以叠加历史效应使得变化便快，而y轴方向则由于前后梯度方向相反，会发生抑制，不再剧烈震荡。可以参考右图理解。</p>
<h2 id="NAG"><a href="#NAG" class="headerlink" title="NAG"></a>NAG</h2><p>NAG是对momentum的改进。<br>\begin{split} v_t &amp;&amp;= \gamma v_{t-1} + \eta \cdot \nabla J(\theta - \gamma v_{t-1})  \newline<br>\theta &amp;&amp;= \theta - v_t \end{split}<br>可以看到，差异在于当前梯度的计算上。<br>正常情况下就是算当前参数位置的梯度。但是，NAG算的却是近似未来位置的梯度。因为我们知道，参数的更新有一部分就是根据momentum作出的。这里提前将参数位置提前做了momentum这一部分变化，并计算对应梯度。<br>为什么这样更好呢？</p>
<p>NAG用到了近似二阶导信息，详见 <a href="http://www.360doc.com/content/16/1010/08/36492363_597225745.shtml" target="_blank" rel="noopener">比Momentum更快：揭开Nesterov Accelerated Gradient的真面目</a></p>
<h2 id="Adagrad"><a href="#Adagrad" class="headerlink" title="Adagrad"></a>Adagrad</h2><p>Adagrad可以对每个参数自适应不同的学习速率，对稀疏特征，得到大的学习更系，对非稀疏特征，得到较小的学习更新，因此该算法适合处理稀疏特征数据。  </p>
<p>其参数更新方程如下：<br>\begin{split} &amp;&amp;g_{t,i} = \nabla_{\theta_i} (\theta_i) \newline<br>&amp;&amp;\theta_{t+1,i} = \theta_{t,i} - \frac{\eta}{\sqrt{G_{t,ii} + \epsilon}} \cdot g_{t,i}\newline<br>&amp;&amp;G_t \text{为一个对角矩阵，对角元素 } e_{ii} \text{ 为过去到当前第 i 个参数 } \theta_i \text{ 的梯度平方和} \newline<br>&amp;&amp;\epsilon \text{是一个平滑参数，为了使分母不为0} \newline<br>&amp;&amp;\text{如果分母不开根号，算法性能会很糟糕} \end{split}</p>
<p>需要注意，前期很可能先起到一个梯度放大的作用！而非梯度从一开始就不断的衰减！  </p>
<p>Adagrad 存在学习速率衰减过快的问题。因此，深度学习中可能会造成训练提前结束。</p>
<h2 id="RMSProp"><a href="#RMSProp" class="headerlink" title="RMSProp"></a>RMSProp</h2><p>\begin{split} &amp;&amp;g = \nabla J(\theta) \newline<br>&amp;&amp;r = \rho r + (1- \rho) \cdot (g \odot g) \newline<br>&amp;&amp; \theta = \theta - \frac{\eta}{\epsilon + \sqrt{r}} \odot g \newline<br>&amp;&amp; \text{注： 此处为向量写法， } \odot \text{为点乘} \end{split}</p>
<p>RMSProp在Adagrad基础上引入了动量思想,并由于分母不再是以前所有时刻的梯度平方和，减小了衰减速度。</p>
<p>同样的，也可以进一步引入NAG方法，只需要在梯度计算上做改进，同时引入动量。</p>
<p>\begin{split} &amp;&amp;\theta’ = \theta - \alpha v \newline<br>&amp;&amp;g = \nabla J(\theta’) \newline<br>&amp;&amp;r = \rho r + (1- \rho) \cdot (g \odot g) \newline<br>&amp;&amp;v = \alpha v + \frac{\eta}{\epsilon + \sqrt{r}} \odot g \newline<br>&amp;&amp; \theta = \theta - v \newline<br>&amp;&amp; \text{注： 此处为向量写法， } \odot \text{为点乘} \end{split}</p>
<h2 id="Adadelta"><a href="#Adadelta" class="headerlink" title="Adadelta"></a>Adadelta</h2><p>Adagrad存在三个问题：</p>
<ol>
<li>其学习率单调递减，训练后期学习率非常小</li>
<li>其需要手工设置一个全局的初始学习率</li>
<li>更新参数时，左右两边单位不同一</li>
</ol>
<p>针对第一个问题，RMSprop可以解决。</p>
<p>针对第三个问题，我们来讨论一下。</p>
<p>对于一般的sgd方法：<br>\begin{split} unit(\Delta \theta)  \propto unit(\nabla J(\theta)) \propto  \frac{\partial{J}}{\partial{\theta}} \propto \frac{1}{unit(\theta)} \end{split}</p>
<p>类似的，在Adagrad中：<br>\begin{split} unit(\Delta \theta)  \propto 1 \end{split}</p>
<p>在牛顿法中：<br>\begin{split} unit(\Delta \theta)  \propto H^{-1} \nabla J(\theta) \propto  \frac{\partial{J}/ \partial{\theta}}{\partial^2{J}/ \partial{\theta^2}} \propto unit(\theta) \end{split}</p>
<p>可以看到，牛顿法的更新单位是一致的。</p>
<p>因此，可以仿牛顿法进行构造：</p>
<p>\begin{split} g_t &amp;&amp;= \nabla J(\theta_t) \newline<br>\Delta \theta_t &amp;&amp;= - \frac{\sqrt{E[\Delta \theta^2]_{t-1}}}{\sqrt{E[g^2]_t}+\epsilon} g_t \newline<br>E[g^2]_t &amp;&amp;= \rho E[g^2]_{t-1} + (1 - \rho) g_t^2 \newline<br>E[\Delta \theta^2]_t &amp;&amp;= \rho E[\Delta \theta^2]_{t-1} + (1 - \rho) \Delta \theta^2 \newline<br>\theta_t &amp;&amp;= \theta_{t-1} + \Delta \theta_t<br>\end{split}</p>
<p>如此一来，第三个问题就得到了解决，并且顺带解决了第二个问题。<br>为何如此仿造是合理的，参<a href="http://www.cnblogs.com/neopenx/p/4768388.html" target="_blank" rel="noopener">自适应学习率调整：AdaDelta</a>  </p>
<p>总结一下：<br>Adagrad进行了学习率衰减，RMSProp优化了Adagrad衰减过快的问题，Adadelta进一步利用了近似二阶导数信息优化了RMSProp。</p>
<h2 id="Adam"><a href="#Adam" class="headerlink" title="Adam"></a>Adam</h2><p>\begin{split} g &amp;&amp;= \nabla J(\theta) \newline<br>s &amp;&amp;= \rho_1 s + (1 - \rho_1) g \newline<br>r &amp;&amp;= \rho_2 r + (1 - \rho_2) g^2 \newline<br>\hat{s} &amp;&amp;= \frac{s}{1 - \rho_1} \newline<br>\hat{r} &amp;&amp;= \frac{r}{1 - \rho_2} \newline<br>\Delta \theta &amp;&amp;= - \eta \frac{\hat{s}}{\sqrt{\hat{r}}+\epsilon} \newline<br>\theta &amp;&amp;= \theta + \Delta \theta \end{split}</p>
<h1 id="二阶方法"><a href="#二阶方法" class="headerlink" title="二阶方法"></a>二阶方法</h1><h2 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h2><p>\begin{split} &amp;&amp;f(x) \approx f(x_k) + f’(x_k)(x-x_k) + \frac{1}{2} f’’(x_k)(x-x_k)^2 = \varphi (x)\newline<br> \text{在x处取极值时满足： } &amp;&amp;\varphi’(x) = 0 \newline<br> \text{推出： } &amp;&amp;f’(x_k) + f’’(x_k)(x-x_k) = 0 \newline<br> &amp;&amp;x = x_k - \frac{f’(x_k)}{f’’(x_k)} \newline<br> &amp;&amp; x_{k+1} = x_k - \frac{f’(x_k)}{f’’(x_k)}, k =0,1,… \end{split}</p>
<p>多维情况下：<br>\begin{split} &amp;&amp;f(x) \approx f(x_k) + \nabla f(x_k)(x-x_k) + \frac{1}{2}(x-x_k)^T \cdot \nabla^2 f(x_k) \cdot (x-x_k) = \varphi (x)\newline<br> \text{在x处取极值时满足： } &amp;&amp;\nabla \varphi(x) = 0 \newline<br> \text{推出： } &amp;&amp;g_k + H_k \cdot (x-x_k) = 0 \newline<br> &amp;&amp;x = x_k - H_k^{-1} \cdot g_k \newline<br> &amp;&amp; x_{k+1} = x_k -  H_k^{-1} \cdot g_k, k =0,1,… \newline<br> &amp;&amp; g = \nabla, H = \nabla^2 \end{split}</p>
<p>牛顿法利用二阶泰勒展开自动选择更新方向。<br>当目标是二次函数时，由于二次泰勒展开函数与原目标函数不是近似而是完全相同的二次式，Hessian矩阵退化成一个常数矩阵，从任一初始点出发，只需要一步迭代即可达到最小值点。对于非二次函数，若函数的二次性态较强，或迭代点以进入极小值的领域，则其收敛速度也是很快的。<br>但对于非二次型目标函数，有时会使函数值上升，不能保证函数值稳定下降，甚至可能发散。因为在极大值处也可以一阶导数为0。<br>以及可能会陷入局部极小值中无法跳出。</p>
<p>牛顿法存在连个主要缺点：</p>
<ol>
<li>对目标函数有较严格的要求。函数必须具有连续的一、二阶偏导数，Hessian矩阵必须正定;</li>
<li>计算复杂。计算量、存储量均很大，且均以维数N的平方比增加。</li>
</ol>
<h2 id="阻尼牛顿法"><a href="#阻尼牛顿法" class="headerlink" title="阻尼牛顿法"></a>阻尼牛顿法</h2><p>阻尼牛顿法在牛顿法的基础上引入了步长：<br>\begin{split} &amp;&amp;d_k = - H_k^{-1} \cdot g_k \newline<br>&amp;&amp;\lambda_k = \arg \min_{\lambda \in R} f(x_k + \lambda d_k) \newline<br>&amp;&amp;x_{k+1} = x_k + \lambda_k d_k \newline\end{split}</p>
<p>前面说到 $f(x_{k+1}) &gt; f(x_k))$ 的情况可能发生，因此，我们可以引入步长因子，进行一维搜索，使得更新后得到的 $f(x_{k+1})$ 必然不会变大，从而一直沿着正确的方向前进。</p>
<p>一维搜索可以使用进退法寻找到单谷所在区间，然后使用黄金分割法、评分法等在区间内找寻最小值。（理想情况下是单谷，但即使不是单谷，也并不会影响更新方向）</p>
<h2 id="拟牛顿法"><a href="#拟牛顿法" class="headerlink" title="拟牛顿法"></a>拟牛顿法</h2><p>这个方法的基本思想是：不用二阶偏导数而构造出可以近似Hessian矩阵（或其逆）的正定对称矩阵，在“拟牛顿”的条件下优化目标函数。<br>为明确起见，用B表示对H的近似，用D表示对H的逆的近似。</p>
<p>对H作出近似，需要满足拟牛顿条件，下面推导之。</p>
<p>\begin{split} &amp;&amp;f(x) \approx f(x_{k+1}) +  \nabla f(x_{k+1}) \cdot (x - x_{k+1}) + \frac{1}{2} \cdot (x - x_{k+1})^T \cdot \nabla^2 f(x_{k+1}) \cdot (x - x_{k+1}) \newline<br>\text{两边同时对x求导: } &amp;&amp;\nabla f(x) \approx \nabla f(x_{k+1}) + H_{k+1} \cdot (x - x_{k+1}) \newline<br>\text{令} x = x_k \text{整理得: }  &amp;&amp;g_{k+1} - g_k \approx H_{k+1} \cdot (x_{k+1} - x_k) \newline<br>\text{引入记号: } &amp;&amp;s_k = x_{k+1} - x_k,y_k = g_{k+1} - g_k \newline<br>\text{有: } &amp;&amp;y_k \approx H_{k+1} \cdot s_k \newline<br>\text{或: } &amp;&amp;s_k \approx H^{-1}_{k+1} \cdot y_k \end{split}</p>
<p>这就是拟牛顿条件，他对迭代过程中的 $H_{k+1}$ 作出了约束。因此，作为近似的 $B_{k+1}$ 和 $D_{k+1}$ 可以将以下公式作为指导。<br>\begin{split} &amp;&amp;y_k = B_{k+1} \cdot s_k \newline<br>&amp;&amp;s_k = D_{k+1} \cdot y_k \end{split}</p>
<p>根据H的构造函数不同，可以分为不同的拟牛顿法。下面介绍。</p>
<h2 id="DFP法"><a href="#DFP法" class="headerlink" title="DFP法"></a>DFP法</h2><p>该算法的核心是：通过迭代的方法，对H的逆做近似：<br>\begin{split} D_{k+1} = D_k + \Delta D_k, k = 0,1,2,……, D_0 = I \end{split}</p>
<p>显然，关键在于 $\Delta D_k$ 的构造，很容易猜想其可能会和 $s_k,y_k,D_k$ 发生关联。这里，我们采用待定法，即首先将其待定为某种形式，然后结合拟牛顿条件来推导。</p>
<p>可以将其待定为：<br>\begin{split} \Delta D_k = \alpha \mathbf{uu}^T +\beta \mathbf{vv}^T \end{split}<br>从形式上看，至少保证了其对称性。</p>
<p>将之代入拟牛顿条件：<br>\begin{split} \mathbf{s}_k &amp;&amp;= D_k \mathbf{y}_k + \alpha \mathbf{uu}^T \mathbf{y}_k + \beta \mathbf{vv}^T \mathbf{y}_k \newline<br>&amp;&amp;= D_k \mathbf{y}_k + (\alpha \mathbf{u}^T \mathbf{y}_k) \mathbf{u} + (\beta \mathbf{v}^T \mathbf{y}_k) \mathbf{v} \newline<br>\text{不妨令: } &amp;&amp;\alpha \mathbf{u}^T \mathbf{y}_k = 1, \beta \mathbf{v}^T \mathbf{y}_k = -1 \newline<br>\text{得: } &amp;&amp;\alpha = \frac{1}{\mathbf{u}^T \mathbf{y}_k}, \beta = - \frac{1}{\mathbf{v}^T \mathbf{y}_k} \newline \newline<br>&amp;&amp;\mathbf{u} - \mathbf{v} = \mathbf{s}_k - D_k \mathbf{y}_k \newline<br>\text{为使上式成立，不妨直接令: } &amp;&amp;\mathbf{u} = \mathbf{s}_k, \mathbf{v} = D_k \mathbf{y}_k \newline<br>\text{代入有: } &amp;&amp;\alpha = \frac{1}{\mathbf{s}_k^T \mathbf{y}_k}, \beta = - \frac{1}{\mathbf{y}_k^T D_k \mathbf{Y}_k} \text{ 其中第二个等式用到了对称性} D_k^T = D_k \newline<br>&amp;&amp;\Delta D_k = \frac{\mathbf{s}_k\mathbf{s}_k^T}{\mathbf{s}_k^T \mathbf{y}_k} - \frac{D_k \mathbf{y}_k \mathbf{y}_k^T D_k}{\mathbf{y}_k^T D_k \mathbf{y}_k} \end{split}</p>
<p>由此可以利用近似的H运用牛顿法。</p>
<h2 id="BFGS法"><a href="#BFGS法" class="headerlink" title="BFGS法"></a>BFGS法</h2><p>BFGS则是通过迭代的方法，直接对H做近似。其形式和思路和DFP基本相同。最后再去求近似H的逆运用牛顿法即可。</p>
<p>另外，除了前面提到的一维搜索来计算步长之外，还有其他搜索方法。Powell证明了带Wolfe搜索的BFGS算法的全局收敛性和超线性收敛性。</p>
<p>具体见 <a href="http://blog.csdn.net/itplus/article/details/21897443" target="_blank" rel="noopener">牛顿法与拟牛顿法学习笔记（四）BFGS 算法</a></p>
<h2 id="L-BFGS法"><a href="#L-BFGS法" class="headerlink" title="L-BFGS法"></a>L-BFGS法</h2><p>考虑一个N阶矩阵，当N=10万时，用double（8字节）来存储该矩阵将需要74.5GB内存。其内存开销非常大！</p>
<p>因此，L-BFGS 对 BFGS 进行了近似，可以减小内存开销。其基本思想是： 不再存储完整的矩阵 $D_k$ ,而是存储计算过程中的向量序列 ${s_i},{y_i}$ ，需要矩阵 $D_k$ 时，利用向量序列的计算来代替。而且，向量序列不是所有的都存，而是固定存最新的m个。每次计算 $D_k$ 时，只利用最新的m个来进行近似计算。</p>
<p>具体见<a href="http://blog.csdn.net/itplus/article/details/21897715" target="_blank" rel="noopener">牛顿法与拟牛顿法学习笔记（五）L-BFGS 算法</a></p>
<h1 id="其他策略"><a href="#其他策略" class="headerlink" title="其他策略"></a>其他策略</h1><h2 id="Shuffling-and-Curriculum-Learning"><a href="#Shuffling-and-Curriculum-Learning" class="headerlink" title="Shuffling and Curriculum Learning"></a>Shuffling and Curriculum Learning</h2><p>为了使得学习过程更加无偏，可以打乱训练样本。  </p>
<p>另一方面，可以将训练集按照某个有意义的顺序排列一次来提高模型性能和SGD收敛性，如何建立有意义的排列成为Curriculum Learning。</p>
<h2 id="Batch-normalization"><a href="#Batch-normalization" class="headerlink" title="Batch normalization"></a>Batch normalization</h2><p>\begin{split} \mu &amp;&amp;= \frac{1}{m} \sum_{i=1}^m x_i \newline<br>\sigma &amp;&amp;= \frac{1}{m} \sum_{i=1}^m (x_i - \mu)^2 \newline<br>\hat{x_i} &amp;&amp;= \frac{x_i - \mu}{\sqrt{\sigma^2 + \epsilon}} \newline<br>y_i &amp;&amp;= \gamma \hat{x_i} + \beta \equiv BN_{\gamma,\beta}(x_i) \end{split}</p>
<p>BN方法对需要层的输出做z标准化，然后再训练参数进行还原，通过这种方式来保存原输出数据的分布特征。  </p>
<p>在原paper中作者建议BN放在激活函数之前，但也有实验表明放在激活值后更好。<br>[TBC]为什么经过这样的变化之后会更好？并解决梯度消失问题？Batch Normalization: Accelerating Deep Network Training by  Reducing Internal Covariate Shift</p>
<h2 id="LRN"><a href="#LRN" class="headerlink" title="LRN"></a>LRN</h2><p>[TBC]</p>
<h2 id="Early-stopping"><a href="#Early-stopping" class="headerlink" title="Early stopping"></a>Early stopping</h2><p>当验证集效果不再显著提升时，提前结束训练。</p>
<h2 id="Gradient-noise"><a href="#Gradient-noise" class="headerlink" title="Gradient noise"></a>Gradient noise</h2><p>对于计算出的梯度增加一个高斯分布的随机误差，即：<br>\begin{split} g_{t,i} &amp;&amp;= g_{t,i} + N(0,\sigma_t^2) \newline<br>\sigma_t^2 &amp;&amp;= \frac{\eta}{(1+t)^\gamma} \end{split}</p>
<p>对梯度增加误差可以增加鲁棒性，即使初始参数值选择不好。<br>并且适合对深层次网络进行你个训练。原因在于增加随机噪声会有更多的可能性跳过局部极值点并去寻找一个更好的局部极值点，这种可能性在深层次网络中更常见。</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p><a href="http://sebastianruder.com/optimizing-gradient-descent/" target="_blank" rel="noopener">An overview of gradient descent optimization algorithms</a><br><a href="http://blog.csdn.net/heyongluoyao8/article/details/52478715" target="_blank" rel="noopener">梯度下降优化算法综述</a><br><a href="https://zhuanlan.zhihu.com/p/21486826" target="_blank" rel="noopener">路遥知马力——Momentum</a><br><a href="http://www.360doc.com/content/16/1010/08/36492363_597225745.shtml" target="_blank" rel="noopener">比Momentum更快：揭开Nesterov Accelerated Gradient的真面目</a><br><a href="http://blog.csdn.net/u014595019/article/details/52989301" target="_blank" rel="noopener">深度学习笔记：优化方法总结(BGD,SGD,Momentum,AdaGrad,RMSProp,Adam)</a><br><a href="http://climin.readthedocs.io/en/latest/rmsprop.html" target="_blank" rel="noopener">rmsprop</a><br><a href="http://www.cnblogs.com/neopenx/p/4768388.html" target="_blank" rel="noopener">自适应学习率调整：AdaDelta</a><br><a href="http://blog.csdn.net/luo123n/article/details/48239963" target="_blank" rel="noopener">各种优化方法总结比较（sgd/momentum/Nesterov/adagrad/adadelta）</a><br><a href="http://blog.csdn.net/elaine_bao/article/details/50890491" target="_blank" rel="noopener">解读Batch Normalization</a><br><a href="http://blog.csdn.net/itplus/article/details/21896453" target="_blank" rel="noopener">牛顿法与拟牛顿法学习笔记（一）牛顿法</a><br><a href="http://dataunion.org/20714.html" target="_blank" rel="noopener"><strong><em>寻找最优参数解：最速下降法，牛顿下降法，阻尼牛顿法，拟牛顿法DFP/BFGS</em></strong></a><br><a href="https://wenku.baidu.com/view/22138d22bcd126fff7050b99.html" target="_blank" rel="noopener">一维搜索</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/10/development/environment/markdown下latex用法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/10/development/environment/markdown下latex用法/" class="post-title-link" itemprop="url">markdown下latex用法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-10 15:38:12" itemprop="dateCreated datePublished" datetime="2017-05-10T15:38:12+08:00">2017-05-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/environment/" itemprop="url" rel="index"><span itemprop="name">environment</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="使用环境"><a href="#使用环境" class="headerlink" title="使用环境"></a>使用环境</h1><p>我使用的是vscode，直接在markdown中安装markdown+math插件，md文档开头需要添加MathJax引擎,否则一些相关语句markdown+math并不支持：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>行内公式 $…$</p>
</li>
<li><p>行间公式,需要另起一行方可<br>$$…$$</p>
</li>
<li><p>公式换行、对齐</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\<span class="keyword">begin</span>&#123;<span class="keyword">split</span>&#125; ... &amp;&amp;= ...\<span class="keyword">newline</span></span><br><span class="line">&amp;&amp;= ... \<span class="keyword">newline</span></span><br><span class="line">&amp;&amp;= ... \<span class="keyword">end</span>&#123;<span class="keyword">split</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>公式换行编号</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">\<span class="name">begin</span><span class="string">&#123;eqnarray*&#125;</span></span> ... &amp;&amp;= ... <span class="tag">\<span class="name">tag</span><span class="string">&#123;1&#125;</span></span> <span class="tag">\<span class="name">newline</span></span></span><br><span class="line">&amp;&amp;= ... <span class="tag">\<span class="name">tag</span><span class="string">&#123;2&#125;</span></span> <span class="tag">\<span class="name">newline</span></span></span><br><span class="line">&amp;&amp;= ... <span class="tag">\<span class="name">tag</span><span class="string">&#123;3&#125;</span></span><span class="tag">\<span class="name">end</span><span class="string">&#123;eqnarray*&#125;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="向量符号加粗"><a href="#向量符号加粗" class="headerlink" title="向量符号加粗"></a>向量符号加粗</h1><p>对于一般字母<br><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">\<span class="name">mathbf</span><span class="string">&#123;u&#125;</span></span></span><br></pre></td></tr></table></figure></p>
<p>对于希腊字母<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">\b</span>oldsymbol&#123;<span class="symbol">\s</span>igma&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="特殊符号使用"><a href="#特殊符号使用" class="headerlink" title="特殊符号使用"></a>特殊符号使用</h1><p><a href="http://blog.163.com/goldman2000@126/blog/static/167296895201301822448724/" target="_blank" rel="noopener">LaTex常用特殊符号参考</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/06/pansee/book review/《地下室手记》/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/06/pansee/book review/《地下室手记》/" class="post-title-link" itemprop="url">《地下室手记》</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-06 10:31:51" itemprop="dateCreated datePublished" datetime="2017-05-06T10:31:51+08:00">2017-05-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/book-review/" itemprop="url" rel="index"><span itemprop="name">book review</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一-地下室"><a href="#一-地下室" class="headerlink" title="一 地下室"></a>一 地下室</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><ol>
<li><p>不看病与恶意的关系如何理解。</p>
</li>
<li><p>不愿意受贿，一杯糖茶就可以消气，请求忏悔，更像是在无奈之下的牢骚和耍脾气。</p>
</li>
<li><p>何以活过四十岁的不是傻瓜就是坏蛋。这个世界太坏以至于无法让聪明人和好人活下去么？</p>
</li>
<li><p>何以不舍得离开彼得堡？<br><strong>我离开不离开，还不完全一样吗。</strong><br>是否是指不管哪里都没有区别，故而不愿离开。或许彼得堡作为政治财富中心不愿离开还有一份舍不得？</p>
</li>
<li><p>正派人最爱谈自己？为何？地下室人认为自己也是正派人么？</p>
</li>
</ol>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><ol>
<li><p><strong>意识到的东西太多了——也是一种病，一种真正的，彻头彻尾的病  /  甚至任何意识都是一种病态</strong><br>何以故?</p>
</li>
<li><p><strong>而是去做这样一些不登大雅之堂的事呢？</strong><br>指的是什么事？</p>
</li>
<li><p><strong>陷入我的泥淖以致完全不能自拔。</strong><br>泥淖指的又是什么？</p>
</li>
<li><p>视卑劣为乐趣，是无法改变之后的自我安慰与放弃么？</p>
</li>
<li><p><strong>根据自然规律，我永远是个无辜的罪人。<br>我之所以有罪，首先因为我比我周围的人聪明。我甚至对此感到惭愧。<br>最后，我之所以有罪，是因为我身上尽管不乏宽宏大量，但是这宽宏大量实在无益而且有害。</strong>  </p>
</li>
</ol>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>思虑周全也至于反省复仇与正义的合理性，从而无论做什么事都放不开手脚，难以下决定。而思虑不全的人会轻易的按照本能和习惯行事，路上所遇到的墙对于他们而言就是真理的教谕。<br>于是乎，联系到前面对于美与崇高的论述，地下室人在怀疑美与崇高的合理性？</p>
<p><strong>主啊上帝，要是我由于某种原因根本就不喜欢这些自然规律和二二得四，这些自然规律和算术跟我又有什么关系呢？</strong><br>质疑神对于人世的安排？强调人自主权的回归？</p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p><strong>而是一种心怀恶毒的呻吟 / 患者的乐趣就表现在呻吟中；如果他在这呻吟中感不到乐趣——他也就不会呻吟了。</strong></p>
<p><strong>只要某人愿意，你们的牙齿就会停止疼痛</strong><br>某人指的是谁？</p>
<p><strong>由于这类痛彻心肺的侮辱，由于这类不知来自何方的嘲弄，你们终于开始感到某种乐趣，有时这种乐趣还会发展成一种高度的快感。</strong></p>
<p><strong>脱离了根基和人民的方式</strong><br>或者是在讽刺对于上帝是和个人本身脱节的？</p>
<p><strong>这是因为我自己都不尊重我自己。难道一个洞察一切的人能够多多少少地尊重他自己吗？</strong><br>这是在否定个体存在的意义么？</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>意识的发达使得无法找到初因，或者说行动的坚实的根基，也就只好无所事事，空捶墙壁了。</p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>无所事事如果是因为懒尚且可以接受，悲哀的就是连懒都被消解了，找不到立足的根基。</p>
<p><strong>在我们这个否定一切的时代</strong><br>指的是什么呢？</p>
<h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><p>将行为归结为利益这是一种规避、空范、修正主义的说法。完全没有揭露行为本身的内部驱动。因此，在分析讨论问题的时候也应当避免这样空范的说法。</p>
<p>旧的时代，以残暴为正义。新的时代，明知残暴而继续残暴。《老无所依》的残暴又是怎样的一种残暴？</p>
<p>本节内容是否有对于普遍正义的否定？至少有对于人类可以遵从的普遍规律的否定。并不存在某一普遍规律，可以教化每个人的行为。</p>
<p>逻辑、理性、意志与随心所欲的愿望之间的冲突。</p>
<p>如果存在普遍规律以及普适的行为准则，那么人类就丧失了选择权，如果提线木偶一般生活，那么在此种情况下就会滋生无聊。<br>或许随心所欲便是这样一种对抗，在逻辑与真理框架之外找寻选择权，哪怕是错的选择权。无聊只能通过作恶犯错来排遣么？<br>爱或许是更好的解决途径。可以考虑弗洛姆《爱的艺术》对于爱的来源的分析。</p>
<h2 id="8"><a href="#8" class="headerlink" title="8"></a>8</h2><p><strong>因为无论如何给我们保留了最主要和最宝贵的东西，即我们的人格和我们的个性。</strong></p>
<p><strong>人的最好定义————这就是：忘恩负义的两脚动物</strong><br>忘谁的恩，负谁的义？</p>
<p><strong>他之所以硬要留住自己的虚妄的幻想，留住自己的极端卑鄙的愚蠢，惟一的目的就是为了向自己证明（倒像这样做非常必要似的），人毕竟是人，而不是钢琴上的琴键，可以任由自然规律随意弹奏，但是弹奏来弹奏去却可能弹出这样的危险，即除了按日程表办事以外，什么事也不敢想不敢做。</strong></p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p><strong>人是动物，主要是有创造性的动物……也就是所，要不断给自己开辟道路。不管这道路通向何方。但是他之所以有时候想脱离正道走到斜路上去，正是因为他注定要去开路……但是主要的问题不在于它通到哪儿，而在于这路总是要往前走</strong></p>
<p><strong>他之所以这样喜欢破坏和制造混乱……说不定，该不是因为他下意识地害怕达到目的，害怕建成他所建造的大厦吧？</strong></p>
<p><strong>二二得四已经不是生活，而是死亡的开始了</strong></p>
<p><strong>他喜欢达到目的的过程，但是真要达到了目的，他又不十分喜欢了，这当然非常可笑，总之，人的天性就是滑稽可笑的;在这一切当中显然也就包含了某种滑稽的闹剧。</strong></p>
<p><strong>有时候一个人会非常喜欢苦难，喜欢极了，而且这是事实。</strong><br>如何理解《约伯记》中上帝施加的苦难？</p>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><p>人性的不满足</p>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p>地下室所指的是什么？</p>
<p><strong>这人越是正派，这样的东西就越多</strong></p>
<p><strong>做自我鉴定，不仅不方便，而且简直不可能……尽管你非常想说真话，可是关于自己没有一个人能够做到说真话</strong></p>
<h1 id="二-雨雪霏霏"><a href="#二-雨雪霏霏" class="headerlink" title="二 雨雪霏霏"></a>二 雨雪霏霏</h1><ul>
<li><p>军官、让路、绒毛大衣</p>
</li>
<li><p>送别会</p>
</li>
<li><p>妓女角色或者说女性，淫荡女性角色在陀氏作品中地位</p>
</li>
<li><p>军官贵族角色</p>
</li>
<li><p>宗教角色的隐去相较于其他书目</p>
</li>
</ul>
<p>撇开复仇的正义性不论，既然想要复仇为什么不随心所欲的去复仇呢？<br>因为有更深一层的考虑，复仇这一行为或许恰恰是不能随心所欲，被所谓理性所操控的体现。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/05/machine learning/machine learning/《ESL第3章 回归的线性方法》/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/05/machine learning/machine learning/《ESL第3章 回归的线性方法》/" class="post-title-link" itemprop="url">《ESL第3章 回归的线性方法》</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-05 09:56:25" itemprop="dateCreated datePublished" datetime="2017-05-05T09:56:25+08:00">2017-05-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine learning</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="第3章-回归的线性方法"><a href="#第3章-回归的线性方法" class="headerlink" title="第3章 回归的线性方法"></a>第3章 回归的线性方法</h1><h2 id="3-2-线性回归模型和最小二乘方"><a href="#3-2-线性回归模型和最小二乘方" class="headerlink" title="3.2 线性回归模型和最小二乘方"></a>3.2 线性回归模型和最小二乘方</h2><p>线性回归模型是指<strong>参数线性</strong>。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/04/machine learning/machine learning/《ESL第2章 有指导学习概述》/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/04/machine learning/machine learning/《ESL第2章 有指导学习概述》/" class="post-title-link" itemprop="url">《ESL第2章 有指导学习概述》</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-04 18:22:42" itemprop="dateCreated datePublished" datetime="2017-05-04T18:22:42+08:00">2017-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine learning</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="第2章-有指导学习概述"><a href="#第2章-有指导学习概述" class="headerlink" title="第2章 有指导学习概述"></a>第2章 有指导学习概述</h1><p>线性判别边界：在不同类别服从区分明显的不同分布时合适<br>非线性判别边界：在不同类别所服从分布相对紧密时适用</p>
<p>最小二乘方：假定可以用一个全局线性函数很好地近似<br>k-最近邻：假定可以用一个局部常量函数很好地近似</p>
<p>knn有效参数个数：表面上是1个，即邻居个数k，其实是N/k个（其中N为样本量，k为邻居个数，如果邻域不重叠，需要为每个邻域配一个参数（均值））。  </p>
<p>真实数据往往是由类似高斯混合分布这样的形式所产生。</p>
<p>回归函数就是求给定x下的条件期望。（个人以为推广到分类问题中也没有问题。。）<br>\begin{split} f(x) = E(Y|X = x)\end{split}</p>
<p>最近邻则是<br>\begin{split} \hat{f(x)} = Ave(y_i|x_i \in N_k(x))\end{split}<br>发生了两次近似：</p>
<ol>
<li>用均值来近似期望</li>
<li>在点上取条件放宽为在“靠近”目标点的某区域上取条件</li>
</ol>
<p>可以证明：<br>\begin{split} \hat{f(x)} \rightarrow E(Y|X = x) \text{ when } N,k \rightarrow \infty,N/k \rightarrow 0,\end{split}</p>
<p>那么最近邻的缺点在哪里呢？</p>
<ol>
<li>在样本容量不够大的情况下，收敛效果并不会很好</li>
<li>随着样本维度提高，邻域度量规模也增大。虽然收敛性依然成立，但是收敛速度会随着维数增加而降低。</li>
</ol>
<p>因此我们可以考虑某种更结构化的模型，通常可以得到更稳定的估值。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/04/machine learning/dimensionality reduction/reduction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/04/machine learning/dimensionality reduction/reduction/" class="post-title-link" itemprop="url">reduction</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-04 17:57:11" itemprop="dateCreated datePublished" datetime="2017-05-04T17:57:11+08:00">2017-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="一些进行降维的方法"><a href="#一些进行降维的方法" class="headerlink" title="一些进行降维的方法"></a>一些进行降维的方法</h1><ul>
<li>use clustering to extract feature</li>
<li>t-sne</li>
<li>pca</li>
<li>autoencoder</li>
<li>any others to reduction?</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/04/machine learning/ensemble/gcforest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/04/machine learning/ensemble/gcforest/" class="post-title-link" itemprop="url">gcforest</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-04 17:14:25" itemprop="dateCreated datePublished" datetime="2017-05-04T17:14:25+08:00">2017-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/ensemble/" itemprop="url" rel="index"><span itemprop="name">ensemble</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="gcForest"><a href="#gcForest" class="headerlink" title="gcForest"></a>gcForest</h1><p>gcForest包含两大模块：级联森林和多粒度扫描。<br><img src="http://i4.buimg.com/567571/19c73bb7503caa72.png" alt></p>
<h1 id="多粒度扫描（Multi-Grained-Scanning）"><a href="#多粒度扫描（Multi-Grained-Scanning）" class="headerlink" title="多粒度扫描（Multi-Grained Scanning）"></a>多粒度扫描（Multi-Grained Scanning）</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-4/47305608-file_1493888234733_e64c.png" alt><br>对特征进行有规则滑动采样，拿采样后数据分别建立标准随机森林和完全随机森林，将输出概率进行拼接构成新的特征向量。</p>
<h1 id="级联森林（Cascade-Forest）"><a href="#级联森林（Cascade-Forest）" class="headerlink" title="级联森林（Cascade Forest）"></a>级联森林（Cascade Forest）</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-4/88211704-file_1493888546752_1059d.png" alt><br>利用多个随机森林训练的输出作为新特征和原特征合并，多次级联操作，最终多个森林输出结果取均值，得到最后的类别概率分布。<br>每次级联后验证输出效果是否有提升，没有提升则终止级联，输出结果。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://www.qcloud.com/community/article/536731001491381531" target="_blank" rel="noopener">小菜鸟对周志华大神gcForest的理解</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/05/03/machine learning/statistics/方差、偏差、噪声/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/05/03/machine learning/statistics/方差、偏差、噪声/" class="post-title-link" itemprop="url">方差、偏差、噪声</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-05-03 17:39:42" itemprop="dateCreated datePublished" datetime="2017-05-03T17:39:42+08:00">2017-05-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/statistics/" itemprop="url" rel="index"><span itemprop="name">statistics</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="误差-随机误差和系统误差之间的关系"><a href="#误差-随机误差和系统误差之间的关系" class="headerlink" title="误差,随机误差和系统误差之间的关系"></a><a href="http://www.gfjl.org/thread-175264-1-1.html" target="_blank" rel="noopener">误差,随机误差和系统误差之间的关系</a></h1><p>误差的来源可以分为系统误差（又称可定误差）、随机误差（又称未定误差）和毛误差（又称过失误差）</p>
<p>系统误差(System error)分为固定误差与比例误差，原因可能有仪器本身误差(instrumental errors)、采用方法的误差(method errors)、个人误差(personal errors)、环境误差（Environmental error）。理论上系统误差可以通过一定的手段(如:校正)来消除。举例而言，天平的两臂应是等长的，可实际上是不可能完全相等的；天平配置的相同质量的砝码应是一样的，可实际上它们不可能达到一样。</p>
<p>随机误差(Random error)，无法控制的变因，会使得测量值产生随机分布的误差。它服从统计学上所谓的“正态分布”或称“高斯分布”，它是不可消除的，在这个意义上，测量对象的真值是永远不可知的，只能通过多次测量获得的均值尽量逼近。系统误差以相同的方式影响所有测量值，将它们推向同一个方向；随机误差，则随着不同次的测量而变化，有时候向上或向下。</p>
<p>毛误差(Gross error)，毛误差主要是由于测量者的疏忽犯下不应有的错误造成的。例如读数错误、记录错误、测量时发生未察觉的异常情况等等，这种误差是可以避免的(如:舍弃有关数据重新测量)。</p>
<ul>
<li>系统误差中的个人误差(personal errors)与毛误差(Gross error)的差别<br>个人误差又称人员误差，是由于测定人员的分辨力、反应速度的差异和固有习惯引起的误差。这类误差往往因人而异，因而可以采取让不同人员进行分析，以平均值报告分析结果的方法予以限制。<br>毛误差主要是由于测量者的疏忽所造成的。</li>
</ul>
<p>残差是原值与拟合值的差――与预测有关，残差大小可以衡量预测的准确性。残差越大表示预测越不准确。残差与数据本身的分布特性，回归方程的选择有关。</p>
<h1 id="总平方和（SST）、回归平方和（SSR）与残差平方和（SSE）"><a href="#总平方和（SST）、回归平方和（SSR）与残差平方和（SSE）" class="headerlink" title="总平方和（SST）、回归平方和（SSR）与残差平方和（SSE）"></a>总平方和（SST）、回归平方和（SSR）与残差平方和（SSE）</h1><p>\begin{split} &amp;&amp;SST = \sum_{i=1}^n(y_i-\overline{y})^2 \newline<br>&amp;&amp;SSE = \sum_{i=1}^n(y_i - \hat{y_i})^2 \newline<br>&amp;&amp;SSR = \sum_{i=1}^n(\hat{y_i}-\overline{y})^2 \end{split}</p>
<p>SST是真值与均值的差平方和：衡量的是被解释变量(Y)波动的程度或不确定性的程度<br>SSR是估值与均值的差平方和：衡量的是被解释变量(Y)不确定性程度中能被解释变量(X)解释的部分<br>SSE是真值与估值的差平方和：衡量的是被解释变量(Y)不确定性程度中不能被解释变量(X)解释的部分<br>SSE很容易理解，SSR可以理解为SST-SSE的余项。</p>
<h1 id="偏差和方差"><a href="#偏差和方差" class="headerlink" title="偏差和方差"></a>偏差和方差</h1><p>偏差刻画的是真值与预测值之间的偏离程度。  </p>
<p>方差刻画的是模型在不同的样本集上performance的波动情况。</p>
<p>详参周志华《机器学习》(P45):</p>
<p>\begin{split} E_D[(f(x;D)-y_D)^2] &amp;&amp;= E_D[(f(x;D) - \overline{f}(x))^2] + (\overline{f}(x) - y)^2 +E_D[(y_D - y)^2] \newline<br>&amp;&amp;= var(x) + bias^2(x) + \epsilon^2 \newline<br>&amp;&amp; \overline{f}(x) = E_D[(f(x;D))] \newline<br>&amp;&amp; y_D \text{为x在数据集D中的标记; } y \text{为x真实标记; } f(x;D) \text{为算法在D上预测标记 }\end{split}</p>
<p>范化误差可以分解为偏差，方差与噪声之和。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/19/machine learning/optimization/拉格朗日乘子法和KKT条件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/19/machine learning/optimization/拉格朗日乘子法和KKT条件/" class="post-title-link" itemprop="url">拉格朗日乘子法和KKT条件</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-19 18:51:01" itemprop="dateCreated datePublished" datetime="2017-04-19T18:51:01+08:00">2017-04-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/optimization/" itemprop="url" rel="index"><span itemprop="name">optimization</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="最优化问题"><a href="#最优化问题" class="headerlink" title="最优化问题"></a>最优化问题</h1><ol>
<li><p>无约束优化问题<br>可以通过Fermat定理，即令导数为0求得</p>
</li>
<li><p>等式约束优化问题<br>利用拉格朗日乘子法求得</p>
</li>
<li><p>不等式约束优化问题<br>一般是转化为小于等于的约束形式，然后利用KKT条件求得</p>
</li>
</ol>
<h1 id="拉格朗日乘子法"><a href="#拉格朗日乘子法" class="headerlink" title="拉格朗日乘子法"></a>拉格朗日乘子法</h1><p>必须明确的是，通过拉格朗日乘子法所求出的点不一定是极值点！在拉格朗日乘子法可用情况下，它是必要不充分条件。</p>
<p>可以通过图形来进一步理解拉格朗日乘子法。如下图，在$g(x,y)=c$约束下，$f(x,y)$极值在切点处取得。其实，换成不等式约束同样可以相似理解。只需把下图中约束条件绘制成绿线及以上部分。此处不严谨，不需深究。<br><img src="http://p1.bpimg.com/567571/1b0bfa20bbb4f7b0.png" alt></p>
<h1 id="KKT条件"><a href="#KKT条件" class="headerlink" title="KKT条件"></a>KKT条件</h1><ol>
<li><p>$g_i(x^<em>) \leq 0;h_j(x^</em>) = 0$</p>
</li>
<li><p>$\nabla f(x^<em>) + \sum\limits_{i=1}^p \mu_i^</em> \nabla g_i(x^<em>) + \sum\limits_{j=1}^q \lambda_j^</em> \nabla h_j(x^*) = 0$</p>
</li>
<li><p>$\mu_i^<em> \geq 0;\mu_i g(x^</em>) = 0$</p>
</li>
</ol>
<p>事实上，就是指需要满足约束条件，以及梯度消失（为0）。</p>
<h1 id="对偶"><a href="#对偶" class="headerlink" title="对偶"></a>对偶</h1><p>我目前发现最清晰的讲解<a href="http://blog.pluskid.org/?p=702" target="_blank" rel="noopener">支持向量机：Duality</a>*</p>
<p>设：<br>$$L(x,\lambda,\mu) = f(x) + \sum_{i=1}^p \mu_i g_i(x) + \sum_{j=1}^q \lambda_j h_j(x)$$</p>
<p>令：<br>$$z(x) = \max_{\mu \geq 0,\lambda} L(x,\lambda,\mu)$$<br>因为限制 $\mu \geq 0$,所以 $\mu_i g_i(x) \leq 0$,故而最大值 $z(x) = f(x)$ 。  </p>
<p>这样一来，原问题转化为 $\min\limits_{x} z(x)$ ，即是primal problem：<br>$$\min_{x} \max_{\mu \geq 0,\lambda} L(x,\lambda,\mu)$$<br>记其解为$p^*$</p>
<p>另一方面，令：<br>$$g(\lambda,\mu) = \min_x L(x,\lambda,\mu)$$</p>
<p>则有：<br>$$g(\lambda,\mu) = \min_x L(x,\lambda,\mu) \leq L(x^<em>,\lambda,\mu) \leq f(x^</em>) = p^*$$</p>
<p>因此，$g$为下界，则最大下界为：<br>$$\max_{\mu \geq 0,\lambda} g(\lambda,\mu)$$<br>这就是dual problem，记其最优值为$d^<em>$,则有：<br>$$d^</em> \leq p^*$$<br>这个性质叫做weak duality。  </p>
<p>如果满足：<br>$$d^<em> = p^</em>$$<br>这个性质叫做strong duality。</p>
<p>任何满足strong duality的问题都满足KKT条件，换句话说，KKT仅仅是必要条件。但当原问题是凸优化问题时，KKT可以升级为充要条件。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://jacoxu.com/%E6%9C%80%E4%BC%98%E5%8C%96%E7%90%86%E8%AE%BA%E4%B8%8Ekkt%E6%9D%A1%E4%BB%B6/" target="_blank" rel="noopener">最优化理论与KKT条件</a>  </p>
<p><a href="http://blog.csdn.net/johnnyconstantine/article/details/46335763" target="_blank" rel="noopener">KKT条件介绍</a></p>
<p><strong><em><a href="http://blog.pluskid.org/?p=702" target="_blank" rel="noopener">支持向量机：Duality</a></em></strong></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/16/machine learning/imbalance data/learning from imbalance data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/16/machine learning/imbalance data/learning from imbalance data/" class="post-title-link" itemprop="url">learning from imbalance data</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-16 10:41:51" itemprop="dateCreated datePublished" datetime="2017-04-16T10:41:51+08:00">2017-04-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/imbalance-data/" itemprop="url" rel="index"><span itemprop="name">imbalance data</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://zhpmatrix.github.io/2017/02/20/learning-from-imbalanced-data/" target="_blank" rel="noopener">Learning from Imbalanced Data</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/13/machine learning/dimensionality reduction/PCA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/13/machine learning/dimensionality reduction/PCA/" class="post-title-link" itemprop="url">PCA</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-13 12:34:18" itemprop="dateCreated datePublished" datetime="2017-04-13T12:34:18+08:00">2017-04-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/dimensionality-reduction/" itemprop="url" rel="index"><span itemprop="name">dimensionality reduction</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="PCA原理"><a href="#PCA原理" class="headerlink" title="PCA原理"></a>PCA原理</h1><p><a href="http://blog.codinglabs.org/articles/pca-tutorial.html" target="_blank" rel="noopener">PCA的数学原理</a> 这篇blog已经做非常好的说明。我在这里简单归纳下。</p>
<p>PCA是一种降维技术。它希望降维后样本的新生成的特征方差尽可能大，同时特征之间的相关性尽可能小，以此来尽可能的保留全部信息信息。</p>
<p>方差尽可能大的直观理解是数据越分散，差异性越大，体现的信息越多。</p>
<p>特征间相关性尽可能小的直观理解是避免相同信息在不同特征中重复出现。</p>
<h1 id="PCA进一步讨论"><a href="#PCA进一步讨论" class="headerlink" title="PCA进一步讨论"></a>PCA进一步讨论</h1><p>传统PCA是使用协方差度量相关性。因此所度量的也只是线性相关性。对于非线性相关，可以考虑使用KernelPCA，通过Kernel函数将非线性相关转为线性相关。</p>
<p>PCA假设数据各主特征是分布在正交方向上，如果在非正交方向上存在几个方差较大的方向，PCA的效果就大打折扣了。</p>
<h1 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><ol>
<li><p>PCA在使用过程中必须标准化么？为什么？<br>PCA追求特征之间的协方差为0.而计算协方差需要对特征去中心化。<br>[TBC]不去中心化会有什么坏处？是否需要归一化消除量纲？</p>
</li>
<li><p>为什么协方差可以度量相关性？并且是线性相关性？<br>根本上是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>从线性拟合和最小二乘的角度来看，拟合效果越好，相关系数绝对值越接近于1。从这个角度可以说相关系数刻画的是线性相关关系。（《概率论与数理统计》陈希孺 中科大出版社 第三章3.3节）</p>
</li>
<li><p>相关系数和修正余弦相似度区别？<br>根本上都是使用内积进行相似性度量，消除量纲后就是单位向量间的夹角余弦值。<br>区别在于去中心化上。<br>相关系数考虑的是消除不同样本的基数差异。比如A可能对所有电影的打分都虚高，而B都会压低，相关系数可以消除这样的基数。<br>修正余弦相似度考虑的是消除不同特征之间的量纲差异。比如电影a的评分水平高于电影b，消除之后就不会令电影a对于相似性度量带来更大的影响。保持不同电影权重相同。<br>数据稀疏时选择修正余弦相似度更好。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/12/python/discuss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/12/python/discuss/" class="post-title-link" itemprop="url">discuss</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-12 16:30:57" itemprop="dateCreated datePublished" datetime="2017-04-12T16:30:57+08:00">2017-04-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="the-differences-between-package-and-module"><a href="#the-differences-between-package-and-module" class="headerlink" title="the differences between package and module"></a>the differences between package and module</h1><ul>
<li>the <strong>name</strong> of module from where?</li>
</ul>
<h1 id="the-effects-of-init-py"><a href="#the-effects-of-init-py" class="headerlink" title="the effects of init.py"></a>the effects of <strong>init</strong>.py</h1><h1 id="the-process-of-import"><a href="#the-process-of-import" class="headerlink" title="the process of import"></a>the process of import</h1><h1 id="the-meanings-of-and"><a href="#the-meanings-of-and" class="headerlink" title="the meanings of _ and __"></a>the meanings of _ and __</h1><h1 id="if-name-‘main‘"><a href="#if-name-‘main‘" class="headerlink" title="if name == ‘main‘"></a>if <strong>name</strong> == ‘<strong>main</strong>‘</h1><h1 id="class中def如果是做有关self修改，可以不需要return。而self自己就会变化么？"><a href="#class中def如果是做有关self修改，可以不需要return。而self自己就会变化么？" class="headerlink" title="class中def如果是做有关self修改，可以不需要return。而self自己就会变化么？"></a>class中def如果是做有关self修改，可以不需要return。而self自己就会变化么？</h1>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/11/machine learning/NN/rnn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/11/machine learning/NN/rnn/" class="post-title-link" itemprop="url">rnn</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-11 20:09:22" itemprop="dateCreated datePublished" datetime="2017-04-11T20:09:22+08:00">2017-04-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<h1 id="lstm"><a href="#lstm" class="headerlink" title="lstm"></a>lstm</h1><p>此处先说明tensorflow中以下代码的输出<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outputs,final_state = tf<span class="selector-class">.nn</span><span class="selector-class">.dynamic_rnn</span>(lstm_cell,x_in,initial_state=init_state,time_major=False)</span><br></pre></td></tr></table></figure></p>
<p>outputs储存每个时刻的输出，也就是下面的分线输出（它也同时被复制为当时时刻的外部输出）,它的形状是[batch_size,n_steps,n_hidden_units]（如果一开始的输入形式为[n_steps,batch_size,n_inputs]，则time_major=True，output形状为[n_steps,batch_size,n_hidden_units]）</p>
<p>final_state仅仅只记录最后时刻的主线状态和分线状态，默认以元组形式保存，主线状态在前。</p>
<p>因此，分线state和outputs最后一个时刻的记录是相同的，至少在基础lstm上。</p>
<p>lstm一开始需要定义的初始状态应该就是指一开始的主线和分线state。</p>
<p><img src="http://i2.muimg.com/567571/e28747d6a50b8fad.png" alt></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/mydear_11000/article/details/52414342" target="_blank" rel="noopener">解读tensorflow之rnn</a><br><a href="http://www.jianshu.com/p/9dc9f41f0b29" target="_blank" rel="noopener">[译] 理解 LSTM 网络</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/04/02/machine learning/NLP/WMD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/02/machine learning/NLP/WMD/" class="post-title-link" itemprop="url">WMD</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-02 22:17:37" itemprop="dateCreated datePublished" datetime="2017-04-02T22:17:37+08:00">2017-04-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="文章出处"><a href="#文章出处" class="headerlink" title="文章出处"></a>文章出处</h1><p>本文为<a href="https://github.com/RaRe-Technologies/gensim/blob/develop/docs/notebooks/WMD_tutorial.ipynb" target="_blank" rel="noopener">WMD_tutorial</a>的翻译。</p>
<h1 id="使用W2V和WMD发现文档的相似性"><a href="#使用W2V和WMD发现文档的相似性" class="headerlink" title="使用W2V和WMD发现文档的相似性"></a>使用W2V和WMD发现文档的相似性</h1><p>WMD（Word Mover’s Distance）是机器学习中一个有前途的新工具，它允许我们提交查询并返回最相似的文档。例如，在博客<a href="http://tech.opentable.com/2015/08/11/navigating-themes-in-restaurant-reviews-with-word-movers-distance/" target="_blank" rel="noopener">OpenTable</a>中，使用了WMD分析了餐厅评论。通过使用这种方法，他们能够从评论中挖掘出不同的方面。这本教程的第二部分，我们展示了如何使用gensim的WmdSimilarity去做类似与opentable所做的事情。在第一部分，我们说明了如何使用wmdistance去计算两个文档的WMD距离。如果你的目的是想使用WmdSimilarity，第一部分可以选读，但它是有意义的。</p>
<p>不管怎样，首先，我们浏览下关于wmd是什么的基础知识。</p>
<h1 id="WMD基础"><a href="#WMD基础" class="headerlink" title="WMD基础"></a>WMD基础</h1><p>wmd允许我们用一种有意义的方式去评估两个文档之间的距离，即使他们之间没有共同词汇。他使用w2v进行词向量嵌入。它的表现优于很多最先进的k近邻分类方法。</p>
<p>wmd被下面两个非常相似的句子所阐明（图例来源于<a href="http://vene.ro/blog/word-movers-distance-in-python.html" target="_blank" rel="noopener">Vlad Niculae’s blog</a>）。两个句子之间没有共同词汇，但是通过匹配相关词，wmd能够精确度量两个句子之间的相似性。这个方法也使用了文档的词袋表征（简单的说，文档的词频），在下面的图中被标记为d。该方法的直观理解是我们发现文档之间最小的”traveling distance”，换句话说将文档1的分布移向文档2的最有效方式。</p>
<p><img src="http://i1.piimg.com/567571/651dd1b6e0d46b4b.png" alt></p>
<p>这个方法已经在文章<a href="http://jmlr.org/proceedings/papers/v37/kusnerb15.pdf" target="_blank" rel="noopener">“From Word Embeddings To Document Distances” by Matt Kusner et al.</a>中被介绍。它被”Earth Mover’s Distance”激发灵感，并且利用了 “transportation problem”的一个解法。</p>
<p>在本教程中，我们将学习如何使用gensim的wmd函数。它由进行距离计算的wmdistance方法和基于相似查询的corpus计算的WmdSimilarity类构成。</p>
<blockquote>
<p>注意：<br>  如果你使用这个软件，请留意引用[1]，[2]和[3]。</p>
</blockquote>
<h1 id="运行notebook"><a href="#运行notebook" class="headerlink" title="运行notebook"></a>运行notebook</h1><p>你可以下载这个<a href="http://ipython.org/notebook.html" target="_blank" rel="noopener">iPython Notebook</a>，并在你自己电脑上运行它，如果你已经安装了gensim，pyemd，nltk，并下载了必要的数据。</p>
<p>这个notebook被运行在i7-4770cpu 3.40GHz (8 cores) 和 32 GB memory的ubuntu机器上。在这台机器上运行整个notebook需要话费3分钟。</p>
<h1 id="第一部分：计算词移距离（Word-Mover’s-Distance）"><a href="#第一部分：计算词移距离（Word-Mover’s-Distance）" class="headerlink" title="第一部分：计算词移距离（Word Mover’s Distance）"></a>第一部分：计算词移距离（Word Mover’s Distance）</h1><p>为了使用wmd，我们首先需要一些词嵌入。你需要在一些corpus上训练一个w2v模型（<a href="https://rare-technologies.com/word2vec-tutorial/" target="_blank" rel="noopener">教程</a>），但是我们将通过下载一些预训练的w2v嵌入模型来开始。下载 <a href="https://code.google.com/archive/p/word2vec/" target="_blank" rel="noopener">GoogleNews-vectors-negative300.bin.gz</a>（警告：1.5GB，第二部分并不需要这些文件）。训练你自己的嵌入模型是有益处的，但为了简化本教程，我们将首先使用预训练的嵌入。</p>
<p>让我们拿一些句子来计算它们之间的相似度。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> <span class="built_in">time</span> import <span class="built_in">time</span></span><br><span class="line">start_nb = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize logging.</span></span><br><span class="line">import logging</span><br><span class="line">logging.basicConfig(<span class="built_in">format</span>=<span class="string">'%(asctime)s : %(levelname)s : %(message)s'</span>)</span><br><span class="line"></span><br><span class="line">sentence_obama = <span class="string">'Obama speaks to the media in Illinois'</span></span><br><span class="line">sentence_president = <span class="string">'The president greets the press in Chicago'</span></span><br><span class="line">sentence_obama = sentence_obama.<span class="built_in">lower</span>().<span class="built_in">split</span>()</span><br><span class="line">sentence_president = sentence_president.<span class="built_in">lower</span>().<span class="built_in">split</span>()</span><br></pre></td></tr></table></figure>
<p>这些句子有很相似的内容，因此wmd应该低。在我们计算wmd之前，我们想要移除停用词（”the”, “to”, etc.），因为它们对句子信息并没有很多贡献。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Import and download stopwords from NLTK.</span></span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords</span><br><span class="line"><span class="keyword">from</span> nltk <span class="keyword">import</span> download</span><br><span class="line">download(<span class="string">'stopwords'</span>)  <span class="comment"># Download stopwords list.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove stopwords.</span></span><br><span class="line">stop_words = stopwords.words(<span class="string">'english'</span>)</span><br><span class="line">sentence_obama = [w <span class="keyword">for</span> w <span class="keyword">in</span> sentence_obama <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> stop_words]</span><br><span class="line">sentence_president = [w <span class="keyword">for</span> w <span class="keyword">in</span> sentence_president <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> stop_words]</span><br></pre></td></tr></table></figure>
<p>现在，正如先前提到的，我们将使用一些下载的预训练嵌入。我们加载这些进入gensim的w2v模型类中。注意我们这里选择的嵌入需要很多内存。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> = <span class="built_in">time</span>()</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gensim.models <span class="keyword">import</span> KeyedVectors</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'/data/w2v_googlenews/GoogleNews-vectors-negative300.bin.gz'</span>):</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">"SKIP: You need to download the google news model"</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">model</span> = KeyedVectors.load_word2vec_format(<span class="string">'/data/w2v_googlenews/GoogleNews-vectors-negative300.bin.gz'</span>, <span class="built_in">binary</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Cell took %.2f seconds to run.'</span> % (<span class="built_in">time</span>() - <span class="keyword">start</span>))</span><br></pre></td></tr></table></figure>
<p>因此让我们使用wmdistance方法计算wmd。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">distance</span> = model.wmdistance(sentence_obama, sentence_president)</span><br><span class="line"><span class="built_in">print</span> '<span class="built_in">distance</span> = %.4f' % <span class="built_in">distance</span></span><br></pre></td></tr></table></figure>
<p>让我们对完全不相关的句子做相同的操作。注意距离变大了。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sentence_orange = <span class="string">'Oranges are my favorite fruit'</span></span><br><span class="line">sentence_orange = sentence_orange.<span class="built_in">lower</span>().<span class="built_in">split</span>()</span><br><span class="line">sentence_orange = [w <span class="keyword">for</span> w <span class="keyword">in</span> sentence_orange <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> stop_words]</span><br><span class="line"></span><br><span class="line">distance = model.wmdistance(sentence_obama, sentence_orange)</span><br><span class="line">print <span class="string">'distance = %.4f'</span> % distance</span><br></pre></td></tr></table></figure>
<h1 id="正则化w2v向量"><a href="#正则化w2v向量" class="headerlink" title="正则化w2v向量"></a>正则化w2v向量</h1><p>当使用wmdistance方法时，首先正则化w2v向量是有益的，因此它们都有相同的长度。为了实现正则化，简单的调用model.init_sims(replace=True)，gensim会为你实现它。</p>
<p>通常，使用<a href="https://en.wikipedia.org/wiki/Cosine_similarity" target="_blank" rel="noopener">余弦距离</a>度量两个w2v向量之间的距离。余弦距离度量的是两个向量之间的夹角。另一方面，wmd使用欧式距离。两个向量之间的欧式距离可能会因为她们之间的长度区别而变得很大，但是因为它们之间的夹角很小因此余弦距离很小。我们可以通过正则化向量减轻这个问题。</p>
<p>注意正则化向量会花费一些时间，特别是你有一个大的词汇表 和/或 大的向量集。</p>
<p>用法在下面的例子中被阐明。碰巧我们下载的向量已经被正则化了。因此，在这个例子中我们不会作出什么差别。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Normalizing word2vec vectors.</span></span><br><span class="line"><span class="keyword">start</span> = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">model.init_sims(<span class="keyword">replace</span>=<span class="literal">True</span>)  <span class="comment"># Normalizes the vectors in the word2vec class.</span></span><br><span class="line"></span><br><span class="line">distance = model.wmdistance(sentence_obama, sentence_president)  <span class="comment"># Compute WMD as normal.</span></span><br><span class="line"></span><br><span class="line">print <span class="string">'Cell took %.2f seconds to run.'</span> %(<span class="built_in">time</span>() - <span class="keyword">start</span>)</span><br></pre></td></tr></table></figure>
<h1 id="第二部分：使用WmdSimilarity进行相似度查询"><a href="#第二部分：使用WmdSimilarity进行相似度查询" class="headerlink" title="第二部分：使用WmdSimilarity进行相似度查询"></a>第二部分：使用WmdSimilarity进行相似度查询</h1><p>你可以通过WmdSimilarity类，使用wmd得到一个查询对应的最相似的文档。它的交互过程相似于在gensim教程<a href="https://radimrehurek.com/gensim/tut3.html" target="_blank" rel="noopener">Similarity Queries</a>中所描绘的。</p>
<blockquote>
<p>重要注意<br> wmd是一种距离度量。WmdSimilarity中的相似度是简单的负距离。注意不要混淆距离和相似度。两个相似文档将有一个高相似得分和一个小距离;两个差异文档将有低的相似得分和一个大距离。</p>
</blockquote>
<h2 id="Yelp-data"><a href="#Yelp-data" class="headerlink" title="Yelp data"></a>Yelp data</h2><p>让我们使用一些真实世界数据来尝试下相似度查询。为此我们使用<a href="https://www.yelp.com/dataset_challenge" target="_blank" rel="noopener">yelp评论</a>。特别的，我们将使用单一餐馆也就是<a href="https://en.yelp.be/biz/mon-ami-gabi-las-vegas-2" target="_blank" rel="noopener">Mon Ami Gabi</a>的评论。</p>
<p>为了得到yelp数据，你需要使用名字和邮箱进行注册。数据是775MB。</p>
<p>这一次，我们将用我们自己的数据去训练W2V嵌入。一个餐馆的数据并不足以合适的训练出w2v，因此我们使用了6个餐馆的数据进行训练。但是仅仅在他们中的一个进行相似度查询试验。除了上面提到的Mon Ami Gabi，我们还将使用：</p>
<ul>
<li>Earl of Sandwich.</li>
<li>Wicked Spoon.</li>
<li>Serendipity 3.</li>
<li>Bacchanal Buffet.</li>
<li>The Buffet.</li>
</ul>
<p>我们选择的餐馆是yelp数据集中那些具有最高数量评论的餐馆。顺带一提，它们都在Las Vegas Boulevard中。我们用于训练w2v的corpus具有18957条文档（评论），而用于WmdSimilarity的corpus具有4137条文档。</p>
<p>下面代码是一个yelp评论的json文件被按行读取，文本被抽取，分词，停用词和标点符号被移除。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pre-processing a document.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">from</span> nltk import word_tokenize</span><br><span class="line">download(<span class="string">'punkt'</span>)  <span class="comment"># Download data for tokenizer.</span></span><br><span class="line"></span><br><span class="line">def preprocess(doc):</span><br><span class="line">    doc = doc.<span class="built_in">lower</span>()  <span class="comment"># Lower the text.</span></span><br><span class="line">    doc = word_tokenize(doc)  <span class="comment"># Split into words.</span></span><br><span class="line">    doc = [w <span class="keyword">for</span> w <span class="keyword">in</span> doc <span class="keyword">if</span> <span class="keyword">not</span> w <span class="keyword">in</span> stop_words]  <span class="comment"># Remove stopwords.</span></span><br><span class="line">    doc = [w <span class="keyword">for</span> w <span class="keyword">in</span> doc <span class="keyword">if</span> w.isalpha()]  <span class="comment"># Remove numbers and punctuation.</span></span><br><span class="line">    <span class="literal">return</span> doc</span><br><span class="line"></span><br><span class="line"><span class="built_in">start</span> = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Business IDs of the restaurants.</span></span><br><span class="line">ids = [<span class="string">'4bEjOyTaDG24SY5TxsaUNQ'</span>, <span class="string">'2e2e7WgqU1BnpxmQL5jbfw'</span>, <span class="string">'zt1TpTuJ6y9n551sw9TaEg'</span>,</span><br><span class="line">      <span class="string">'Xhg93cMdemu5pAMkDoEdtQ'</span>, <span class="string">'sIyHTizqAiGu12XMLX3N3g'</span>, <span class="string">'YNQgak-ZLtYJQxlDwN-qIg'</span>]</span><br><span class="line"></span><br><span class="line">w2v_corpus = []  <span class="comment"># Documents to train word2vec on (all 6 restaurants).</span></span><br><span class="line">wmd_corpus = []  <span class="comment"># Documents to run queries against (only one restaurant).</span></span><br><span class="line">documents = []  <span class="comment"># wmd_corpus, with no pre-processing (so we can see the original documents).</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'/data/yelp_academic_dataset_review.json'</span>) <span class="keyword">as</span> data_file:</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">line</span> <span class="keyword">in</span> data_file:</span><br><span class="line">        json_line = json.loads(<span class="built_in">line</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> json_line[<span class="string">'business_id'</span>] <span class="keyword">not</span> <span class="keyword">in</span> ids:</span><br><span class="line">            <span class="comment"># Not one of the 6 restaurants.</span></span><br><span class="line">            continue</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Pre-process document.</span></span><br><span class="line">        <span class="keyword">text</span> = json_line[<span class="string">'text'</span>]  <span class="comment"># Extract text from JSON object.</span></span><br><span class="line">        <span class="keyword">text</span> = preprocess(<span class="keyword">text</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Add to corpus for training Word2Vec.</span></span><br><span class="line">        w2v_corpus.append(<span class="keyword">text</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> json_line[<span class="string">'business_id'</span>] == ids[<span class="number">0</span>]:</span><br><span class="line">            <span class="comment"># Add to corpus for similarity queries.</span></span><br><span class="line">            wmd_corpus.append(<span class="keyword">text</span>)</span><br><span class="line">            documents.append(json_line[<span class="string">'text'</span>])</span><br><span class="line"></span><br><span class="line">print <span class="string">'Cell took %.2f seconds to run.'</span> %(<span class="built_in">time</span>() - <span class="built_in">start</span>)</span><br></pre></td></tr></table></figure>
<p>下面是一个文档长度的直方图，该图中也包含了平均文档长度。注意这些是经过预处理的文档，也就是说停用词已经被移除，标点符号已经被移除，等等。文档长度对wmd的运行时间有很大的影响，因此当和本次实验比较运行时间时，查询corpus的文档数量（大约4000）和文档长度（大约平均62个词）应该被考虑在内。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> matplotlib import pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="comment"># Document lengths.</span></span><br><span class="line">lens = [<span class="built_in">len</span>(doc) <span class="keyword">for</span> doc <span class="keyword">in</span> wmd_corpus]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot.</span></span><br><span class="line">plt.rc(<span class="string">'figure'</span>, figsize=(<span class="number">8</span>,<span class="number">6</span>))</span><br><span class="line">plt.rc(<span class="string">'font'</span>, size=<span class="number">14</span>)</span><br><span class="line">plt.rc(<span class="string">'lines'</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">plt.rc(<span class="string">'axes'</span>, color_cycle=(<span class="string">'#377eb8'</span>,<span class="string">'#e41a1c'</span>,<span class="string">'#4daf4a'</span>,</span><br><span class="line">                            <span class="string">'#984ea3'</span>,<span class="string">'#ff7f00'</span>,<span class="string">'#ffff33'</span>))</span><br><span class="line"><span class="comment"># Histogram.</span></span><br><span class="line">plt.hist(lens, bins=<span class="number">20</span>)</span><br><span class="line">plt.hold(True)</span><br><span class="line"><span class="comment"># Average length.</span></span><br><span class="line">avg_len = <span class="built_in">sum</span>(lens) / float(<span class="built_in">len</span>(lens))</span><br><span class="line">plt.axvline(avg_len, color=<span class="string">'#e41a1c'</span>)</span><br><span class="line">plt.hold(False)</span><br><span class="line">plt.title(<span class="string">'Histogram of document lengths.'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Length'</span>)</span><br><span class="line">plt.<span class="keyword">text</span>(<span class="number">100</span>, <span class="number">800</span>, <span class="string">'mean = %.2f'</span> % avg_len)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="http://i2.muimg.com/567571/479272b7085337df.png" alt></p>
<p>现在，我们想要用corpus和w2v初始化相似类（提供了嵌入和wmdistance方法）。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Train Word2Vec on all the restaurants.</span></span><br><span class="line">model = Word2Vec(w2v_corpus, <span class="attribute">workers</span>=3, <span class="attribute">size</span>=100)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize WmdSimilarity.</span></span><br><span class="line"><span class="keyword">from</span> gensim.similarities import WmdSimilarity</span><br><span class="line">num_best = 10</span><br><span class="line">instance = WmdSimilarity(wmd_corpus, model, <span class="attribute">num_best</span>=10)</span><br></pre></td></tr></table></figure>
<p>num_best参数决定了查询返回的结果数量。现在让我们来做个查询。输出是corpus中文档相似度和索引的一个列表，按照相似度排序。</p>
<p>注意当num_best为None（也就是没有指定参数）时输出形式有些不同。在这种情况下，你得到一个涵盖corpus中每个文档的相似度数组。</p>
<p>下面的查询直接取自corpus中的一条评论。让我们看看是否有其他的评论相似于这一条。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">sent = <span class="string">'Very good, you should seat outdoor.'</span></span><br><span class="line"><span class="keyword">query</span> = preprocess(sent)</span><br><span class="line"></span><br><span class="line">sims = <span class="keyword">instance</span>[<span class="keyword">query</span>]  <span class="comment"># A query is simply a "look-up" in the similarity class.</span></span><br><span class="line"></span><br><span class="line">print <span class="string">'Cell took %.2f seconds to run.'</span> %(<span class="built_in">time</span>() - <span class="keyword">start</span>)</span><br></pre></td></tr></table></figure>
<p>查询和最相似的文档，以及它们的相似度，在下面被打印出来。我们看到被检索到的文档讨论着和查询一样的事情，尽管使用了不同的单词。查询谈论的是得到一个户外的座位，而结果谈论的是坐在外面，结果中的一个说的是餐馆有一个好的景观。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Print the query and the retrieved documents, together with their similarities.</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Query:'</span></span><br><span class="line"><span class="keyword">print</span> sent</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(num_best):</span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'sim = %.4f'</span> % sims[i][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">print</span> documents[sims[i][<span class="number">0</span>]]</span><br></pre></td></tr></table></figure>
<p>让我们尝试一个不同的查询，同样直接取自corpus评论中的一个。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">sent = <span class="string">'I felt that the prices were extremely reasonable for the Strip'</span></span><br><span class="line"><span class="keyword">query</span> = preprocess(sent)</span><br><span class="line"></span><br><span class="line">sims = <span class="keyword">instance</span>[<span class="keyword">query</span>]  <span class="comment"># A query is simply a "look-up" in the similarity class.</span></span><br><span class="line"></span><br><span class="line">print <span class="string">'Query:'</span></span><br><span class="line">print sent</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(num_best):</span><br><span class="line">    print</span><br><span class="line">    print <span class="string">'sim = %.4f'</span> % sims[i][<span class="number">1</span>]</span><br><span class="line">    print documents[sims[i][<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">print <span class="string">'\nCell took %.2f seconds to run.'</span> %(<span class="built_in">time</span>() - <span class="keyword">start</span>)</span><br></pre></td></tr></table></figure>
<p>这次，结果更加直接。检索到的文档基本包含了与查询相同的词。</p>
<p>WmdSimilarity默认正则化了词嵌入（使用init_sims()，正如前面解释的），但你可以改变这个行为通过调用WmdSimilarity,并设置normalize_w2v_and_replace=False。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print 'Notebook took %<span class="number">.2</span>f seconds <span class="keyword">to</span> <span class="built_in">run</span>.' %(<span class="built_in">time</span>() - start_nb)</span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ol>
<li>Ofir Pele and Michael Werman, A linear time histogram metric for improved SIFT matching, 2008.</li>
<li>Ofir Pele and Michael Werman, Fast and robust earth mover’s distances, 2009.</li>
<li>Matt Kusner et al. From Embeddings To Document Distances, 2015.</li>
<li>Thomas Mikolov et al. Efficient Estimation of Word Representations in Vector Space, 2013.</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2017/03/30/machine learning/NLP/idf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/03/30/machine learning/NLP/idf/" class="post-title-link" itemprop="url">idf</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-30 14:59:25" itemprop="dateCreated datePublished" datetime="2017-03-30T14:59:25+08:00">2017-03-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-28 20:45:06" itemprop="dateModified" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="idf-计算技巧"><a href="#idf-计算技巧" class="headerlink" title="idf 计算技巧"></a>idf 计算技巧</h1><p>假设不同词共有N个，文档共有M个，单文档最大长度是L。</p>
<p>我们看如下两种计算方式。</p>
<p>第一种是先作出所有词的词典，然后对每个词进行遍历，看它在多少个文档中出现，复杂度是N×M： </p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from collections import Counter</span><br><span class="line"><span class="comment">#word frequency by words</span></span><br><span class="line">w_freq = Counter(<span class="string">' '</span>.join(train_que).<span class="keyword">split</span>())</span><br><span class="line"><span class="comment">#word frequency by docs</span></span><br><span class="line">d_freq = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i in w_freq.keys():</span><br><span class="line">    <span class="keyword">for</span> j in train_que:</span><br><span class="line">        <span class="keyword">if</span> i in j:</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> in d_freq:</span><br><span class="line">                d_fre<span class="string">q[i]</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d_fre<span class="string">q[i]</span> += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>第二种是遍历所有文档，记录每个文档中出现的词，复杂度是M×L：<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from collections import Counter</span><br><span class="line"><span class="comment">#word frequency by words</span></span><br><span class="line">w_freq = Counter(<span class="string">' '</span>.join(train_que).<span class="keyword">split</span>())</span><br><span class="line"><span class="comment">#word frequency by docs</span></span><br><span class="line">d_freq = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> text in train_que:</span><br><span class="line">    <span class="keyword">for</span> i in set(text.<span class="keyword">split</span>()):</span><br><span class="line">        try:</span><br><span class="line">            d_fre<span class="string">q[i]</span> += <span class="number">1</span></span><br><span class="line">        except:</span><br><span class="line">            d_fre<span class="string">q[i]</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>显然，两者效率相差极大。一般L不过在10左右，而N却可以高达上万。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">muzhen</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">346</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">37</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">112</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">muzhen</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  
  



  




  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  

  

  

  

  

  

  

  

  

  

</body>
</html>
