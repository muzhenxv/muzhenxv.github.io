<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false,"dimmer":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="the Home of MuZhen">
<meta property="og:url" content="http://www.muzhen.tk/page/6/index.html">
<meta property="og:site_name" content="the Home of MuZhen">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="the Home of MuZhen">






  <link rel="canonical" href="http://www.muzhen.tk/page/6/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>the Home of MuZhen</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">the Home of MuZhen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NLP/text summarization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NLP/text summarization/" class="post-title-link" itemprop="url">text summarization</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NLP/w2v/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NLP/w2v/" class="post-title-link" itemprop="url">w2v</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<h1 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h1><p><a href="http://blog.csdn.net/itplus/article/details/37969519" target="_blank" rel="noopener"> word2vec 中的数学原理详解</a></p>
<p>相较于词向量的表示方法，将每个词给定一个ID的编码方法，具有以下坏处：</p>
<ol>
<li>特征稀疏，不利于训练</li>
<li>丢掉了词与词之间的关联信息</li>
</ol>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>w2v中用过两个重要模型：CBOW（Continuous Bag-of-Words Model） 和 Skip-gram(Continuous Skip-gram Model)。并且对这两个模型给出了两套框架，它们分别基于Hierarchical Softmax 和 Negative Sampling 来进行设计。</p>
<p><img src="http://i4.buimg.com/567571/cff15585d3764d1b.png" alt></p>
<p>CBOW是在给出上下文的情况下预测当前词，Skip-gram是在给出当前词的情况下预测上下文。</p>
<blockquote>
<p>This inversion might seem like an arbitrary choice, but statistically it has the effect that CBOW smoothes over a lot of the distributional information (by treating an entire context as one observation). For the most part, this turns out to be a useful thing for smaller datasets. However, skip-gram treats each context-target pair as a new observation, and this tends to do better when we have larger datasets.</p>
</blockquote>
<p>可以简单的理解为，只有在大数据集上，以当前词来预测上下文才有更高的意义，因为得到的样本分布更真实。也就是用skip-gram更好。</p>
<h1 id="基于-Hierarchical-Softmax-的-CBOW-amp-Skip-gram"><a href="#基于-Hierarchical-Softmax-的-CBOW-amp-Skip-gram" class="headerlink" title="基于 Hierarchical Softmax 的 CBOW &amp; Skip-gram"></a>基于 Hierarchical Softmax 的 CBOW &amp; Skip-gram</h1><p>两个模型目标函数都采用对数似然函数：<br>\begin{split} \text{CBOW: } \sum_{\omega} \log p(\omega|Context(\omega))\end{split}<br>\begin{split} \text{Skip-gram: } \sum_{\omega} \log p(Context(\omega)|\omega)\end{split}</p>
<h2 id="CBOW"><a href="#CBOW" class="headerlink" title="CBOW"></a>CBOW</h2><p><img src="http://i2.muimg.com/567571/31968b07b3dff0ae.png" alt></p>
<ol>
<li>输入层为上下文每个词的词向量，长度已经对齐。</li>
<li>投影层为上下文词向量的求和，注意没有隐藏层！</li>
<li>输出层是一颗Huffman树[TBC]。</li>
</ol>
<h2 id="Skip-gram"><a href="#Skip-gram" class="headerlink" title="Skip-gram"></a>Skip-gram</h2><p><img src="http://omdhuynsr.bkt.clouddn.com/17-4-16/16673772-file_1492345798643_e083.png" alt></p>
<ol>
<li>输入层输入词向量。</li>
<li>投影层为恒等投影，其实多余，只是为了和CBOW做比较。</li>
<li>输出层也是一颗Huffman树[TBC]。</li>
</ol>
<h1 id="基于-Negative-Sampling-的-CBOW-amp-Skip-gram"><a href="#基于-Negative-Sampling-的-CBOW-amp-Skip-gram" class="headerlink" title="基于 Negative Sampling 的 CBOW &amp; Skip-gram"></a>基于 Negative Sampling 的 CBOW &amp; Skip-gram</h1><p>目的是为了提高训练速度并改善所得词向量质量。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NLP/实体关系抽取/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NLP/实体关系抽取/" class="post-title-link" itemprop="url">实体关系抽取</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h1><p><a href="https://www.zhihu.com/question/43227185/answer/117776933" target="_blank" rel="noopener">实体关系抽取有哪些现成的工具可以使用呢？开源的系统有吗？</a></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">可以参考[<span class="string">GitHub - Mrlyk423/Relation_Extraction: Knowledge Base Embedding</span>](<span class="link">https://github.com/Mrlyk423/Relation_Extraction</span>)</span><br><span class="line"></span><br><span class="line">[<span class="string">GitHub - bishanyang/EventEntityExtractor: Joint event and entity extractor</span>](<span class="link">https://github.com/bishanyang/EventEntityExtractor</span>)</span><br><span class="line"></span><br><span class="line">[<span class="string">GitHub - yifange/event_extraction</span>](<span class="link">https://link.zhihu.com/?target=https%3A//github.com/yifange/event_extraction</span>)</span><br><span class="line"></span><br><span class="line">[<span class="string">GitHub - twjiang/fact_triple_extraction: 使用句法依存分析抽取事实三元组</span>](<span class="link">https://github.com/twjiang/fact_triple_extraction</span>)</span><br><span class="line"></span><br><span class="line">[<span class="string">Open Information Extraction</span>](<span class="link">http://openie.allenai.org/</span>)</span><br></pre></td></tr></table></figure>
<h1 id="利用哈工大ltp进行关系抽取"><a href="#利用哈工大ltp进行关系抽取" class="headerlink" title="利用哈工大ltp进行关系抽取"></a>利用哈工大ltp进行关系抽取</h1><p><a href="https://github.com/twjiang/fact_triple_extraction" target="_blank" rel="noopener">GitHub - twjiang/fact_triple_extraction: 使用句法依存分析抽取事实三元组</a></p>
<p>对应ltp model可使用3.3.1版本。自行关注版本update。<a href="https://pan.baidu.com/share/link?shareid=1988562907&amp;uk=2738088569#list/path=%2F" target="_blank" rel="noopener">模型下载地址</a></p>
<p>该脚本不向上兼容python3,因此报错的地方需要使用python3语法进行修改。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NLP/情感分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NLP/情感分析/" class="post-title-link" itemprop="url">情感分析</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基于词典的情感分析"><a href="#基于词典的情感分析" class="headerlink" title="基于词典的情感分析"></a>基于词典的情感分析</h1><p>references中的两篇blog讲的很好，这里简单总结一下。</p>
<ul>
<li><p>找到不错的正负极性词典。如果词典是带有每个词的极性评分的，那就更好了。</p>
</li>
<li><p>否定词词典。考虑否定词的带来的词性反转效果。</p>
</li>
<li><p>程度副词词典。考虑程度副词带来的权重改变。</p>
</li>
</ul>
<h1 id="相关词典"><a href="#相关词典" class="headerlink" title="相关词典"></a>相关词典</h1><p><a href="http://bosonnlp.com/dev/resource" target="_blank" rel="noopener">BosonNLP情感词典</a>： 词典来源于BosonNLP数据下载的情感词典，来源于社交媒体文本，所以词典适用于处理社交媒体的情感分析。</p>
<p>程度副词词典：<a href="http://www.keenage.com/download/sentiment.rar" target="_blank" rel="noopener">《知网》情感分析用词语集（beta版）</a>。该词典对每个词赋予了程度数值。</p>
<p><a href="http://www.hicode.cn/download/view-software-13784.html" target="_blank" rel="noopener">中文停用词词典</a></p>
<p>否定词词典： 需要自己总结，如 <code>不、没、无、非、莫、弗、勿、毋、未、否、别、無、休、难道</code></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://www.jianshu.com/p/4cfcf1610a73?nomobile=yes" target="_blank" rel="noopener">Python做文本情感分析之情感极性分析</a></p>
<p><a href="https://site.douban.com/146782/widget/notes/15462869/note/355625387/" target="_blank" rel="noopener">基于词典的中文情感倾向分析算法设计</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NLP/文本预处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NLP/文本预处理/" class="post-title-link" itemprop="url">文本预处理</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="只保留中文"><a href="#只保留中文" class="headerlink" title="只保留中文"></a>只保留中文</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">u'[\u4e00-\u9fff ]+'</span>, text)</span><br></pre></td></tr></table></figure>
<h1 id="只保留英文和数字"><a href="#只保留英文和数字" class="headerlink" title="只保留英文和数字"></a>只保留英文和数字</h1><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">re</span><span class="selector-class">.sub</span>(<span class="string">'[^A-Za-z0-9]+'</span>, <span class="string">' '</span>, mystring)</span><br></pre></td></tr></table></figure>
<h1 id="移除英文标点符号"><a href="#移除英文标点符号" class="headerlink" title="移除英文标点符号"></a>移除英文标点符号</h1><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">re.<span class="built_in">sub</span>(<span class="string">'[&#123;&#125;]+'</span>.<span class="built_in">format</span>(<span class="built_in">string</span>.punctuation),<span class="string">''</span>,l)</span><br><span class="line"># <span class="keyword">or</span> we can use <span class="built_in">string</span>.punctuation get punctuation list <span class="keyword">then</span> straightforward use it to replace.</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.punctuation)</span><br><span class="line">re.<span class="built_in">sub</span>(<span class="string">'[!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~]+'</span>,<span class="string">' '</span>,l)</span><br></pre></td></tr></table></figure>
<h1 id="移除中文标点符号"><a href="#移除中文标点符号" class="headerlink" title="移除中文标点符号"></a>移除中文标点符号</h1><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.sub("[<span class="tag">\<span class="name">s</span></span>+<span class="tag">\<span class="name">.</span></span><span class="tag">\<span class="name">!</span></span><span class="tag">\<span class="name">/</span></span>_,<span class="formula">$%^*(+<span class="tag">\<span class="name">"</span></span><span class="tag">\<span class="name">'</span></span>]+|[+——！，。？、~@#￥%……&amp;*（）：；《）《》“”()»〔〕-]+", " ",line)</span></span><br></pre></td></tr></table></figure>
<h1 id="英文分词并去除英文停用词"><a href="#英文分词并去除英文停用词" class="headerlink" title="英文分词并去除英文停用词"></a>英文分词并去除英文停用词</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 英文停用词</span></span><br><span class="line">from nltk.corpus import stopwords</span><br><span class="line">stops = <span class="keyword">set</span>(stopwords.words(<span class="string">"english"</span>))</span><br><span class="line"></span><br><span class="line">line = <span class="string">"I'm walking with a dog. You hasn't a cat!"</span></span><br><span class="line"></span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> nltk.word_tokenize(line) <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> stops]</span><br><span class="line"><span class="keyword">Out</span>[<span class="number">39</span>]: [<span class="string">'I'</span>, <span class="string">"'m"</span>, <span class="string">'walking'</span>, <span class="string">'dog'</span>, <span class="string">'.'</span>, <span class="string">'You'</span>, <span class="string">"n't"</span>, <span class="string">'cat'</span>, <span class="string">'!'</span>]</span><br><span class="line"></span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> nltk.word_tokenize(line) <span class="keyword">if</span> x.lower() <span class="keyword">not</span> <span class="keyword">in</span> stops]</span><br><span class="line"><span class="keyword">Out</span>[<span class="number">40</span>]: [<span class="string">"'m"</span>, <span class="string">'walking'</span>, <span class="string">'dog'</span>, <span class="string">'.'</span>, <span class="string">"n't"</span>, <span class="string">'cat'</span>, <span class="string">'!'</span>]</span><br></pre></td></tr></table></figure>
<p>注意，nltk自带的停用词词典是小写格式，所以在去除停用词时先需要转换小写。</p>
<p><code>nltk.word_tokenize</code>在应对<code>I&#39;m</code>这样形式的单词时分词效果是否合宜需要取决需求。</p>
<p>如果code报错，可能是因为还没有下载停用词库。通过如下方式下载：</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="title">nltk</span>.download(<span class="string">"stopwords"</span>)</span><br></pre></td></tr></table></figure>
<h1 id="英文还原词跟"><a href="#英文还原词跟" class="headerlink" title="英文还原词跟"></a>英文还原词跟</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> nltk.stem import SnowballStemmer</span><br><span class="line">stemmer = SnowballStemmer(<span class="string">'english'</span>)</span><br><span class="line"><span class="keyword">text</span> = [stemmer.stem(<span class="built_in">word</span>) <span class="keyword">for</span> <span class="built_in">word</span> <span class="keyword">in</span> <span class="keyword">text</span>.<span class="built_in">split</span>()]</span><br></pre></td></tr></table></figure>
<h1 id="中文分词并去除停用词"><a href="#中文分词并去除停用词" class="headerlink" title="中文分词并去除停用词"></a>中文分词并去除停用词</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stops = [ <span class="built_in">line</span>.strip() <span class="keyword">for</span> <span class="built_in">line</span> <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">"../../file/stopword.txt"</span>)]</span><br><span class="line">segs = jieba.cut(<span class="keyword">text</span>)</span><br><span class="line">segs = [<span class="built_in">word</span> <span class="keyword">for</span> <span class="built_in">word</span> <span class="keyword">in</span> list(segs) <span class="keyword">if</span> <span class="built_in">word</span> <span class="keyword">not</span> <span class="keyword">in</span> stoplist]</span><br></pre></td></tr></table></figure>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/yan456jie/article/details/60476457" target="_blank" rel="noopener"> python27使用jieba分词，去除停用词</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/Q&A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/Q&A/" class="post-title-link" itemprop="url">Q&A</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="多分类搭建网络时输出层结果为什么不直接做softmax处理？"><a href="#多分类搭建网络时输出层结果为什么不直接做softmax处理？" class="headerlink" title="多分类搭建网络时输出层结果为什么不直接做softmax处理？"></a>多分类搭建网络时输出层结果为什么不直接做softmax处理？</h1><p>貌似是因为在训练时如果做先softmax，在算交叉熵会出现数值不稳定问题，softmax_cross_entropy_with_logits将softmax和交叉熵计算放在一起并做了优化。而在测试集上因为要输出概率，所以在复原网络结构时需要在output layer上加上softmax。</p>
<p><a href="https://stackoverflow.com/questions/34240703/whats-the-difference-between-softmax-and-softmax-cross-entropy-with-logits/39499486#39499486" target="_blank" rel="noopener">What’s the difference between softmax and softmax_cross_entropy_with_logits?</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/Wide&Deep Learning for Recommender Systems/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/Wide&Deep Learning for Recommender Systems/" class="post-title-link" itemprop="url">Wide&Deep Learning for Recommender Systems</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文为<a href="https://arxiv.org/pdf/1606.07792.pdf" target="_blank" rel="noopener">Wide &amp; Deep Learning for Recommender Systems</a>读书笔记。</p>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>推荐系统的一个挑战是同时实现memorization和generalization。</p>
<p>Memorization: 在历史数据中学习特征或者items之间的频繁项集或者相关性</p>
<p>Generalization：基于相关性的传递性探索在过去很少或从未出现的新特征组合</p>
<p>大规模线上推荐系统一般使用lr。特征一般为稀疏化后的二值特征。我们可以通过交叉乘积变换得到memorization，比如AND(user_installed_app=netflix, impression_app=pandora”)。generalization可以通过构造粗粒度特征来实现，比如AND(user_installed_category=video,impression_category=music)。交叉乘积变换的一个限制是无法泛化训练集中没有出现的特征组合（该论文中指query-item feature pairs）。</p>
<p>基于embedding的模型，通过低维稠密嵌入的方式，可以泛化没有见过的特征组合，但这容易导致过拟合和更少相关性的推荐。另一方面，运用交叉乘积变换的线性模型可以使用更少的参数记忆exception rules。</p>
<p>本论文提出wide&amp;deep，做出了以下贡献：</p>
<ul>
<li><p>集成训练基于embedding的NN和基于特征变换的LR用于稀疏输入的一般推荐系统</p>
</li>
<li><p>显著提高了google play app store的推荐效果</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/18-4-24/52502359.jpg" alt></p>
</li>
</ul>
<h1 id="推荐系统概述"><a href="#推荐系统概述" class="headerlink" title="推荐系统概述"></a>推荐系统概述</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/18-4-24/17883094.jpg" alt></p>
<p>推荐系统流程：用户发起查询-&gt;按规则或者模型进行初步检索得到一个小量级的app候选池，利用wide&amp;deep进行打分排序。</p>
<h1 id="wide-amp-deep-learning"><a href="#wide-amp-deep-learning" class="headerlink" title="wide&amp;deep learning"></a>wide&amp;deep learning</h1><h2 id="the-wide-component"><a href="#the-wide-component" class="headerlink" title="the wide component"></a>the wide component</h2><p>图一左侧，LR，特征为一般二值特征以及corss-product transformation的二值特征。</p>
<h2 id="the-deep-component"><a href="#the-deep-component" class="headerlink" title="the deep component"></a>the deep component</h2><p>图一右侧</p>
<h2 id="joint-training-of-wide-amp-deep-model"><a href="#joint-training-of-wide-amp-deep-model" class="headerlink" title="joint training of wide &amp; deep model"></a>joint training of wide &amp; deep model</h2><ul>
<li>joint training: 同时优化所有参数；wide作为deep的补充，并不需要全尺寸模型</li>
<li>ensemble： 各个模型分别训练，结果集成；对每个模型都有精度要求，也即是要求大尺寸（更多的特征等）的模型</li>
</ul>
<h1 id="system-implementation"><a href="#system-implementation" class="headerlink" title="system implementation"></a>system implementation</h1><p>推荐系统分成三个部分：数据生成，模型训练，模型服务</p>
<h2 id="data-generation"><a href="#data-generation" class="headerlink" title="data generation"></a>data generation</h2>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/activation function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/activation function/" class="post-title-link" itemprop="url">activation function</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#references</p>
<p><a href="https://livc.io/176" target="_blank" rel="noopener">常用激活函数的总结与比较</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/convalutional networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/convalutional networks/" class="post-title-link" itemprop="url">convalutional networks</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script><br>此文为 <a href="http://www.deeplearningbook.org/contents/convnets.html" target="_blank" rel="noopener">CHAPTER 9 CONVALUTIONAL NETWORKS</a> 的简要翻译。</p>
<h1 id="9-1-The-Convolution-Operation"><a href="#9-1-The-Convolution-Operation" class="headerlink" title="9.1 The Convolution Operation"></a>9.1 The Convolution Operation</h1><p>一般意义上，卷积是一个 在与一个实值参数相关的两个函数上 的操作。为了引出卷积定义，我们先来看个例子。</p>
<p>假设我们通过激光传感器来跟踪太空船的位置。我们的激光传感器提供了一个简单的输出\(x(t)\)，表示时刻 \(t\) 太空船的位置。每个瞬间（假设可以连续不间断的）光传感器都会传给我们一个值。</p>
<p>现在假设我们的光传感器有了噪音。为了降低噪音影响，我们会想对一些观测去平均。当然，时间越近的观测越重要，因此我们会做一个加权平均。我们可以利用 \(\omega(a)\) 来进行加权， \(a\) 是观测的年龄。如果我们对每个时刻运用这样一个加权操作，我们获得了一个新的函数 \(s\) ，它提供了一个太空船位置的光滑估计：</p>
<p>\[s(t) = \int x(a) \omega(t-a) da \tag{9.1}\]</p>
<p>这个操作就叫做卷积。卷积操作使用星号表示：</p>
<p>\[s(t) = (x*\omega)(t) \tag{9.2}\]</p>
<p>在我们的例子中， \(\omega\) 需要是一个概率密度函数，不然的话输出将不再是一个加权平均。通常，卷积可以定义在任意函数上，它可以用于除了加权平均之外的其他目的。</p>
<p>（译者注：太空船应该是静止不动的，只有这样对不同时刻传回观测进行加权平均去定位才有意义）</p>
<p>在卷积网络术语中，卷积的第一个参数（在这个例子中是函数 \(x\)通常被成为input（特征维度），第二个参数（函数\(\omega\)）被成为kernel。输出被成为feature map。</p>
<p>每个瞬间都回传值是不大现实的，更为现实的是每隔一段时间（比如说1秒）回传一个值。因此，我们可以去定义一个离散卷积：</p>
<p>\[s(t) = (x*\omega)(t) = \sum x(a) \omega(t-a) \tag{9.3}\]</p>
<p>在机器学习中，input通常是一个多维数组，而kernel通常是需要通过算法去学习的参数。下图表明了一个卷积过程。</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/9012565-file_1494766766447_7474.png" alt></p>
<h1 id="9-2-Motivation"><a href="#9-2-Motivation" class="headerlink" title="9.2 Motivation"></a>9.2 Motivation</h1><p>卷积运用三个重要的idea去帮助改善机器学习系统：sparse interactions,parameter sharing,equivariant representations。</p>
<p>传统神经网络层对有独立参数组成的参数矩阵使用矩阵乘法，以此来描述输入单元和输出单元之间的交互关系。这意味着每个输出单元和每个输入单元都相关。但是卷积网络则是局部相关（sparse interactions，也叫做sparse connectivity或者sparse weights）。通过使用一个比input小的kernel可以实现sparse interactions。这意味着我们只需要存储更少的参数，既可以减少内存需求，也可以改善它的统计有效性。这也意味着可以简化输出的计算量。这些效率上的改善通常非常大。如果有m个inputs和n个outputs，矩阵乘法需要m×n个参数，并且每个样本的时间复杂度是O(m×n)。但是如果我们把每个输出对输入单元的连接限制为k，那么局部连接方法仅需要k×n个参数和O(k×n)的时间复杂度。在许多实践应用中，即使k比m小几个数量级，在机器学习任务中获得好的表现也是可能的。在深度网络中，深层的单元依旧会间接的被大部分input所影响。这就允许我们通过合适的局部连接去表述复杂的变量间关系，如下图：</p>
<p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/219219-file_1494768700480_12a78.png" alt></p>
<p>参数共享指的是在模型的多个函数中使用相同的参数。作为parameter sharing的同义词，我们可以说一个网络有tied weights。这并不会减少时间复杂度，但是它可以进一步降低存储需求。</p>
<h1 id="9-3-Pooling"><a href="#9-3-Pooling" class="headerlink" title="9.3 Pooling"></a>9.3 Pooling</h1><p>一个卷积层一般包含三个步骤。第一个步骤是用（多个）卷积核进行卷积，第二个步骤是用利用非线性激活函数进行转换，这个步骤也就做detector stage。第三个步骤，我们使用池化函数进一步改善输出层。</p>
<p>池化使得representation对于input的小改变具有近似不变性。</p>
<h1 id="9-4-Convolution-and-Pooling-as-an-Infinitely-Strong-Prior"><a href="#9-4-Convolution-and-Pooling-as-an-Infinitely-Strong-Prior" class="headerlink" title="9.4 Convolution and Pooling as an Infinitely Strong Prior"></a>9.4 Convolution and Pooling as an Infinitely Strong Prior</h1><p>弱先验意味着参数取值的选择更多，比如说具有高方差的高斯分布。强先验意味着取值范围更小，比如低方差的高斯分布。</p>
<p>卷积可以理解为这样一种强先验假设：除了局部区域外，其他输入单元的对应权重都是0。</p>
<p>池化可以理解为这样一种假设：小改变不导致取值变化。</p>
<p>显然，当假设和事实不符时，会出现欠拟合。</p>
<h1 id="9-5-Variants-of-the-Basic-Convolution-Function"><a href="#9-5-Variants-of-the-Basic-Convolution-Function" class="headerlink" title="9.5 Variants of the Basic Convolution Function"></a>9.5 Variants of the Basic Convolution Function</h1>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/convolutional neural networks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/convolutional neural networks/" class="post-title-link" itemprop="url">convolutional neural networks</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="局部感受野"><a href="#局部感受野" class="headerlink" title="局部感受野"></a>局部感受野</h1><p><img src="http://omdhuynsr.bkt.clouddn.com/17-5-14/11586442-file_1494754594758_9c25.png" alt></p>
<p>一般认为人对外界的认知是从局部到全局的，而图像的空间联系也是局部的像素联系较为紧密，而距离较远的像素相关性则较弱。因而，每个神经元其实没有必要对全局图像进行感知，只需要对局部进行感知，然后在更高层将局部的信息综合起来就得到了全局的信息。  </p>
<p>通过局部感受野，参数可以有明显减少。</p>
<p>多通道情况下，局部感受野同时作用在不同通道上，结果相加后进行激活。</p>
<h1 id="权值共享"><a href="#权值共享" class="headerlink" title="权值共享"></a>权值共享</h1><p>不同局部的权值相同，换言之不需要针对不同局部训练不同参数。</p>
<p>这其中隐含的原理则是：图像的一部分的统计特性与其他部分是一样的。这也意味着我们在这一部分学习的特征也能用在另一部分上，所以对于这个图像上的所有位置，我们都能使用同样的学习特征。</p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://www.36dsj.com/archives/24006" target="_blank" rel="noopener">技术向：一文读懂卷积神经网络</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/lstm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/lstm/" class="post-title-link" itemprop="url">lstm</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="如何理解TF中BasicLSTMCell的输入参数size"><a href="#如何理解TF中BasicLSTMCell的输入参数size" class="headerlink" title="如何理解TF中BasicLSTMCell的输入参数size"></a><a href="https://www.zhihu.com/question/57981847" target="_blank" rel="noopener">如何理解TF中BasicLSTMCell的输入参数size</a></h1><p>就是指隐藏状态的维数。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/rnn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/rnn/" class="post-title-link" itemprop="url">rnn</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<h1 id="lstm"><a href="#lstm" class="headerlink" title="lstm"></a>lstm</h1><p>此处先说明tensorflow中以下代码的输出<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outputs,final_state = tf<span class="selector-class">.nn</span><span class="selector-class">.dynamic_rnn</span>(lstm_cell,x_in,initial_state=init_state,time_major=False)</span><br></pre></td></tr></table></figure></p>
<p>outputs储存每个时刻的输出，也就是下面的分线输出（它也同时被复制为当时时刻的外部输出）,它的形状是[batch_size,n_steps,n_hidden_units]（如果一开始的输入形式为[n_steps,batch_size,n_inputs]，则time_major=True，output形状为[n_steps,batch_size,n_hidden_units]）</p>
<p>final_state仅仅只记录最后时刻的主线状态和分线状态，默认以元组形式保存，主线状态在前。</p>
<p>因此，分线state和outputs最后一个时刻的记录是相同的，至少在基础lstm上。</p>
<p>lstm一开始需要定义的初始状态应该就是指一开始的主线和分线state。</p>
<p><img src="http://i2.muimg.com/567571/e28747d6a50b8fad.png" alt></p>
<h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/mydear_11000/article/details/52414342" target="_blank" rel="noopener">解读tensorflow之rnn</a><br><a href="http://www.jianshu.com/p/9dc9f41f0b29" target="_blank" rel="noopener">[译] 理解 LSTM 网络</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/tensorflow函数说明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/tensorflow函数说明/" class="post-title-link" itemprop="url">tensorflow函数说明</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="tf-nn-embedding-lookup-amp-tf-nn-embedding-lookup-sparse"><a href="#tf-nn-embedding-lookup-amp-tf-nn-embedding-lookup-sparse" class="headerlink" title="tf.nn.embedding_lookup&amp;tf.nn.embedding_lookup_sparse"></a>tf.nn.embedding_lookup&amp;tf.nn.embedding_lookup_sparse</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">tf.nn.embedding_lookup(</span><br><span class="line">    params,</span><br><span class="line">    ids,</span><br><span class="line">    partition_strategy=<span class="string">'mod'</span>,</span><br><span class="line">    name=<span class="keyword">None</span>,</span><br><span class="line">    validate_indices=<span class="keyword">True</span>,</span><br><span class="line">    max_norm=<span class="keyword">None</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">tf.nn.embedding_lookup_sparse(</span><br><span class="line">    params,</span><br><span class="line">    sp_ids,</span><br><span class="line">    sp_weights,</span><br><span class="line">    partition_strategy=<span class="string">'mod'</span>,</span><br><span class="line">    name=<span class="keyword">None</span>,</span><br><span class="line">    combiner=<span class="keyword">None</span>,</span><br><span class="line">    max_norm=<span class="keyword">None</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>params是embedding的参数tensor（设为$F*K$），ids是指明索引的tensor， sp_ids是指明索引的sparse_tensor。</p>
<p>函数的目的是根据索引来进行embedding tensor的按第一维度切片。</p>
<p>如果ids是一维张量N，就是按ids寻找index对应元素，返回tensor是$N*K$。</p>
<p>如果是ids二维张量$N<em>M$，则是按照第二维度寻找index对应元素，寻找N次，组合后返回就是$N</em>M*K$。</p>
<p>在embedding_lookup_sparse中，则是根据稀疏矩阵sp_ids（设为$N<em>M$）来寻找index对应元素。不同点在于，按照index找到的元素需要根据combiner参数指定的方式来进行聚合操作，最终变成$(K,)$的tensor。因此完整的返回是$N</em>K$</p>
<p>另外需要注意的是partition_strategy参数。当params为多个tensor构成的list（实际上会合并成一个大tensor）时，该参数负责指定合并后大tensor的index编排方法。list的长度为分区数，设为p。总元素数量（第一维度总长度）设为$id+1$。</p>
<p>在div情况下就按照顺序来排index；</p>
<p>在mod情况下，每个分区的基本元素数量为$id //p$，由于不一定能够整除，前$(id+ 1) \% p$个分区的元素数量加一。那么index的编排就是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">params = [<span class="number">2</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>, <span class="number">3</span>*<span class="number">4</span>]</span><br><span class="line">三个分区，每个分区的基本元素数为<span class="number">6</span>//<span class="number">3</span>=<span class="number">2</span>, 前<span class="number">7</span>%<span class="number">3</span>=<span class="number">1</span>个分区元素数量加一</span><br><span class="line">重新编排后就是</span><br><span class="line">[<span class="number">3</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>, <span class="number">2</span>*<span class="number">4</span>]</span><br><span class="line">他们的index则是</span><br><span class="line">[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]*<span class="number">3</span>+<span class="number">0</span>, [<span class="number">0</span>,<span class="number">1</span>]*<span class="number">3</span>+<span class="number">1</span>, [<span class="number">0</span>,<span class="number">1</span>]*<span class="number">3</span>+<span class="number">2</span>, 即是</span><br><span class="line">[<span class="number">0</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">5</span>]。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/tensorflow变量初始化方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/tensorflow变量初始化方法/" class="post-title-link" itemprop="url">tensorflow变量初始化方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/fireflychh/article/details/73692183" target="_blank" rel="noopener">tensorflow中tf.random_normal和tf.truncated_normal的区别</a></p>
<p><a href="http://www.bubuko.com/infodetail-2099623.html" target="_blank" rel="noopener">tensorflow 1.0 学习：参数初始化（initializer)</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第三章——改进神经网络的学习方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第三章——改进神经网络的学习方法/" class="post-title-link" itemprop="url">《神经网络和深度学习》第三章——改进神经网络的学习方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="损失函数选择"><a href="#损失函数选择" class="headerlink" title="损失函数选择"></a>损失函数选择</h1><p>当均方误差作为损失函数，S型曲线作为激活函数时，梯度和激活函数导数相关。<br>因此当严重误判时（i.e.真值为0预测输出接近1），由于此时S型激活函数在两侧导数都非常小，会出现犯了明显错误但学习却非常缓慢的情况。<br>而交叉熵和S型输出层组合并不会出现这个问题，因为经过计算可知梯度和预测错误相关（预测错误 = 预测值-真值），但仅仅限于输出神经元上。但遗憾的是，<br>交叉熵情况下，对权重梯度跟输入\(a_j^l\)相关，因此当\(a_j^l\)趋向于0时，权重梯度会很小，学习缓慢。  </p>
<p>回顾logistic回归，交叉熵可以由极大似然估计推出。</p>
<p>softmax输出层和对数似然代价组合是另一种可能。</p>
<p><em>交叉熵代价在变大，而分类准确率在上升，这是可能的。合理的选用代价函数（便于优化），以及合理的调参（提高分类准确率）。</em></p>
<h1 id="防止过拟合"><a href="#防止过拟合" class="headerlink" title="防止过拟合"></a>防止过拟合</h1><ol>
<li><p>增加样本</p>
</li>
<li><p>L2规范化/权重衰减<br>规范化项里面不包含偏置。因此，对于偏置梯度不变。对于权重梯度：<br>$$\frac{\partial C}{\partial \omega} = \frac{\partial C_0}{\partial \omega} + \frac{\lambda}{n}\omega$$<br>$$\frac{\partial C}{\partial b} = \frac{\partial C_0}{\partial b}$$<br>其中\(C_0\)是原始代价函数：<br>$$C = C_0 + \frac{\lambda}{2n}\sum_\omega\omega^2$$<br>因此，权重学习规则就变成：<br>\begin{split}\omega \rightarrow \omega - \eta\frac{\partial C_0}{\partial \omega} - \frac{\eta\lambda}{n}\omega\newline<br>= (1 - \frac{\eta\lambda}{n})\omega - \eta\frac{\partial C_0}{\partial \omega}\end{split}<br>故而它又被称作权重衰减。<br><em>L2规范化还可以帮助逃离局部最优值。</em><br>规范化更倾向于小权重，对于输入噪音不会过度敏感。<br>不对偏置进行规范化，是因为：</p>
<ul>
<li>实践看来改善不明显</li>
<li>大的偏置并不会对噪音敏感</li>
<li>大的偏置让网络更加灵活，让神经元更加容易饱和  </li>
</ul>
</li>
</ol>
<p>为什么L2规范化往往比不做规范化有更好的结果？<br>仅是实践经验，并不是因为“奥卡姆剃刀”。因为简单更好本身就无法证明，何况也无法严格判定在他同等效果下哪个模型更简单（对效果除权很难）。<br>对模型真正的测试不是简单性，而是在新场景中新活动的预测能力。</p>
<ol start="3">
<li><p>L1规范化<br>代价函数变为：<br>$$C = C_0 + \frac{\lambda}{2n}\sum_\omega|\omega|$$<br>求导得：<br>$$\frac{\partial C}{\partial \omega} = \frac{\partial C_0}{\partial \omega} + \frac{\lambda}{n}sgn(\omega)$$<br>因此更新规则为：<br>$$\omega \rightarrow \omega - \frac{\lambda}{n}sgn(\omega) - \frac{\partial C_0}{\partial \omega}$$<br>在L2规范化中，权重通过一个和$\omega$成比例的量进行缩小。在L1中，权重通过一个常量向0缩小。<br>所以，当权重绝对值很大时，L1规范化的权重缩小原比L2规范化要小的多。相反，当一个特定的权重绝对值很小时，L1规范化的权重缩小要比L2规范化大的多。<br>最终结果就是，L1规范化倾向于聚集网络权重在相对少量的高重要度连接上，而其他权重就会被驱使向0接近。</p>
</li>
<li><p>弃权（dropout）<br>在训练过程中通过概率使得部分隐藏神经元不参与计算和更新，不断重复这个过程使得权重选择性更新。最终得到的结果就可以视为bagging。<br>这样理解好象是错的？</p>
</li>
<li><p>人为扩展训练数据<br>就MNIST而言，可以通过对图像进行小幅旋转来认为产生新数据。<br>在语音识别中，还可以通过增加背景噪声来扩展训练数据，从而更加关注普适特征，训练出更具范化能力的模型。</p>
</li>
</ol>
<h1 id="权重初始化"><a href="#权重初始化" class="headerlink" title="权重初始化"></a>权重初始化</h1><p>一般采用标准正态分布来进行权重和偏置初始化。<br>考虑一个极端情况，一共n个输入神经元，输入值都为1。那么加权和就会服从均值0,方差n+1的正态分布，形如：<br><img src="http://p1.bpimg.com/567571/d42d2eff91ab2285.png" alt><br>就会造成带权和很大，从而相对应的隐藏神经元饱和，激活值接近0或1。从而梯度下降学习将会非常缓慢。<br>因此，我们可以选择均值0,方差1/n的正态分布来进行权重初始化，对于偏置习惯上依旧使用标准正态分布。</p>
<h1 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h1><ul>
<li>学习率</li>
<li>正则项系数</li>
<li>minibatch数量</li>
<li>迭代次数</li>
<li>隐藏神经元数量</li>
<li>层数</li>
<li>输出编码方式</li>
</ul>
<h1 id="其他技术"><a href="#其他技术" class="headerlink" title="其他技术"></a>其他技术</h1><ol>
<li><p>Hessian优化（泰勒展开与二阶近似）</p>
</li>
<li><p>基于momentum的梯度下降</p>
</li>
</ol>
<h1 id="其他激活函数"><a href="#其他激活函数" class="headerlink" title="其他激活函数"></a>其他激活函数</h1><ul>
<li><p>tanh<br><img src="http://i1.piimg.com/567571/32cda276ddd538ca.png" alt>  </p>
</li>
<li><p>relu<br><img src="http://i1.piimg.com/567571/c10b3dae75ed663c.png" alt></p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第二章——反向传播算法如何工作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第二章——反向传播算法如何工作/" class="post-title-link" itemprop="url">《神经网络和深度学习》第二章——反向传播算法如何工作</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="反向传播算法"><a href="#反向传播算法" class="headerlink" title="反向传播算法"></a>反向传播算法</h1><p>反向传播算法通过<em>链式法则</em>来简化计算<em>损失函数对各权重和偏置的梯度</em>。</p>
<h2 id="符号说明、一个定义、四个关键方程："><a href="#符号说明、一个定义、四个关键方程：" class="headerlink" title="符号说明、一个定义、四个关键方程："></a>符号说明、一个定义、四个关键方程：</h2><ol>
<li><p>符号说明：<br>\(l-1\)层\(k\)神经元与\(l\)层\(j\)神经元连接权重： \(\omega_{jk}^l\)<br>带权和： \(z_j^{l} = \sum\limits_{k}{\omega_{jk}^{l}a_k^{l-1}} + b_j^l\)<br>激活值： \(a_j^l = \sigma(z_j^l)\)</p>
</li>
<li><p>定义\(l\)层\(j\)神经元误差：<br>$$\delta_j^l = \frac{\partial C}{\partial z_j^l}$$<br>最优化时，梯度应当为0,因此可以理解为梯度绝对值越大，离最优化状态越远，误差越大。之所以对z而不是a求梯度，则是计算方便的考虑。</p>
</li>
<li><p>输出层误差方程：<br>$$\delta_j^L = \frac{\partial C}{\partial a_j^L}\sigma^{‘}(z_j^L)$$<br>矩阵形式：<br>$$\delta^L = \nabla_aC \odot \sigma^{‘}(z^L)$$</p>
</li>
<li><p>使用下一层的误差\(\delta^{l+1}\)来表示当前层的误差\(\delta^l\)：<br>$$\delta_j^l = \sum_k{\omega_{kj}^{l+1}\delta_k^{l+1}\sigma^{‘}(z_j^l)}$$<br>矩阵形式：<br>$$\delta^l = ((\omega^{l+1})^T\delta^{l+1}) \odot \sigma^{‘}(z^l)$$</p>
</li>
<li><p>损失函数对偏置的导数：<br>$$\frac{\partial C}{\partial b_j^l} = \delta_j^l$$</p>
</li>
<li><p>损失函数对权重的导数：<br>$$\frac{\partial C}{\partial \omega_{jk}^l} = a_k^{l-1}\sigma_j^l$$</p>
</li>
</ol>
<h2 id="伪代码如下："><a href="#伪代码如下：" class="headerlink" title="伪代码如下："></a>伪代码如下：</h2><ol>
<li><p>计算并记录前向传播过程中<em>带权和</em>和<em>激活值</em>;</p>
</li>
<li><p>利用公式计算代价函数对参数梯度</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第五章——深度神经网络为何很难训练/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第五章——深度神经网络为何很难训练/" class="post-title-link" itemprop="url">《神经网络和深度学习》第五章——深度神经网络为何很难训练</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="不稳定的梯度问题"><a href="#不稳定的梯度问题" class="headerlink" title="不稳定的梯度问题"></a>不稳定的梯度问题</h1><p><img src="http://p1.bpimg.com/567571/c337283e1a426f2f.png" alt>  </p>
<p>以上图为例，会出现：</p>
<ol>
<li><p><strong>消失的梯度问题</strong>：<br>当$\omega_i\sigma_i^{‘}$小于1时。由于一般初始权重在0附近，且使用sigmoid神经元，所以消失的梯度问题更容易出现。<br>其实，即使权重很大，对于sigmoid函数而言，越大的权重会导致对应的sigmoid函数倒数越接近0,因此更容易梯度消失。</p>
</li>
<li><p><strong>激增的梯度问题</strong>：<br>当$\omega_i\sigma_i^{‘}$大于1时。当初始权重很大时出现。</p>
</li>
</ol>
<p>根本问题是因为前面层上的梯度是来自后面层上项的乘积。当存在过多的层次时，就出现了内在本质上的不稳定场景。<br>所以，如果我们使用标准的基于梯度的学习算法，在网络中的不同层就会出现按照不同学习速度学习的情况。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第六章——深度学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第六章——深度学习/" class="post-title-link" itemprop="url">《神经网络和深度学习》第六章——深度学习</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>
<h1 id="CNN"><a href="#CNN" class="headerlink" title="CNN"></a>CNN</h1><p>充分利用空间特征。</p>
<ul>
<li><p>局部感受野<br>隐藏层中每个神经元链接到输入神经元的一个小区域。</p>
</li>
<li><p>共享权重和偏置<br>即是应用相同的特征检测器。因此也可以很好的适应图像的平移不变性。<br>我们有时候把从输入层到隐藏层的映射称为一个特征映射。我们把定义特征映射的权重称为共享权重。我们把以这种方式定义特征映射的偏置称为共享偏置。<br>共享权重和偏置经常被称为一个卷积核或者滤波器。</p>
</li>
<li><p>混合层（pooling layers）<br>混合层通常紧接着在卷积层之后使用。用于简化从卷积层输出的信息。</p>
</li>
</ul>
<p>一些常用的混合程序：</p>
<ul>
<li>最大值混合（max-pooling）：取最大值</li>
<li>L2混合（L2-pooling）：取激活值平方和的平方根</li>
</ul>
<p>一个使用5×5局部感受野和3个特征映射，以及应用于2×2区域的最大值混合层如下所示：</p>
<p><img src="http://i4.buimg.com/567571/3dae256ad7f99167.png" alt></p>
<p>[TBC]卷积网络中的反向传播？</p>
<h1 id="CNN实践"><a href="#CNN实践" class="headerlink" title="CNN实践"></a>CNN实践</h1><ul>
<li><p>加入第二个卷积-混合层<br>地一个卷积-混合层的输出是经过抽象和凝缩过的版本，但仍然有大量的空间结构。因此使用第二个卷积-混合层是有意义的。<br>以上例来说，输出是3×12×12,那么第二个卷积层的局部感受野应该是3×k×k。也就是说使用前面所有混合层数据。这是一个需要注意的地方。</p>
</li>
<li><p>切换激活函数<br>tanh，relu等。</p>
</li>
<li><p>扩展训练数据</p>
</li>
<li><p>插入额外的全连接层</p>
</li>
<li><p>使用组合网络<br>训练多个网络进行投票</p>
</li>
<li><p>对全连接层进行dropout<br>卷积层先天可以抵抗过拟合。原因是共享权重意味着卷积滤波器被强制从整个图像中学习。这使他们不太可能去选择在训练数据中的局部特质。于是就很少有必要来应用其他规范化，例如弃权。</p>
</li>
</ul>
<h1 id="为什么我们能够训练"><a href="#为什么我们能够训练" class="headerlink" title="为什么我们能够训练"></a>为什么我们能够训练</h1><p>我们是如何克服不稳定的梯度问题的？</p>
<ul>
<li>使用卷积层极大的减少了这些层中的参数的数目，使学习的问题更容易</li>
<li>使用更多强有力的规范化技术（尤其是弃权和卷积层）来减少过度拟合</li>
<li>使用修正线性单元而不是S型神经元，来加速训练 [TBC]?</li>
<li>使用GPU并愿意长时间训练</li>
</ul>
<p>以及其他技巧：</p>
<ul>
<li>使用充分大的数据集（避免过拟合）</li>
<li>使用正确的代价函数（避免学习减速）</li>
<li>使用好的权重初始化（避免神经元饱和和其引起的学习减速）</li>
</ul>
<h1 id="TBC-一些问题"><a href="#TBC-一些问题" class="headerlink" title="[TBC]一些问题"></a>[TBC]一些问题</h1><ul>
<li><p>对relu使用sigmoid函数的初始化方法会怎么样？</p>
</li>
<li><p>前面不稳定的梯度问题是针对sigmoid函数讨论的，对relu，会有什么差异？</p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/NN/《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/NN/《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明/" class="post-title-link" itemprop="url">《神经网络和深度学习》第四章——神经网络可以计算任何函数的可视化证明</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/NN/" itemprop="url" rel="index"><span itemprop="name">NN</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script><br>神经网络一个最显著的事实就是它可以计算任何的函数。它具有一种<em>普遍性</em>！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.muzhen.tk/2019/02/28/machine learning/cluster/cluster evaluation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="muzhen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="the Home of MuZhen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/28/machine learning/cluster/cluster evaluation/" class="post-title-link" itemprop="url">cluster evaluation</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-02-28 20:45:06" itemprop="dateCreated datePublished" datetime="2019-02-28T20:45:06+08:00">2019-02-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/cluster/" itemprop="url" rel="index"><span itemprop="name">cluster</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script type"text javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<p>本文总结聚类结果的好坏评估。评估可以分为两大类，已知类别和未知类别。</p>
<h1 id="已知类别"><a href="#已知类别" class="headerlink" title="已知类别"></a>已知类别</h1><h2 id="Rand-index-amp-Adjusted-Rand-index"><a href="#Rand-index-amp-Adjusted-Rand-index" class="headerlink" title="Rand index &amp; Adjusted Rand index"></a>Rand index &amp; Adjusted Rand index</h2><p>设样本数为\(n\),实际类别信息为\(C \),聚类结果为\(K\),\(a\)表示在\(C \)和\(K\)中都是同类别的元素对数，\(b\)表示在\(C \)和\(K\)中都是不同类别的元素对数，则兰德指数为：<br>$$ RI = \frac{a+b}{C^{2}_{n}}$$<br>显然，Rand index取值范围[0,1],越大聚类效果越好。</p>
<p>但对于随机结果，并不能保证分数接近零。为了实现这个目标，提出ARI，它具有更高的区分度：<br>$$ ARI = \frac{RI - E[RI]}{\max(RI) - E[RI]}$$</p>
<p>我一开始觉得RI存在一个问题，那就是只使用元素对去评估效果，可能忽略整体聚类情况。但细想之后发现并不会。因为任意两个元素对都会被计算，因此整体类别情况也会被考虑到。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)  </span><br><span class="line"><span class="number">0.24</span></span><br></pre></td></tr></table></figure>
<h2 id="Mutual-Information-based-scores"><a href="#Mutual-Information-based-scores" class="headerlink" title="Mutual Information based scores"></a>Mutual Information based scores</h2><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="http://blog.csdn.net/sinat_26917383/article/details/70577710" target="_blank" rel="noopener">聚类︱python实现 六大 分群质量评估指标（兰德系数、互信息、轮廓系数）</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">muzhen</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">358</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">113</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">muzhen</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  
  



  




  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  

  

  

  

  

  

  

  

  

  

</body>
</html>
